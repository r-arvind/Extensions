!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("MMDLoader",[],e):"object"==typeof exports?exports.MMDLoader=e():t.MMDLoader=e()}(window,(function(){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i(1),n=i(2),o=function(){function t(){this.name="mmd",this.parser=null,this._forAssetContainer=!1,this.extensions={".pmd":{isBinary:!0},".pmx":{isBinary:!0}},console.log("Initiated!!")}return t.prototype.importMeshAsync=function(t,e,i,r,n,o){this._getParser();return console.log(r),new Promise((function(t){return{meshes:[],particleSystems:[],skeletons:[],animationGroups:[],transformNodes:[],geometries:[],lights:[]}}))},t.prototype.loadAsync=function(t,e,i,r,n){return this.importMeshAsync(null,t,e,i,r).then((function(){}))},t.prototype.loadAssetContainerAsync=function(t,e,i,r,o){var s=this;return this._forAssetContainer=!0,this.importMeshAsync(null,t,e,i).then((function(e){return new n.AssetContainer(t)})).catch((function(t){throw s._forAssetContainer=!1,t}))},t.prototype._getParser=function(){if(null===this.parser){if(void 0===r)throw new Error("THREE.MMDLoader: Import MMDParser https://github.com/takahirox/mmd-parser");this.parser=new r.Parser}return this.parser},t}();e.default=o},function(t,e,i){!function(t){"use strict";function e(){}function i(t,i){this.dv=new DataView(t),this.offset=0,this.littleEndian=void 0===i||i,this.encoder=new e}function r(){}function n(){}e.prototype.s2u=function(t){for(var e=this.s2uTable,i="",r=0;r<t.length;){var n=t[r++];if(!(n>=0&&n<=126||n>=161&&n<=223)&&r<t.length&&(n=n<<8|t[r++]),void 0===e[n])throw"unknown char code "+n+".";i+=String.fromCharCode(e[n])}return i},e.prototype.s2uTable={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:92,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:126,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:65340,33120:65374,33121:8741,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:65293,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:65504,33170:65505,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:65506,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34624:9312,34625:9313,34626:9314,34627:9315,34628:9316,34629:9317,34630:9318,34631:9319,34632:9320,34633:9321,34634:9322,34635:9323,34636:9324,34637:9325,34638:9326,34639:9327,34640:9328,34641:9329,34642:9330,34643:9331,34644:8544,34645:8545,34646:8546,34647:8547,34648:8548,34649:8549,34650:8550,34651:8551,34652:8552,34653:8553,34655:13129,34656:13076,34657:13090,34658:13133,34659:13080,34660:13095,34661:13059,34662:13110,34663:13137,34664:13143,34665:13069,34666:13094,34667:13091,34668:13099,34669:13130,34670:13115,34671:13212,34672:13213,34673:13214,34674:13198,34675:13199,34676:13252,34677:13217,34686:13179,34688:12317,34689:12319,34690:8470,34691:13261,34692:8481,34693:12964,34694:12965,34695:12966,34696:12967,34697:12968,34698:12849,34699:12850,34700:12857,34701:13182,34702:13181,34703:13180,34704:8786,34705:8801,34706:8747,34707:8750,34708:8721,34709:8730,34710:8869,34711:8736,34712:8735,34713:8895,34714:8757,34715:8745,34716:8746,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081,60736:32394,60737:35100,60738:37704,60739:37512,60740:34012,60741:20425,60742:28859,60743:26161,60744:26824,60745:37625,60746:26363,60747:24389,60748:20008,60749:20193,60750:20220,60751:20224,60752:20227,60753:20281,60754:20310,60755:20370,60756:20362,60757:20378,60758:20372,60759:20429,60760:20544,60761:20514,60762:20479,60763:20510,60764:20550,60765:20592,60766:20546,60767:20628,60768:20724,60769:20696,60770:20810,60771:20836,60772:20893,60773:20926,60774:20972,60775:21013,60776:21148,60777:21158,60778:21184,60779:21211,60780:21248,60781:21255,60782:21284,60783:21362,60784:21395,60785:21426,60786:21469,60787:64014,60788:21660,60789:21642,60790:21673,60791:21759,60792:21894,60793:22361,60794:22373,60795:22444,60796:22472,60797:22471,60798:64015,60800:64016,60801:22686,60802:22706,60803:22795,60804:22867,60805:22875,60806:22877,60807:22883,60808:22948,60809:22970,60810:23382,60811:23488,60812:29999,60813:23512,60814:23532,60815:23582,60816:23718,60817:23738,60818:23797,60819:23847,60820:23891,60821:64017,60822:23874,60823:23917,60824:23992,60825:23993,60826:24016,60827:24353,60828:24372,60829:24423,60830:24503,60831:24542,60832:24669,60833:24709,60834:24714,60835:24798,60836:24789,60837:24864,60838:24818,60839:24849,60840:24887,60841:24880,60842:24984,60843:25107,60844:25254,60845:25589,60846:25696,60847:25757,60848:25806,60849:25934,60850:26112,60851:26133,60852:26171,60853:26121,60854:26158,60855:26142,60856:26148,60857:26213,60858:26199,60859:26201,60860:64018,60861:26227,60862:26265,60863:26272,60864:26290,60865:26303,60866:26362,60867:26382,60868:63785,60869:26470,60870:26555,60871:26706,60872:26560,60873:26625,60874:26692,60875:26831,60876:64019,60877:26984,60878:64020,60879:27032,60880:27106,60881:27184,60882:27243,60883:27206,60884:27251,60885:27262,60886:27362,60887:27364,60888:27606,60889:27711,60890:27740,60891:27782,60892:27759,60893:27866,60894:27908,60895:28039,60896:28015,60897:28054,60898:28076,60899:28111,60900:28152,60901:28146,60902:28156,60903:28217,60904:28252,60905:28199,60906:28220,60907:28351,60908:28552,60909:28597,60910:28661,60911:28677,60912:28679,60913:28712,60914:28805,60915:28843,60916:28943,60917:28932,60918:29020,60919:28998,60920:28999,60921:64021,60922:29121,60923:29182,60924:29361,60992:29374,60993:29476,60994:64022,60995:29559,60996:29629,60997:29641,60998:29654,60999:29667,61e3:29650,61001:29703,61002:29685,61003:29734,61004:29738,61005:29737,61006:29742,61007:29794,61008:29833,61009:29855,61010:29953,61011:30063,61012:30338,61013:30364,61014:30366,61015:30363,61016:30374,61017:64023,61018:30534,61019:21167,61020:30753,61021:30798,61022:30820,61023:30842,61024:31024,61025:64024,61026:64025,61027:64026,61028:31124,61029:64027,61030:31131,61031:31441,61032:31463,61033:64028,61034:31467,61035:31646,61036:64029,61037:32072,61038:32092,61039:32183,61040:32160,61041:32214,61042:32338,61043:32583,61044:32673,61045:64030,61046:33537,61047:33634,61048:33663,61049:33735,61050:33782,61051:33864,61052:33972,61053:34131,61054:34137,61056:34155,61057:64031,61058:34224,61059:64032,61060:64033,61061:34823,61062:35061,61063:35346,61064:35383,61065:35449,61066:35495,61067:35518,61068:35551,61069:64034,61070:35574,61071:35667,61072:35711,61073:36080,61074:36084,61075:36114,61076:36214,61077:64035,61078:36559,61079:64036,61080:64037,61081:36967,61082:37086,61083:64038,61084:37141,61085:37159,61086:37338,61087:37335,61088:37342,61089:37357,61090:37358,61091:37348,61092:37349,61093:37382,61094:37392,61095:37386,61096:37434,61097:37440,61098:37436,61099:37454,61100:37465,61101:37457,61102:37433,61103:37479,61104:37543,61105:37495,61106:37496,61107:37607,61108:37591,61109:37593,61110:37584,61111:64039,61112:37589,61113:37600,61114:37587,61115:37669,61116:37665,61117:37627,61118:64040,61119:37662,61120:37631,61121:37661,61122:37634,61123:37744,61124:37719,61125:37796,61126:37830,61127:37854,61128:37880,61129:37937,61130:37957,61131:37960,61132:38290,61133:63964,61134:64041,61135:38557,61136:38575,61137:38707,61138:38715,61139:38723,61140:38733,61141:38735,61142:38737,61143:38741,61144:38999,61145:39013,61146:64042,61147:64043,61148:39207,61149:64044,61150:39326,61151:39502,61152:39641,61153:39644,61154:39797,61155:39794,61156:39823,61157:39857,61158:39867,61159:39936,61160:40304,61161:40299,61162:64045,61163:40473,61164:40657,61167:8560,61168:8561,61169:8562,61170:8563,61171:8564,61172:8565,61173:8566,61174:8567,61175:8568,61176:8569,61177:65506,61178:65508,61179:65287,61180:65282,61504:57344,61505:57345,61506:57346,61507:57347,61508:57348,61509:57349,61510:57350,61511:57351,61512:57352,61513:57353,61514:57354,61515:57355,61516:57356,61517:57357,61518:57358,61519:57359,61520:57360,61521:57361,61522:57362,61523:57363,61524:57364,61525:57365,61526:57366,61527:57367,61528:57368,61529:57369,61530:57370,61531:57371,61532:57372,61533:57373,61534:57374,61535:57375,61536:57376,61537:57377,61538:57378,61539:57379,61540:57380,61541:57381,61542:57382,61543:57383,61544:57384,61545:57385,61546:57386,61547:57387,61548:57388,61549:57389,61550:57390,61551:57391,61552:57392,61553:57393,61554:57394,61555:57395,61556:57396,61557:57397,61558:57398,61559:57399,61560:57400,61561:57401,61562:57402,61563:57403,61564:57404,61565:57405,61566:57406,61568:57407,61569:57408,61570:57409,61571:57410,61572:57411,61573:57412,61574:57413,61575:57414,61576:57415,61577:57416,61578:57417,61579:57418,61580:57419,61581:57420,61582:57421,61583:57422,61584:57423,61585:57424,61586:57425,61587:57426,61588:57427,61589:57428,61590:57429,61591:57430,61592:57431,61593:57432,61594:57433,61595:57434,61596:57435,61597:57436,61598:57437,61599:57438,61600:57439,61601:57440,61602:57441,61603:57442,61604:57443,61605:57444,61606:57445,61607:57446,61608:57447,61609:57448,61610:57449,61611:57450,61612:57451,61613:57452,61614:57453,61615:57454,61616:57455,61617:57456,61618:57457,61619:57458,61620:57459,61621:57460,61622:57461,61623:57462,61624:57463,61625:57464,61626:57465,61627:57466,61628:57467,61629:57468,61630:57469,61631:57470,61632:57471,61633:57472,61634:57473,61635:57474,61636:57475,61637:57476,61638:57477,61639:57478,61640:57479,61641:57480,61642:57481,61643:57482,61644:57483,61645:57484,61646:57485,61647:57486,61648:57487,61649:57488,61650:57489,61651:57490,61652:57491,61653:57492,61654:57493,61655:57494,61656:57495,61657:57496,61658:57497,61659:57498,61660:57499,61661:57500,61662:57501,61663:57502,61664:57503,61665:57504,61666:57505,61667:57506,61668:57507,61669:57508,61670:57509,61671:57510,61672:57511,61673:57512,61674:57513,61675:57514,61676:57515,61677:57516,61678:57517,61679:57518,61680:57519,61681:57520,61682:57521,61683:57522,61684:57523,61685:57524,61686:57525,61687:57526,61688:57527,61689:57528,61690:57529,61691:57530,61692:57531,61760:57532,61761:57533,61762:57534,61763:57535,61764:57536,61765:57537,61766:57538,61767:57539,61768:57540,61769:57541,61770:57542,61771:57543,61772:57544,61773:57545,61774:57546,61775:57547,61776:57548,61777:57549,61778:57550,61779:57551,61780:57552,61781:57553,61782:57554,61783:57555,61784:57556,61785:57557,61786:57558,61787:57559,61788:57560,61789:57561,61790:57562,61791:57563,61792:57564,61793:57565,61794:57566,61795:57567,61796:57568,61797:57569,61798:57570,61799:57571,61800:57572,61801:57573,61802:57574,61803:57575,61804:57576,61805:57577,61806:57578,61807:57579,61808:57580,61809:57581,61810:57582,61811:57583,61812:57584,61813:57585,61814:57586,61815:57587,61816:57588,61817:57589,61818:57590,61819:57591,61820:57592,61821:57593,61822:57594,61824:57595,61825:57596,61826:57597,61827:57598,61828:57599,61829:57600,61830:57601,61831:57602,61832:57603,61833:57604,61834:57605,61835:57606,61836:57607,61837:57608,61838:57609,61839:57610,61840:57611,61841:57612,61842:57613,61843:57614,61844:57615,61845:57616,61846:57617,61847:57618,61848:57619,61849:57620,61850:57621,61851:57622,61852:57623,61853:57624,61854:57625,61855:57626,61856:57627,61857:57628,61858:57629,61859:57630,61860:57631,61861:57632,61862:57633,61863:57634,61864:57635,61865:57636,61866:57637,61867:57638,61868:57639,61869:57640,61870:57641,61871:57642,61872:57643,61873:57644,61874:57645,61875:57646,61876:57647,61877:57648,61878:57649,61879:57650,61880:57651,61881:57652,61882:57653,61883:57654,61884:57655,61885:57656,61886:57657,61887:57658,61888:57659,61889:57660,61890:57661,61891:57662,61892:57663,61893:57664,61894:57665,61895:57666,61896:57667,61897:57668,61898:57669,61899:57670,61900:57671,61901:57672,61902:57673,61903:57674,61904:57675,61905:57676,61906:57677,61907:57678,61908:57679,61909:57680,61910:57681,61911:57682,61912:57683,61913:57684,61914:57685,61915:57686,61916:57687,61917:57688,61918:57689,61919:57690,61920:57691,61921:57692,61922:57693,61923:57694,61924:57695,61925:57696,61926:57697,61927:57698,61928:57699,61929:57700,61930:57701,61931:57702,61932:57703,61933:57704,61934:57705,61935:57706,61936:57707,61937:57708,61938:57709,61939:57710,61940:57711,61941:57712,61942:57713,61943:57714,61944:57715,61945:57716,61946:57717,61947:57718,61948:57719,62016:57720,62017:57721,62018:57722,62019:57723,62020:57724,62021:57725,62022:57726,62023:57727,62024:57728,62025:57729,62026:57730,62027:57731,62028:57732,62029:57733,62030:57734,62031:57735,62032:57736,62033:57737,62034:57738,62035:57739,62036:57740,62037:57741,62038:57742,62039:57743,62040:57744,62041:57745,62042:57746,62043:57747,62044:57748,62045:57749,62046:57750,62047:57751,62048:57752,62049:57753,62050:57754,62051:57755,62052:57756,62053:57757,62054:57758,62055:57759,62056:57760,62057:57761,62058:57762,62059:57763,62060:57764,62061:57765,62062:57766,62063:57767,62064:57768,62065:57769,62066:57770,62067:57771,62068:57772,62069:57773,62070:57774,62071:57775,62072:57776,62073:57777,62074:57778,62075:57779,62076:57780,62077:57781,62078:57782,62080:57783,62081:57784,62082:57785,62083:57786,62084:57787,62085:57788,62086:57789,62087:57790,62088:57791,62089:57792,62090:57793,62091:57794,62092:57795,62093:57796,62094:57797,62095:57798,62096:57799,62097:57800,62098:57801,62099:57802,62100:57803,62101:57804,62102:57805,62103:57806,62104:57807,62105:57808,62106:57809,62107:57810,62108:57811,62109:57812,62110:57813,62111:57814,62112:57815,62113:57816,62114:57817,62115:57818,62116:57819,62117:57820,62118:57821,62119:57822,62120:57823,62121:57824,62122:57825,62123:57826,62124:57827,62125:57828,62126:57829,62127:57830,62128:57831,62129:57832,62130:57833,62131:57834,62132:57835,62133:57836,62134:57837,62135:57838,62136:57839,62137:57840,62138:57841,62139:57842,62140:57843,62141:57844,62142:57845,62143:57846,62144:57847,62145:57848,62146:57849,62147:57850,62148:57851,62149:57852,62150:57853,62151:57854,62152:57855,62153:57856,62154:57857,62155:57858,62156:57859,62157:57860,62158:57861,62159:57862,62160:57863,62161:57864,62162:57865,62163:57866,62164:57867,62165:57868,62166:57869,62167:57870,62168:57871,62169:57872,62170:57873,62171:57874,62172:57875,62173:57876,62174:57877,62175:57878,62176:57879,62177:57880,62178:57881,62179:57882,62180:57883,62181:57884,62182:57885,62183:57886,62184:57887,62185:57888,62186:57889,62187:57890,62188:57891,62189:57892,62190:57893,62191:57894,62192:57895,62193:57896,62194:57897,62195:57898,62196:57899,62197:57900,62198:57901,62199:57902,62200:57903,62201:57904,62202:57905,62203:57906,62204:57907,62272:57908,62273:57909,62274:57910,62275:57911,62276:57912,62277:57913,62278:57914,62279:57915,62280:57916,62281:57917,62282:57918,62283:57919,62284:57920,62285:57921,62286:57922,62287:57923,62288:57924,62289:57925,62290:57926,62291:57927,62292:57928,62293:57929,62294:57930,62295:57931,62296:57932,62297:57933,62298:57934,62299:57935,62300:57936,62301:57937,62302:57938,62303:57939,62304:57940,62305:57941,62306:57942,62307:57943,62308:57944,62309:57945,62310:57946,62311:57947,62312:57948,62313:57949,62314:57950,62315:57951,62316:57952,62317:57953,62318:57954,62319:57955,62320:57956,62321:57957,62322:57958,62323:57959,62324:57960,62325:57961,62326:57962,62327:57963,62328:57964,62329:57965,62330:57966,62331:57967,62332:57968,62333:57969,62334:57970,62336:57971,62337:57972,62338:57973,62339:57974,62340:57975,62341:57976,62342:57977,62343:57978,62344:57979,62345:57980,62346:57981,62347:57982,62348:57983,62349:57984,62350:57985,62351:57986,62352:57987,62353:57988,62354:57989,62355:57990,62356:57991,62357:57992,62358:57993,62359:57994,62360:57995,62361:57996,62362:57997,62363:57998,62364:57999,62365:58e3,62366:58001,62367:58002,62368:58003,62369:58004,62370:58005,62371:58006,62372:58007,62373:58008,62374:58009,62375:58010,62376:58011,62377:58012,62378:58013,62379:58014,62380:58015,62381:58016,62382:58017,62383:58018,62384:58019,62385:58020,62386:58021,62387:58022,62388:58023,62389:58024,62390:58025,62391:58026,62392:58027,62393:58028,62394:58029,62395:58030,62396:58031,62397:58032,62398:58033,62399:58034,62400:58035,62401:58036,62402:58037,62403:58038,62404:58039,62405:58040,62406:58041,62407:58042,62408:58043,62409:58044,62410:58045,62411:58046,62412:58047,62413:58048,62414:58049,62415:58050,62416:58051,62417:58052,62418:58053,62419:58054,62420:58055,62421:58056,62422:58057,62423:58058,62424:58059,62425:58060,62426:58061,62427:58062,62428:58063,62429:58064,62430:58065,62431:58066,62432:58067,62433:58068,62434:58069,62435:58070,62436:58071,62437:58072,62438:58073,62439:58074,62440:58075,62441:58076,62442:58077,62443:58078,62444:58079,62445:58080,62446:58081,62447:58082,62448:58083,62449:58084,62450:58085,62451:58086,62452:58087,62453:58088,62454:58089,62455:58090,62456:58091,62457:58092,62458:58093,62459:58094,62460:58095,62528:58096,62529:58097,62530:58098,62531:58099,62532:58100,62533:58101,62534:58102,62535:58103,62536:58104,62537:58105,62538:58106,62539:58107,62540:58108,62541:58109,62542:58110,62543:58111,62544:58112,62545:58113,62546:58114,62547:58115,62548:58116,62549:58117,62550:58118,62551:58119,62552:58120,62553:58121,62554:58122,62555:58123,62556:58124,62557:58125,62558:58126,62559:58127,62560:58128,62561:58129,62562:58130,62563:58131,62564:58132,62565:58133,62566:58134,62567:58135,62568:58136,62569:58137,62570:58138,62571:58139,62572:58140,62573:58141,62574:58142,62575:58143,62576:58144,62577:58145,62578:58146,62579:58147,62580:58148,62581:58149,62582:58150,62583:58151,62584:58152,62585:58153,62586:58154,62587:58155,62588:58156,62589:58157,62590:58158,62592:58159,62593:58160,62594:58161,62595:58162,62596:58163,62597:58164,62598:58165,62599:58166,62600:58167,62601:58168,62602:58169,62603:58170,62604:58171,62605:58172,62606:58173,62607:58174,62608:58175,62609:58176,62610:58177,62611:58178,62612:58179,62613:58180,62614:58181,62615:58182,62616:58183,62617:58184,62618:58185,62619:58186,62620:58187,62621:58188,62622:58189,62623:58190,62624:58191,62625:58192,62626:58193,62627:58194,62628:58195,62629:58196,62630:58197,62631:58198,62632:58199,62633:58200,62634:58201,62635:58202,62636:58203,62637:58204,62638:58205,62639:58206,62640:58207,62641:58208,62642:58209,62643:58210,62644:58211,62645:58212,62646:58213,62647:58214,62648:58215,62649:58216,62650:58217,62651:58218,62652:58219,62653:58220,62654:58221,62655:58222,62656:58223,62657:58224,62658:58225,62659:58226,62660:58227,62661:58228,62662:58229,62663:58230,62664:58231,62665:58232,62666:58233,62667:58234,62668:58235,62669:58236,62670:58237,62671:58238,62672:58239,62673:58240,62674:58241,62675:58242,62676:58243,62677:58244,62678:58245,62679:58246,62680:58247,62681:58248,62682:58249,62683:58250,62684:58251,62685:58252,62686:58253,62687:58254,62688:58255,62689:58256,62690:58257,62691:58258,62692:58259,62693:58260,62694:58261,62695:58262,62696:58263,62697:58264,62698:58265,62699:58266,62700:58267,62701:58268,62702:58269,62703:58270,62704:58271,62705:58272,62706:58273,62707:58274,62708:58275,62709:58276,62710:58277,62711:58278,62712:58279,62713:58280,62714:58281,62715:58282,62716:58283,62784:58284,62785:58285,62786:58286,62787:58287,62788:58288,62789:58289,62790:58290,62791:58291,62792:58292,62793:58293,62794:58294,62795:58295,62796:58296,62797:58297,62798:58298,62799:58299,62800:58300,62801:58301,62802:58302,62803:58303,62804:58304,62805:58305,62806:58306,62807:58307,62808:58308,62809:58309,62810:58310,62811:58311,62812:58312,62813:58313,62814:58314,62815:58315,62816:58316,62817:58317,62818:58318,62819:58319,62820:58320,62821:58321,62822:58322,62823:58323,62824:58324,62825:58325,62826:58326,62827:58327,62828:58328,62829:58329,62830:58330,62831:58331,62832:58332,62833:58333,62834:58334,62835:58335,62836:58336,62837:58337,62838:58338,62839:58339,62840:58340,62841:58341,62842:58342,62843:58343,62844:58344,62845:58345,62846:58346,62848:58347,62849:58348,62850:58349,62851:58350,62852:58351,62853:58352,62854:58353,62855:58354,62856:58355,62857:58356,62858:58357,62859:58358,62860:58359,62861:58360,62862:58361,62863:58362,62864:58363,62865:58364,62866:58365,62867:58366,62868:58367,62869:58368,62870:58369,62871:58370,62872:58371,62873:58372,62874:58373,62875:58374,62876:58375,62877:58376,62878:58377,62879:58378,62880:58379,62881:58380,62882:58381,62883:58382,62884:58383,62885:58384,62886:58385,62887:58386,62888:58387,62889:58388,62890:58389,62891:58390,62892:58391,62893:58392,62894:58393,62895:58394,62896:58395,62897:58396,62898:58397,62899:58398,62900:58399,62901:58400,62902:58401,62903:58402,62904:58403,62905:58404,62906:58405,62907:58406,62908:58407,62909:58408,62910:58409,62911:58410,62912:58411,62913:58412,62914:58413,62915:58414,62916:58415,62917:58416,62918:58417,62919:58418,62920:58419,62921:58420,62922:58421,62923:58422,62924:58423,62925:58424,62926:58425,62927:58426,62928:58427,62929:58428,62930:58429,62931:58430,62932:58431,62933:58432,62934:58433,62935:58434,62936:58435,62937:58436,62938:58437,62939:58438,62940:58439,62941:58440,62942:58441,62943:58442,62944:58443,62945:58444,62946:58445,62947:58446,62948:58447,62949:58448,62950:58449,62951:58450,62952:58451,62953:58452,62954:58453,62955:58454,62956:58455,62957:58456,62958:58457,62959:58458,62960:58459,62961:58460,62962:58461,62963:58462,62964:58463,62965:58464,62966:58465,62967:58466,62968:58467,62969:58468,62970:58469,62971:58470,62972:58471,63040:58472,63041:58473,63042:58474,63043:58475,63044:58476,63045:58477,63046:58478,63047:58479,63048:58480,63049:58481,63050:58482,63051:58483,63052:58484,63053:58485,63054:58486,63055:58487,63056:58488,63057:58489,63058:58490,63059:58491,63060:58492,63061:58493,63062:58494,63063:58495,63064:58496,63065:58497,63066:58498,63067:58499,63068:58500,63069:58501,63070:58502,63071:58503,63072:58504,63073:58505,63074:58506,63075:58507,63076:58508,63077:58509,63078:58510,63079:58511,63080:58512,63081:58513,63082:58514,63083:58515,63084:58516,63085:58517,63086:58518,63087:58519,63088:58520,63089:58521,63090:58522,63091:58523,63092:58524,63093:58525,63094:58526,63095:58527,63096:58528,63097:58529,63098:58530,63099:58531,63100:58532,63101:58533,63102:58534,63104:58535,63105:58536,63106:58537,63107:58538,63108:58539,63109:58540,63110:58541,63111:58542,63112:58543,63113:58544,63114:58545,63115:58546,63116:58547,63117:58548,63118:58549,63119:58550,63120:58551,63121:58552,63122:58553,63123:58554,63124:58555,63125:58556,63126:58557,63127:58558,63128:58559,63129:58560,63130:58561,63131:58562,63132:58563,63133:58564,63134:58565,63135:58566,63136:58567,63137:58568,63138:58569,63139:58570,63140:58571,63141:58572,63142:58573,63143:58574,63144:58575,63145:58576,63146:58577,63147:58578,63148:58579,63149:58580,63150:58581,63151:58582,63152:58583,63153:58584,63154:58585,63155:58586,63156:58587,63157:58588,63158:58589,63159:58590,63160:58591,63161:58592,63162:58593,63163:58594,63164:58595,63165:58596,63166:58597,63167:58598,63168:58599,63169:58600,63170:58601,63171:58602,63172:58603,63173:58604,63174:58605,63175:58606,63176:58607,63177:58608,63178:58609,63179:58610,63180:58611,63181:58612,63182:58613,63183:58614,63184:58615,63185:58616,63186:58617,63187:58618,63188:58619,63189:58620,63190:58621,63191:58622,63192:58623,63193:58624,63194:58625,63195:58626,63196:58627,63197:58628,63198:58629,63199:58630,63200:58631,63201:58632,63202:58633,63203:58634,63204:58635,63205:58636,63206:58637,63207:58638,63208:58639,63209:58640,63210:58641,63211:58642,63212:58643,63213:58644,63214:58645,63215:58646,63216:58647,63217:58648,63218:58649,63219:58650,63220:58651,63221:58652,63222:58653,63223:58654,63224:58655,63225:58656,63226:58657,63227:58658,63228:58659,63296:58660,63297:58661,63298:58662,63299:58663,63300:58664,63301:58665,63302:58666,63303:58667,63304:58668,63305:58669,63306:58670,63307:58671,63308:58672,63309:58673,63310:58674,63311:58675,63312:58676,63313:58677,63314:58678,63315:58679,63316:58680,63317:58681,63318:58682,63319:58683,63320:58684,63321:58685,63322:58686,63323:58687,63324:58688,63325:58689,63326:58690,63327:58691,63328:58692,63329:58693,63330:58694,63331:58695,63332:58696,63333:58697,63334:58698,63335:58699,63336:58700,63337:58701,63338:58702,63339:58703,63340:58704,63341:58705,63342:58706,63343:58707,63344:58708,63345:58709,63346:58710,63347:58711,63348:58712,63349:58713,63350:58714,63351:58715,63352:58716,63353:58717,63354:58718,63355:58719,63356:58720,63357:58721,63358:58722,63360:58723,63361:58724,63362:58725,63363:58726,63364:58727,63365:58728,63366:58729,63367:58730,63368:58731,63369:58732,63370:58733,63371:58734,63372:58735,63373:58736,63374:58737,63375:58738,63376:58739,63377:58740,63378:58741,63379:58742,63380:58743,63381:58744,63382:58745,63383:58746,63384:58747,63385:58748,63386:58749,63387:58750,63388:58751,63389:58752,63390:58753,63391:58754,63392:58755,63393:58756,63394:58757,63395:58758,63396:58759,63397:58760,63398:58761,63399:58762,63400:58763,63401:58764,63402:58765,63403:58766,63404:58767,63405:58768,63406:58769,63407:58770,63408:58771,63409:58772,63410:58773,63411:58774,63412:58775,63413:58776,63414:58777,63415:58778,63416:58779,63417:58780,63418:58781,63419:58782,63420:58783,63421:58784,63422:58785,63423:58786,63424:58787,63425:58788,63426:58789,63427:58790,63428:58791,63429:58792,63430:58793,63431:58794,63432:58795,63433:58796,63434:58797,63435:58798,63436:58799,63437:58800,63438:58801,63439:58802,63440:58803,63441:58804,63442:58805,63443:58806,63444:58807,63445:58808,63446:58809,63447:58810,63448:58811,63449:58812,63450:58813,63451:58814,63452:58815,63453:58816,63454:58817,63455:58818,63456:58819,63457:58820,63458:58821,63459:58822,63460:58823,63461:58824,63462:58825,63463:58826,63464:58827,63465:58828,63466:58829,63467:58830,63468:58831,63469:58832,63470:58833,63471:58834,63472:58835,63473:58836,63474:58837,63475:58838,63476:58839,63477:58840,63478:58841,63479:58842,63480:58843,63481:58844,63482:58845,63483:58846,63484:58847,63552:58848,63553:58849,63554:58850,63555:58851,63556:58852,63557:58853,63558:58854,63559:58855,63560:58856,63561:58857,63562:58858,63563:58859,63564:58860,63565:58861,63566:58862,63567:58863,63568:58864,63569:58865,63570:58866,63571:58867,63572:58868,63573:58869,63574:58870,63575:58871,63576:58872,63577:58873,63578:58874,63579:58875,63580:58876,63581:58877,63582:58878,63583:58879,63584:58880,63585:58881,63586:58882,63587:58883,63588:58884,63589:58885,63590:58886,63591:58887,63592:58888,63593:58889,63594:58890,63595:58891,63596:58892,63597:58893,63598:58894,63599:58895,63600:58896,63601:58897,63602:58898,63603:58899,63604:58900,63605:58901,63606:58902,63607:58903,63608:58904,63609:58905,63610:58906,63611:58907,63612:58908,63613:58909,63614:58910,63616:58911,63617:58912,63618:58913,63619:58914,63620:58915,63621:58916,63622:58917,63623:58918,63624:58919,63625:58920,63626:58921,63627:58922,63628:58923,63629:58924,63630:58925,63631:58926,63632:58927,63633:58928,63634:58929,63635:58930,63636:58931,63637:58932,63638:58933,63639:58934,63640:58935,63641:58936,63642:58937,63643:58938,63644:58939,63645:58940,63646:58941,63647:58942,63648:58943,63649:58944,63650:58945,63651:58946,63652:58947,63653:58948,63654:58949,63655:58950,63656:58951,63657:58952,63658:58953,63659:58954,63660:58955,63661:58956,63662:58957,63663:58958,63664:58959,63665:58960,63666:58961,63667:58962,63668:58963,63669:58964,63670:58965,63671:58966,63672:58967,63673:58968,63674:58969,63675:58970,63676:58971,63677:58972,63678:58973,63679:58974,63680:58975,63681:58976,63682:58977,63683:58978,63684:58979,63685:58980,63686:58981,63687:58982,63688:58983,63689:58984,63690:58985,63691:58986,63692:58987,63693:58988,63694:58989,63695:58990,63696:58991,63697:58992,63698:58993,63699:58994,63700:58995,63701:58996,63702:58997,63703:58998,63704:58999,63705:59e3,63706:59001,63707:59002,63708:59003,63709:59004,63710:59005,63711:59006,63712:59007,63713:59008,63714:59009,63715:59010,63716:59011,63717:59012,63718:59013,63719:59014,63720:59015,63721:59016,63722:59017,63723:59018,63724:59019,63725:59020,63726:59021,63727:59022,63728:59023,63729:59024,63730:59025,63731:59026,63732:59027,63733:59028,63734:59029,63735:59030,63736:59031,63737:59032,63738:59033,63739:59034,63740:59035,64064:8560,64065:8561,64066:8562,64067:8563,64068:8564,64069:8565,64070:8566,64071:8567,64072:8568,64073:8569,64074:8544,64075:8545,64076:8546,64077:8547,64078:8548,64079:8549,64080:8550,64081:8551,64082:8552,64083:8553,64084:65506,64085:65508,64086:65287,64087:65282,64088:12849,64089:8470,64090:8481,64091:8757,64092:32394,64093:35100,64094:37704,64095:37512,64096:34012,64097:20425,64098:28859,64099:26161,64100:26824,64101:37625,64102:26363,64103:24389,64104:20008,64105:20193,64106:20220,64107:20224,64108:20227,64109:20281,64110:20310,64111:20370,64112:20362,64113:20378,64114:20372,64115:20429,64116:20544,64117:20514,64118:20479,64119:20510,64120:20550,64121:20592,64122:20546,64123:20628,64124:20724,64125:20696,64126:20810,64128:20836,64129:20893,64130:20926,64131:20972,64132:21013,64133:21148,64134:21158,64135:21184,64136:21211,64137:21248,64138:21255,64139:21284,64140:21362,64141:21395,64142:21426,64143:21469,64144:64014,64145:21660,64146:21642,64147:21673,64148:21759,64149:21894,64150:22361,64151:22373,64152:22444,64153:22472,64154:22471,64155:64015,64156:64016,64157:22686,64158:22706,64159:22795,64160:22867,64161:22875,64162:22877,64163:22883,64164:22948,64165:22970,64166:23382,64167:23488,64168:29999,64169:23512,64170:23532,64171:23582,64172:23718,64173:23738,64174:23797,64175:23847,64176:23891,64177:64017,64178:23874,64179:23917,64180:23992,64181:23993,64182:24016,64183:24353,64184:24372,64185:24423,64186:24503,64187:24542,64188:24669,64189:24709,64190:24714,64191:24798,64192:24789,64193:24864,64194:24818,64195:24849,64196:24887,64197:24880,64198:24984,64199:25107,64200:25254,64201:25589,64202:25696,64203:25757,64204:25806,64205:25934,64206:26112,64207:26133,64208:26171,64209:26121,64210:26158,64211:26142,64212:26148,64213:26213,64214:26199,64215:26201,64216:64018,64217:26227,64218:26265,64219:26272,64220:26290,64221:26303,64222:26362,64223:26382,64224:63785,64225:26470,64226:26555,64227:26706,64228:26560,64229:26625,64230:26692,64231:26831,64232:64019,64233:26984,64234:64020,64235:27032,64236:27106,64237:27184,64238:27243,64239:27206,64240:27251,64241:27262,64242:27362,64243:27364,64244:27606,64245:27711,64246:27740,64247:27782,64248:27759,64249:27866,64250:27908,64251:28039,64252:28015,64320:28054,64321:28076,64322:28111,64323:28152,64324:28146,64325:28156,64326:28217,64327:28252,64328:28199,64329:28220,64330:28351,64331:28552,64332:28597,64333:28661,64334:28677,64335:28679,64336:28712,64337:28805,64338:28843,64339:28943,64340:28932,64341:29020,64342:28998,64343:28999,64344:64021,64345:29121,64346:29182,64347:29361,64348:29374,64349:29476,64350:64022,64351:29559,64352:29629,64353:29641,64354:29654,64355:29667,64356:29650,64357:29703,64358:29685,64359:29734,64360:29738,64361:29737,64362:29742,64363:29794,64364:29833,64365:29855,64366:29953,64367:30063,64368:30338,64369:30364,64370:30366,64371:30363,64372:30374,64373:64023,64374:30534,64375:21167,64376:30753,64377:30798,64378:30820,64379:30842,64380:31024,64381:64024,64382:64025,64384:64026,64385:31124,64386:64027,64387:31131,64388:31441,64389:31463,64390:64028,64391:31467,64392:31646,64393:64029,64394:32072,64395:32092,64396:32183,64397:32160,64398:32214,64399:32338,64400:32583,64401:32673,64402:64030,64403:33537,64404:33634,64405:33663,64406:33735,64407:33782,64408:33864,64409:33972,64410:34131,64411:34137,64412:34155,64413:64031,64414:34224,64415:64032,64416:64033,64417:34823,64418:35061,64419:35346,64420:35383,64421:35449,64422:35495,64423:35518,64424:35551,64425:64034,64426:35574,64427:35667,64428:35711,64429:36080,64430:36084,64431:36114,64432:36214,64433:64035,64434:36559,64435:64036,64436:64037,64437:36967,64438:37086,64439:64038,64440:37141,64441:37159,64442:37338,64443:37335,64444:37342,64445:37357,64446:37358,64447:37348,64448:37349,64449:37382,64450:37392,64451:37386,64452:37434,64453:37440,64454:37436,64455:37454,64456:37465,64457:37457,64458:37433,64459:37479,64460:37543,64461:37495,64462:37496,64463:37607,64464:37591,64465:37593,64466:37584,64467:64039,64468:37589,64469:37600,64470:37587,64471:37669,64472:37665,64473:37627,64474:64040,64475:37662,64476:37631,64477:37661,64478:37634,64479:37744,64480:37719,64481:37796,64482:37830,64483:37854,64484:37880,64485:37937,64486:37957,64487:37960,64488:38290,64489:63964,64490:64041,64491:38557,64492:38575,64493:38707,64494:38715,64495:38723,64496:38733,64497:38735,64498:38737,64499:38741,64500:38999,64501:39013,64502:64042,64503:64043,64504:39207,64505:64044,64506:39326,64507:39502,64508:39641,64576:39644,64577:39797,64578:39794,64579:39823,64580:39857,64581:39867,64582:39936,64583:40304,64584:40299,64585:64045,64586:40473,64587:40657},i.prototype={constructor:i,getInt8:function(){var t=this.dv.getInt8(this.offset);return this.offset+=1,t},getInt8Array:function(t){for(var e=[],i=0;i<t;i++)e.push(this.getInt8());return e},getUint8:function(){var t=this.dv.getUint8(this.offset);return this.offset+=1,t},getUint8Array:function(t){for(var e=[],i=0;i<t;i++)e.push(this.getUint8());return e},getInt16:function(){var t=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,t},getInt16Array:function(t){for(var e=[],i=0;i<t;i++)e.push(this.getInt16());return e},getUint16:function(){var t=this.dv.getUint16(this.offset,this.littleEndian);return this.offset+=2,t},getUint16Array:function(t){for(var e=[],i=0;i<t;i++)e.push(this.getUint16());return e},getInt32:function(){var t=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,t},getInt32Array:function(t){for(var e=[],i=0;i<t;i++)e.push(this.getInt32());return e},getUint32:function(){var t=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,t},getUint32Array:function(t){for(var e=[],i=0;i<t;i++)e.push(this.getUint32());return e},getFloat32:function(){var t=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t},getFloat32Array:function(t){for(var e=[],i=0;i<t;i++)e.push(this.getFloat32());return e},getFloat64:function(){var t=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t},getFloat64Array:function(t){for(var e=[],i=0;i<t;i++)e.push(this.getFloat64());return e},getIndex:function(t,e){switch(t){case 1:return!0===e?this.getUint8():this.getInt8();case 2:return!0===e?this.getUint16():this.getInt16();case 4:return this.getInt32();default:throw"unknown number type "+t+" exception."}},getIndexArray:function(t,e,i){for(var r=[],n=0;n<e;n++)r.push(this.getIndex(t,i));return r},getChars:function(t){for(var e="";t>0;){var i=this.getUint8();if(t--,0===i)break;e+=String.fromCharCode(i)}for(;t>0;)this.getUint8(),t--;return e},getSjisStringsAsUnicode:function(t){for(var e=[];t>0;){var i=this.getUint8();if(t--,0===i)break;e.push(i)}for(;t>0;)this.getUint8(),t--;return this.encoder.s2u(new Uint8Array(e))},getUnicodeStrings:function(t){for(var e="";t>0;){var i=this.getUint16();if(t-=2,0===i)break;e+=String.fromCharCode(i)}for(;t>0;)this.getUint8(),t--;return e},getTextBuffer:function(){var t=this.getUint32();return this.getUnicodeStrings(t)}},r.prototype={constructor:r,leftToRightVector3:function(t){t[2]=-t[2]},leftToRightQuaternion:function(t){t[0]=-t[0],t[1]=-t[1]},leftToRightEuler:function(t){t[0]=-t[0],t[1]=-t[1]},leftToRightIndexOrder:function(t){var e=t[2];t[2]=t[0],t[0]=e},leftToRightVector3Range:function(t,e){var i=-e[2];e[2]=-t[2],t[2]=i},leftToRightEulerRange:function(t,e){var i=-e[0],r=-e[1];e[0]=-t[0],e[1]=-t[1],t[0]=i,t[1]=r}},n.prototype.parsePmd=function(t,e){var r,n={},o=new i(t);return n.metadata={},n.metadata.format="pmd",n.metadata.coordinateSystem="left",function(){var t=n.metadata;if(t.magic=o.getChars(3),"Pmd"!==t.magic)throw"PMD file magic is not Pmd, but "+t.magic;t.version=o.getFloat32(),t.modelName=o.getSjisStringsAsUnicode(20),t.comment=o.getSjisStringsAsUnicode(256)}(),function(){var t,e=n.metadata;e.vertexCount=o.getUint32(),n.vertices=[];for(var i=0;i<e.vertexCount;i++)n.vertices.push((t=void 0,(t={}).position=o.getFloat32Array(3),t.normal=o.getFloat32Array(3),t.uv=o.getFloat32Array(2),t.skinIndices=o.getUint16Array(2),t.skinWeights=[o.getUint8()/100],t.skinWeights.push(1-t.skinWeights[0]),t.edgeFlag=o.getUint8(),t))}(),function(){var t,e=n.metadata;e.faceCount=o.getUint32()/3,n.faces=[];for(var i=0;i<e.faceCount;i++)n.faces.push((t=void 0,(t={}).indices=o.getUint16Array(3),t))}(),function(){var t,e=n.metadata;e.materialCount=o.getUint32(),n.materials=[];for(var i=0;i<e.materialCount;i++)n.materials.push((t=void 0,(t={}).diffuse=o.getFloat32Array(4),t.shininess=o.getFloat32(),t.specular=o.getFloat32Array(3),t.ambient=o.getFloat32Array(3),t.toonIndex=o.getInt8(),t.edgeFlag=o.getUint8(),t.faceCount=o.getUint32()/3,t.fileName=o.getSjisStringsAsUnicode(20),t))}(),function(){var t,e=n.metadata;e.boneCount=o.getUint16(),n.bones=[];for(var i=0;i<e.boneCount;i++)n.bones.push((t=void 0,(t={}).name=o.getSjisStringsAsUnicode(20),t.parentIndex=o.getInt16(),t.tailIndex=o.getInt16(),t.type=o.getUint8(),t.ikIndex=o.getInt16(),t.position=o.getFloat32Array(3),t))}(),function(){var t=function(){var t={};t.target=o.getUint16(),t.effector=o.getUint16(),t.linkCount=o.getUint8(),t.iteration=o.getUint16(),t.maxAngle=o.getFloat32(),t.links=[];for(var e=0;e<t.linkCount;e++){var i={};i.index=o.getUint16(),t.links.push(i)}return t},e=n.metadata;e.ikCount=o.getUint16(),n.iks=[];for(var i=0;i<e.ikCount;i++)n.iks.push(t())}(),function(){var t=function(){var t={};t.name=o.getSjisStringsAsUnicode(20),t.elementCount=o.getUint32(),t.type=o.getUint8(),t.elements=[];for(var e=0;e<t.elementCount;e++)t.elements.push({index:o.getUint32(),position:o.getFloat32Array(3)});return t},e=n.metadata;e.morphCount=o.getUint16(),n.morphs=[];for(var i=0;i<e.morphCount;i++)n.morphs.push(t())}(),function(){var t,e=n.metadata;e.morphFrameCount=o.getUint8(),n.morphFrames=[];for(var i=0;i<e.morphFrameCount;i++)n.morphFrames.push((t=void 0,(t={}).index=o.getUint16(),t))}(),function(){var t,e=n.metadata;e.boneFrameNameCount=o.getUint8(),n.boneFrameNames=[];for(var i=0;i<e.boneFrameNameCount;i++)n.boneFrameNames.push((t=void 0,(t={}).name=o.getSjisStringsAsUnicode(50),t))}(),function(){var t,e=n.metadata;e.boneFrameCount=o.getUint32(),n.boneFrames=[];for(var i=0;i<e.boneFrameCount;i++)n.boneFrames.push((t=void 0,(t={}).boneIndex=o.getInt16(),t.frameIndex=o.getUint8(),t))}(),(r=n.metadata).englishCompatibility=o.getUint8(),r.englishCompatibility>0&&(r.englishModelName=o.getSjisStringsAsUnicode(20),r.englishComment=o.getSjisStringsAsUnicode(256)),function(){var t=n.metadata;if(0!==t.englishCompatibility){n.englishBoneNames=[];for(var e=0;e<t.boneCount;e++)n.englishBoneNames.push((i=void 0,(i={}).name=o.getSjisStringsAsUnicode(20),i));var i}}(),function(){var t=n.metadata;if(0!==t.englishCompatibility){n.englishMorphNames=[];for(var e=0;e<t.morphCount-1;e++)n.englishMorphNames.push((i=void 0,(i={}).name=o.getSjisStringsAsUnicode(20),i));var i}}(),function(){var t=n.metadata;if(0!==t.englishCompatibility){n.englishBoneFrameNames=[];for(var e=0;e<t.boneFrameNameCount;e++)n.englishBoneFrameNames.push((i=void 0,(i={}).name=o.getSjisStringsAsUnicode(50),i));var i}}(),function(){var t;n.toonTextures=[];for(var e=0;e<10;e++)n.toonTextures.push((t=void 0,(t={}).fileName=o.getSjisStringsAsUnicode(100),t))}(),function(){var t,e=n.metadata;e.rigidBodyCount=o.getUint32(),n.rigidBodies=[];for(var i=0;i<e.rigidBodyCount;i++)n.rigidBodies.push((t=void 0,(t={}).name=o.getSjisStringsAsUnicode(20),t.boneIndex=o.getInt16(),t.groupIndex=o.getUint8(),t.groupTarget=o.getUint16(),t.shapeType=o.getUint8(),t.width=o.getFloat32(),t.height=o.getFloat32(),t.depth=o.getFloat32(),t.position=o.getFloat32Array(3),t.rotation=o.getFloat32Array(3),t.weight=o.getFloat32(),t.positionDamping=o.getFloat32(),t.rotationDamping=o.getFloat32(),t.restitution=o.getFloat32(),t.friction=o.getFloat32(),t.type=o.getUint8(),t))}(),function(){var t,e=n.metadata;e.constraintCount=o.getUint32(),n.constraints=[];for(var i=0;i<e.constraintCount;i++)n.constraints.push((t=void 0,(t={}).name=o.getSjisStringsAsUnicode(20),t.rigidBodyIndex1=o.getUint32(),t.rigidBodyIndex2=o.getUint32(),t.position=o.getFloat32Array(3),t.rotation=o.getFloat32Array(3),t.translationLimitation1=o.getFloat32Array(3),t.translationLimitation2=o.getFloat32Array(3),t.rotationLimitation1=o.getFloat32Array(3),t.rotationLimitation2=o.getFloat32Array(3),t.springPosition=o.getFloat32Array(3),t.springRotation=o.getFloat32Array(3),t))}(),!0===e&&this.leftToRightModel(n),n},n.prototype.parsePmx=function(t,e){var r={},n=new i(t);return r.metadata={},r.metadata.format="pmx",r.metadata.coordinateSystem="left",function(){var t=r.metadata;if(t.magic=n.getChars(4),"PMX "!==t.magic)throw"PMX file magic is not PMX , but "+t.magic;if(t.version=n.getFloat32(),2!==t.version&&2.1!==t.version)throw"PMX version "+t.version+" is not supported.";t.headerSize=n.getUint8(),t.encoding=n.getUint8(),t.additionalUvNum=n.getUint8(),t.vertexIndexSize=n.getUint8(),t.textureIndexSize=n.getUint8(),t.materialIndexSize=n.getUint8(),t.boneIndexSize=n.getUint8(),t.morphIndexSize=n.getUint8(),t.rigidBodyIndexSize=n.getUint8(),t.modelName=n.getTextBuffer(),t.englishModelName=n.getTextBuffer(),t.comment=n.getTextBuffer(),t.englishComment=n.getTextBuffer()}(),function(){var t=function(){var t={};t.position=n.getFloat32Array(3),t.normal=n.getFloat32Array(3),t.uv=n.getFloat32Array(2),t.auvs=[];for(var i=0;i<r.metadata.additionalUvNum;i++)t.auvs.push(n.getFloat32Array(4));t.type=n.getUint8();var o=e.boneIndexSize;if(0===t.type)t.skinIndices=n.getIndexArray(o,1),t.skinWeights=[1];else if(1===t.type)t.skinIndices=n.getIndexArray(o,2),t.skinWeights=n.getFloat32Array(1),t.skinWeights.push(1-t.skinWeights[0]);else if(2===t.type)t.skinIndices=n.getIndexArray(o,4),t.skinWeights=n.getFloat32Array(4);else{if(3!==t.type)throw"unsupport bone type "+t.type+" exception.";t.skinIndices=n.getIndexArray(o,2),t.skinWeights=n.getFloat32Array(1),t.skinWeights.push(1-t.skinWeights[0]),t.skinC=n.getFloat32Array(3),t.skinR0=n.getFloat32Array(3),t.skinR1=n.getFloat32Array(3),t.type=1}return t.edgeRatio=n.getFloat32(),t},e=r.metadata;e.vertexCount=n.getUint32(),r.vertices=[];for(var i=0;i<e.vertexCount;i++)r.vertices.push(t())}(),function(){var t,e=r.metadata;e.faceCount=n.getUint32()/3,r.faces=[];for(var i=0;i<e.faceCount;i++)r.faces.push((t=void 0,(t={}).indices=n.getIndexArray(e.vertexIndexSize,3,!0),t))}(),function(){var t=r.metadata;t.textureCount=n.getUint32(),r.textures=[];for(var e=0;e<t.textureCount;e++)r.textures.push(n.getTextBuffer())}(),function(){var t=function(){var t={};if(t.name=n.getTextBuffer(),t.englishName=n.getTextBuffer(),t.diffuse=n.getFloat32Array(4),t.specular=n.getFloat32Array(3),t.shininess=n.getFloat32(),t.ambient=n.getFloat32Array(3),t.flag=n.getUint8(),t.edgeColor=n.getFloat32Array(4),t.edgeSize=n.getFloat32(),t.textureIndex=n.getIndex(r.metadata.textureIndexSize),t.envTextureIndex=n.getIndex(r.metadata.textureIndexSize),t.envFlag=n.getUint8(),t.toonFlag=n.getUint8(),0===t.toonFlag)t.toonIndex=n.getIndex(r.metadata.textureIndexSize);else{if(1!==t.toonFlag)throw"unknown toon flag "+t.toonFlag+" exception.";t.toonIndex=n.getInt8()}return t.comment=n.getTextBuffer(),t.faceCount=n.getUint32()/3,t},e=r.metadata;e.materialCount=n.getUint32(),r.materials=[];for(var i=0;i<e.materialCount;i++)r.materials.push(t())}(),function(){var t=function(){var t={};if(t.name=n.getTextBuffer(),t.englishName=n.getTextBuffer(),t.position=n.getFloat32Array(3),t.parentIndex=n.getIndex(r.metadata.boneIndexSize),t.transformationClass=n.getUint32(),t.flag=n.getUint16(),1&t.flag?t.connectIndex=n.getIndex(r.metadata.boneIndexSize):t.offsetPosition=n.getFloat32Array(3),256&t.flag||512&t.flag){var e={};e.isLocal=0!=(128&t.flag),e.affectRotation=0!=(256&t.flag),e.affectPosition=0!=(512&t.flag),e.parentIndex=n.getIndex(r.metadata.boneIndexSize),e.ratio=n.getFloat32(),t.grant=e}if(1024&t.flag&&(t.fixAxis=n.getFloat32Array(3)),2048&t.flag&&(t.localXVector=n.getFloat32Array(3),t.localZVector=n.getFloat32Array(3)),8192&t.flag&&(t.key=n.getUint32()),32&t.flag){var i={};i.effector=n.getIndex(r.metadata.boneIndexSize),i.target=null,i.iteration=n.getUint32(),i.maxAngle=n.getFloat32(),i.linkCount=n.getUint32(),i.links=[];for(var o=0;o<i.linkCount;o++){var s={};s.index=n.getIndex(r.metadata.boneIndexSize),s.angleLimitation=n.getUint8(),1===s.angleLimitation&&(s.lowerLimitationAngle=n.getFloat32Array(3),s.upperLimitationAngle=n.getFloat32Array(3)),i.links.push(s)}t.ik=i}return t},e=r.metadata;e.boneCount=n.getUint32(),r.bones=[];for(var i=0;i<e.boneCount;i++)r.bones.push(t())}(),function(){var t=function(){var t={};t.name=n.getTextBuffer(),t.englishName=n.getTextBuffer(),t.panel=n.getUint8(),t.type=n.getUint8(),t.elementCount=n.getUint32(),t.elements=[];for(var e=0;e<t.elementCount;e++)if(0===t.type)(i={}).index=n.getIndex(r.metadata.morphIndexSize),i.ratio=n.getFloat32(),t.elements.push(i);else if(1===t.type)(i={}).index=n.getIndex(r.metadata.vertexIndexSize,!0),i.position=n.getFloat32Array(3),t.elements.push(i);else if(2===t.type)(i={}).index=n.getIndex(r.metadata.boneIndexSize),i.position=n.getFloat32Array(3),i.rotation=n.getFloat32Array(4),t.elements.push(i);else if(3===t.type)(i={}).index=n.getIndex(r.metadata.vertexIndexSize,!0),i.uv=n.getFloat32Array(4),t.elements.push(i);else if(4===t.type);else if(5===t.type);else if(6===t.type);else if(7===t.type);else if(8===t.type){var i;(i={}).index=n.getIndex(r.metadata.materialIndexSize),i.type=n.getUint8(),i.diffuse=n.getFloat32Array(4),i.specular=n.getFloat32Array(3),i.shininess=n.getFloat32(),i.ambient=n.getFloat32Array(3),i.edgeColor=n.getFloat32Array(4),i.edgeSize=n.getFloat32(),i.textureColor=n.getFloat32Array(4),i.sphereTextureColor=n.getFloat32Array(4),i.toonColor=n.getFloat32Array(4),t.elements.push(i)}return t},e=r.metadata;e.morphCount=n.getUint32(),r.morphs=[];for(var i=0;i<e.morphCount;i++)r.morphs.push(t())}(),function(){var t=function(){var t={};t.name=n.getTextBuffer(),t.englishName=n.getTextBuffer(),t.type=n.getUint8(),t.elementCount=n.getUint32(),t.elements=[];for(var e=0;e<t.elementCount;e++){var i={};i.target=n.getUint8(),i.index=0===i.target?n.getIndex(r.metadata.boneIndexSize):n.getIndex(r.metadata.morphIndexSize),t.elements.push(i)}return t},e=r.metadata;e.frameCount=n.getUint32(),r.frames=[];for(var i=0;i<e.frameCount;i++)r.frames.push(t())}(),function(){var t,e=r.metadata;e.rigidBodyCount=n.getUint32(),r.rigidBodies=[];for(var i=0;i<e.rigidBodyCount;i++)r.rigidBodies.push((t=void 0,(t={}).name=n.getTextBuffer(),t.englishName=n.getTextBuffer(),t.boneIndex=n.getIndex(r.metadata.boneIndexSize),t.groupIndex=n.getUint8(),t.groupTarget=n.getUint16(),t.shapeType=n.getUint8(),t.width=n.getFloat32(),t.height=n.getFloat32(),t.depth=n.getFloat32(),t.position=n.getFloat32Array(3),t.rotation=n.getFloat32Array(3),t.weight=n.getFloat32(),t.positionDamping=n.getFloat32(),t.rotationDamping=n.getFloat32(),t.restitution=n.getFloat32(),t.friction=n.getFloat32(),t.type=n.getUint8(),t))}(),function(){var t,e=r.metadata;e.constraintCount=n.getUint32(),r.constraints=[];for(var i=0;i<e.constraintCount;i++)r.constraints.push((t=void 0,(t={}).name=n.getTextBuffer(),t.englishName=n.getTextBuffer(),t.type=n.getUint8(),t.rigidBodyIndex1=n.getIndex(r.metadata.rigidBodyIndexSize),t.rigidBodyIndex2=n.getIndex(r.metadata.rigidBodyIndexSize),t.position=n.getFloat32Array(3),t.rotation=n.getFloat32Array(3),t.translationLimitation1=n.getFloat32Array(3),t.translationLimitation2=n.getFloat32Array(3),t.rotationLimitation1=n.getFloat32Array(3),t.rotationLimitation2=n.getFloat32Array(3),t.springPosition=n.getFloat32Array(3),t.springRotation=n.getFloat32Array(3),t))}(),!0===e&&this.leftToRightModel(r),r},n.prototype.parseVmd=function(t,e){var r={},n=new i(t);return r.metadata={},r.metadata.coordinateSystem="left",function(){var t=r.metadata;if(t.magic=n.getChars(30),"Vocaloid Motion Data 0002"!==t.magic)throw"VMD file magic is not Vocaloid Motion Data 0002, but "+t.magic;t.name=n.getSjisStringsAsUnicode(20)}(),function(){var t,e=r.metadata;e.motionCount=n.getUint32(),r.motions=[];for(var i=0;i<e.motionCount;i++)r.motions.push((t=void 0,(t={}).boneName=n.getSjisStringsAsUnicode(15),t.frameNum=n.getUint32(),t.position=n.getFloat32Array(3),t.rotation=n.getFloat32Array(4),t.interpolation=n.getUint8Array(64),t))}(),function(){var t,e=r.metadata;e.morphCount=n.getUint32(),r.morphs=[];for(var i=0;i<e.morphCount;i++)r.morphs.push((t=void 0,(t={}).morphName=n.getSjisStringsAsUnicode(15),t.frameNum=n.getUint32(),t.weight=n.getFloat32(),t))}(),function(){var t,e=r.metadata;e.cameraCount=n.getUint32(),r.cameras=[];for(var i=0;i<e.cameraCount;i++)r.cameras.push((t=void 0,(t={}).frameNum=n.getUint32(),t.distance=n.getFloat32(),t.position=n.getFloat32Array(3),t.rotation=n.getFloat32Array(3),t.interpolation=n.getUint8Array(24),t.fov=n.getUint32(),t.perspective=n.getUint8(),t))}(),!0===e&&this.leftToRightVmd(r),r},n.prototype.parseVpd=function(t,e){var i={metadata:{}};i.metadata.coordinateSystem="left",i.bones=[];var r=t.replace(/\/\/\w*(\r|\n|\r\n)/g,"").split(/\r|\n|\r\n/);function n(){throw"the file seems not vpd file."}return"Vocaloid Pose Data file"!==r[0]&&n(),r.length<4&&n(),i.metadata.parentFile=r[2],i.metadata.boneCount=parseInt(r[3]),function(){for(var t=/^\s*(Bone[0-9]+)\s*\{\s*(.*)$/,e=/^\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*;/,o=/^\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*,\s*(-?[0-9]+\.[0-9]+)\s*;/,s=/^\s*}/,a=i.bones,u=null,h=null,l=null,c=4;c<r.length;c++){var f,d=r[c];null!==(f=d.match(t))&&(null!==u&&n(),u=f[2]),null!==(f=d.match(e))&&(null!==h&&n(),h=[parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3])]),null!==(f=d.match(o))&&(null!==l&&n(),l=[parseFloat(f[1]),parseFloat(f[2]),parseFloat(f[3]),parseFloat(f[4])]),null!==(f=d.match(s))&&(null!==u&&null!==h&&null!==l||n(),a.push({name:u,translation:h,quaternion:l}),u=null,h=null,l=null)}null===u&&null===h&&null===l||n()}(),!0===e&&this.leftToRightVpd(i),i},n.prototype.mergeVmds=function(t){var e={metadata:{}};e.metadata.name=t[0].metadata.name,e.metadata.coordinateSystem=t[0].metadata.coordinateSystem,e.metadata.motionCount=0,e.metadata.morphCount=0,e.metadata.cameraCount=0,e.motions=[],e.morphs=[],e.cameras=[];for(var i=0;i<t.length;i++){var r=t[i];e.metadata.motionCount+=r.metadata.motionCount,e.metadata.morphCount+=r.metadata.morphCount,e.metadata.cameraCount+=r.metadata.cameraCount;for(var n=0;n<r.metadata.motionCount;n++)e.motions.push(r.motions[n]);for(n=0;n<r.metadata.morphCount;n++)e.morphs.push(r.morphs[n]);for(n=0;n<r.metadata.cameraCount;n++)e.cameras.push(r.cameras[n])}return e},n.prototype.leftToRightModel=function(t){if("right"!==t.metadata.coordinateSystem){t.metadata.coordinateSystem="right";for(var e=new r,i=0;i<t.metadata.vertexCount;i++)e.leftToRightVector3(t.vertices[i].position),e.leftToRightVector3(t.vertices[i].normal);for(i=0;i<t.metadata.faceCount;i++)e.leftToRightIndexOrder(t.faces[i].indices);for(i=0;i<t.metadata.boneCount;i++)e.leftToRightVector3(t.bones[i].position);for(i=0;i<t.metadata.morphCount;i++){var n=t.morphs[i];if("pmx"!==t.metadata.format||1===n.type)for(var o=0;o<n.elements.length;o++)e.leftToRightVector3(n.elements[o].position)}for(i=0;i<t.metadata.rigidBodyCount;i++)e.leftToRightVector3(t.rigidBodies[i].position),e.leftToRightEuler(t.rigidBodies[i].rotation);for(i=0;i<t.metadata.constraintCount;i++)e.leftToRightVector3(t.constraints[i].position),e.leftToRightEuler(t.constraints[i].rotation),e.leftToRightVector3Range(t.constraints[i].translationLimitation1,t.constraints[i].translationLimitation2),e.leftToRightEulerRange(t.constraints[i].rotationLimitation1,t.constraints[i].rotationLimitation2)}},n.prototype.leftToRightVmd=function(t){if("right"!==t.metadata.coordinateSystem){t.metadata.coordinateSystem="right";for(var e=new r,i=0;i<t.metadata.motionCount;i++)e.leftToRightVector3(t.motions[i].position),e.leftToRightQuaternion(t.motions[i].rotation);for(i=0;i<t.metadata.cameraCount;i++)e.leftToRightVector3(t.cameras[i].position),e.leftToRightEuler(t.cameras[i].rotation)}},n.prototype.leftToRightVpd=function(t){if("right"!==t.metadata.coordinateSystem){t.metadata.coordinateSystem="right";for(var e=new r,i=0;i<t.bones.length;i++)e.leftToRightVector3(t.bones[i].translation),e.leftToRightQuaternion(t.bones[i].quaternion)}},t.CharsetEncoder=e,t.Parser=n,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,i){"use strict";i.r(e),i.d(e,"KeepAssets",(function(){return me})),i.d(e,"InstantiatedEntries",(function(){return ye})),i.d(e,"AssetContainer",(function(){return ve}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)};function n(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var o=function(){return(o=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function s(t,e,i,r){var n,o=arguments.length,s=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(o<3?n(s):o>3?n(e,i,s):n(e,i))||s);return o>3&&s&&Object.defineProperty(e,i,s),s}Object.create;Object.create;var a=function(){function t(){this.rootNodes=new Array,this.cameras=new Array,this.lights=new Array,this.meshes=new Array,this.skeletons=new Array,this.particleSystems=new Array,this.animations=[],this.animationGroups=new Array,this.multiMaterials=new Array,this.materials=new Array,this.morphTargetManagers=new Array,this.geometries=new Array,this.transformNodes=new Array,this.actionManagers=new Array,this.textures=new Array,this._environmentTexture=null,this.postProcesses=new Array}return t.AddParser=function(t,e){this._BabylonFileParsers[t]=e},t.GetParser=function(t){return this._BabylonFileParsers[t]?this._BabylonFileParsers[t]:null},t.AddIndividualParser=function(t,e){this._IndividualBabylonFileParsers[t]=e},t.GetIndividualParser=function(t){return this._IndividualBabylonFileParsers[t]?this._IndividualBabylonFileParsers[t]:null},t.Parse=function(t,e,i,r){for(var n in this._BabylonFileParsers)this._BabylonFileParsers.hasOwnProperty(n)&&this._BabylonFileParsers[n](t,e,i,r)},Object.defineProperty(t.prototype,"environmentTexture",{get:function(){return this._environmentTexture},set:function(t){this._environmentTexture=t},enumerable:!1,configurable:!0}),t.prototype.getNodes=function(){var t=new Array;return t=(t=(t=(t=t.concat(this.meshes)).concat(this.lights)).concat(this.cameras)).concat(this.transformNodes),this.skeletons.forEach((function(e){return t=t.concat(e.bones)})),t},t._BabylonFileParsers={},t._IndividualBabylonFileParsers={},t}(),u=function(){function t(t,e,i,r){void 0===e&&(e=!1),this.initalize(t,e,i,r)}return t.prototype.initalize=function(t,e,i,r){return void 0===e&&(e=!1),this.mask=t,this.skipNextObservers=e,this.target=i,this.currentTarget=r,this},t}(),h=function(t,e,i){void 0===i&&(i=null),this.callback=t,this.mask=e,this.scope=i,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1},l=(function(){function t(){}t.prototype.dispose=function(){if(this._observers&&this._observables)for(var t=0;t<this._observers.length;t++)this._observables[t].remove(this._observers[t]);this._observers=null,this._observables=null},t.Watch=function(e,i,r,n){void 0===r&&(r=-1),void 0===n&&(n=null);var o=new t;o._observers=new Array,o._observables=e;for(var s=0,a=e;s<a.length;s++){var u=a[s].add(i,r,!1,n);u&&o._observers.push(u)}return o}}(),function(){function t(t){this._observers=new Array,this._eventState=new u(0),t&&(this._onObserverAdded=t)}return Object.defineProperty(t.prototype,"observers",{get:function(){return this._observers},enumerable:!1,configurable:!0}),t.prototype.add=function(t,e,i,r,n){if(void 0===e&&(e=-1),void 0===i&&(i=!1),void 0===r&&(r=null),void 0===n&&(n=!1),!t)return null;var o=new h(t,e,r);return o.unregisterOnNextCall=n,i?this._observers.unshift(o):this._observers.push(o),this._onObserverAdded&&this._onObserverAdded(o),o},t.prototype.addOnce=function(t){return this.add(t,void 0,void 0,void 0,!0)},t.prototype.remove=function(t){return!!t&&(-1!==this._observers.indexOf(t)&&(this._deferUnregister(t),!0))},t.prototype.removeCallback=function(t,e){for(var i=0;i<this._observers.length;i++){var r=this._observers[i];if(!r._willBeUnregistered&&(r.callback===t&&(!e||e===r.scope)))return this._deferUnregister(r),!0}return!1},t.prototype._deferUnregister=function(t){var e=this;t.unregisterOnNextCall=!1,t._willBeUnregistered=!0,setTimeout((function(){e._remove(t)}),0)},t.prototype._remove=function(t){if(!t)return!1;var e=this._observers.indexOf(t);return-1!==e&&(this._observers.splice(e,1),!0)},t.prototype.makeObserverTopPriority=function(t){this._remove(t),this._observers.unshift(t)},t.prototype.makeObserverBottomPriority=function(t){this._remove(t),this._observers.push(t)},t.prototype.notifyObservers=function(t,e,i,r,n){if(void 0===e&&(e=-1),!this._observers.length)return!0;var o=this._eventState;o.mask=e,o.target=i,o.currentTarget=r,o.skipNextObservers=!1,o.lastReturnValue=t,o.userInfo=n;for(var s=0,a=this._observers;s<a.length;s++){var u=a[s];if(!u._willBeUnregistered&&(u.mask&e&&(u.scope?o.lastReturnValue=u.callback.apply(u.scope,[t,o]):o.lastReturnValue=u.callback(t,o),u.unregisterOnNextCall&&this._deferUnregister(u)),o.skipNextObservers))return!1}return!0},t.prototype.notifyObserversWithPromise=function(t,e,i,r,n){var o=this;void 0===e&&(e=-1);var s=Promise.resolve(t);if(!this._observers.length)return s;var a=this._eventState;return a.mask=e,a.target=i,a.currentTarget=r,a.skipNextObservers=!1,a.userInfo=n,this._observers.forEach((function(i){a.skipNextObservers||i._willBeUnregistered||i.mask&e&&(s=i.scope?s.then((function(e){return a.lastReturnValue=e,i.callback.apply(i.scope,[t,a])})):s.then((function(e){return a.lastReturnValue=e,i.callback(t,a)})),i.unregisterOnNextCall&&o._deferUnregister(i))})),s.then((function(){return t}))},t.prototype.notifyObserver=function(t,e,i){void 0===i&&(i=-1);var r=this._eventState;r.mask=i,r.skipNextObservers=!1,t.callback(e,r)},t.prototype.hasObservers=function(){return this._observers.length>0},t.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},t.prototype.clone=function(){var e=new t;return e._observers=this._observers.slice(0),e},t.prototype.hasSpecificMask=function(t){void 0===t&&(t=-1);for(var e=0,i=this._observers;e<i.length;e++){var r=i[e];if(r.mask&t||r.mask===t)return!0}return!1},t}()),c=function(){function t(){}return t.IsWindowObjectExist=function(){return"undefined"!=typeof window},t.IsNavigatorAvailable=function(){return"undefined"!=typeof navigator},t.IsDocumentAvailable=function(){return"undefined"!=typeof document},t.GetDOMTextContent=function(t){for(var e="",i=t.firstChild;i;)3===i.nodeType&&(e+=i.textContent),i=i.nextSibling;return e},t}(),f=function(){function t(){}return t._AddLogEntry=function(e){t._LogCache=e+t._LogCache,t.OnNewCacheEntry&&t.OnNewCacheEntry(e)},t._FormatMessage=function(t){var e=function(t){return t<10?"0"+t:""+t},i=new Date;return"["+e(i.getHours())+":"+e(i.getMinutes())+":"+e(i.getSeconds())+"]: "+t},t._LogDisabled=function(t){},t._LogEnabled=function(e){var i=t._FormatMessage(e);console.log("BJS - "+i);var r="<div style='color:white'>"+i+"</div><br>";t._AddLogEntry(r)},t._WarnDisabled=function(t){},t._WarnEnabled=function(e){var i=t._FormatMessage(e);console.warn("BJS - "+i);var r="<div style='color:orange'>"+i+"</div><br>";t._AddLogEntry(r)},t._ErrorDisabled=function(t){},t._ErrorEnabled=function(e){t.errorsCount++;var i=t._FormatMessage(e);console.error("BJS - "+i);var r="<div style='color:red'>"+i+"</div><br>";t._AddLogEntry(r)},Object.defineProperty(t,"LogCache",{get:function(){return t._LogCache},enumerable:!1,configurable:!0}),t.ClearLogCache=function(){t._LogCache="",t.errorsCount=0},Object.defineProperty(t,"LogLevels",{set:function(e){(e&t.MessageLogLevel)===t.MessageLogLevel?t.Log=t._LogEnabled:t.Log=t._LogDisabled,(e&t.WarningLogLevel)===t.WarningLogLevel?t.Warn=t._WarnEnabled:t.Warn=t._WarnDisabled,(e&t.ErrorLogLevel)===t.ErrorLogLevel?t.Error=t._ErrorEnabled:t.Error=t._ErrorDisabled},enumerable:!1,configurable:!0}),t.NoneLogLevel=0,t.MessageLogLevel=1,t.WarningLogLevel=2,t.ErrorLogLevel=4,t.AllLogLevel=7,t._LogCache="",t.errorsCount=0,t.Log=t._LogEnabled,t.Warn=t._WarnEnabled,t.Error=t._ErrorEnabled,t}(),d=function(){function t(){}return t.EndsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},t.StartsWith=function(t,e){return!!t&&0===t.indexOf(e)},t.Decode=function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return e},t.EncodeArrayBufferToBase64=function(t){for(var e,i,r,n,o,s,a,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="",l=0,c=ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t);l<c.length;)n=(e=c[l++])>>2,o=(3&e)<<4|(i=l<c.length?c[l++]:Number.NaN)>>4,s=(15&i)<<2|(r=l<c.length?c[l++]:Number.NaN)>>6,a=63&r,isNaN(i)?s=a=64:isNaN(r)&&(a=64),h+=u.charAt(n)+u.charAt(o)+u.charAt(s)+u.charAt(a);return h},t.PadNumber=function(t,e){for(var i=String(t);i.length<e;)i="0"+i;return i},t}(),p=function(t,e){return t?t.getClassName&&"Mesh"===t.getClassName()?null:t.getClassName&&"SubMesh"===t.getClassName()?t.clone(e):t.clone?t.clone():null:null};var _=function(){function t(){}return t.DeepCopy=function(t,e,i,r){for(var n=0,o=function(t){var e=[];do{Object.getOwnPropertyNames(t).forEach((function(t){-1===e.indexOf(t)&&e.push(t)}))}while(t=Object.getPrototypeOf(t));return e}(t);n<o.length;n++){var s=o[n];if(("_"!==s[0]||r&&-1!==r.indexOf(s))&&!(d.EndsWith(s,"Observable")||i&&-1!==i.indexOf(s))){var a=t[s],u=typeof a;if("function"!==u)try{if("object"===u)if(a instanceof Array){if(e[s]=[],a.length>0)if("object"==typeof a[0])for(var h=0;h<a.length;h++){var l=p(a[h],e);-1===e[s].indexOf(l)&&e[s].push(l)}else e[s]=a.slice(0)}else e[s]=p(a,e);else e[s]=a}catch(t){f.Warn(t.message)}}}},t}(),g=function(){function t(){}return Object.defineProperty(t,"Now",{get:function(){return c.IsWindowObjectExist()&&window.performance&&window.performance.now?window.performance.now():Date.now()},enumerable:!1,configurable:!0}),t}(),m=function(){function t(){}return t.WarnImport=function(t){return t+" needs to be imported before as it contains a side-effect required by your code."},t}();var y,v=function(){function t(){this._xhr="undefined"!=typeof _native&&_native.XMLHttpRequest?new _native.XMLHttpRequest:new XMLHttpRequest}return t.prototype._injectCustomRequestHeaders=function(){for(var e in t.CustomRequestHeaders){var i=t.CustomRequestHeaders[e];i&&this._xhr.setRequestHeader(e,i)}},Object.defineProperty(t.prototype,"onprogress",{get:function(){return this._xhr.onprogress},set:function(t){this._xhr.onprogress=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return this._xhr.readyState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this._xhr.status},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"statusText",{get:function(){return this._xhr.statusText},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"response",{get:function(){return this._xhr.response},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"responseURL",{get:function(){return this._xhr.responseURL},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"responseText",{get:function(){return this._xhr.responseText},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"responseType",{get:function(){return this._xhr.responseType},set:function(t){this._xhr.responseType=t},enumerable:!1,configurable:!0}),t.prototype.addEventListener=function(t,e,i){this._xhr.addEventListener(t,e,i)},t.prototype.removeEventListener=function(t,e,i){this._xhr.removeEventListener(t,e,i)},t.prototype.abort=function(){this._xhr.abort()},t.prototype.send=function(e){t.CustomRequestHeaders&&this._injectCustomRequestHeaders(),this._xhr.send(e)},t.prototype.open=function(e,i){for(var r=0,n=t.CustomRequestModifiers;r<n.length;r++){(0,n[r])(this._xhr,i)}return i=(i=i.replace("file:http:","http:")).replace("file:https:","https:"),this._xhr.open(e,i,!0)},t.prototype.setRequestHeader=function(t,e){this._xhr.setRequestHeader(t,e)},t.prototype.getResponseHeader=function(t){return this._xhr.getResponseHeader(t)},t.CustomRequestHeaders={},t.CustomRequestModifiers=new Array,t}(),b=function(){function t(){}return Object.defineProperty(t,"LastCreatedEngine",{get:function(){return 0===this.Instances.length?null:this.Instances[this.Instances.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(t,"LastCreatedScene",{get:function(){return this._LastCreatedScene},enumerable:!1,configurable:!0}),t.Instances=new Array,t._LastCreatedScene=null,t.UseFallbackTexture=!0,t.FallbackTexture="",t}(),x=function(){function t(){}return t.FilesToLoad={},t}(),A=function(){function t(){}return t.ExponentialBackoff=function(t,e){return void 0===t&&(t=3),void 0===e&&(e=500),function(i,r,n){return 0!==r.status||n>=t||-1!==i.indexOf("file:")?-1:Math.pow(2,n)*e}},t}(),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e._setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e}(Error),T=function(){function t(){this.children=[]}return t.prototype.isValid=function(t){return!0},t.prototype.process=function(t,e){var i="";if(this.line){var r=this.line,n=e.processor;if(n){if(n.lineProcessor&&(r=n.lineProcessor(r,e.isFragment)),n.attributeProcessor&&d.StartsWith(this.line,"attribute"))r=n.attributeProcessor(this.line);else if(n.varyingProcessor&&d.StartsWith(this.line,"varying"))r=n.varyingProcessor(this.line,e.isFragment);else if((n.uniformProcessor||n.uniformBufferProcessor)&&d.StartsWith(this.line,"uniform")){/uniform (.+) (.+)/.test(this.line)?n.uniformProcessor&&(r=n.uniformProcessor(this.line,e.isFragment)):n.uniformBufferProcessor&&(r=n.uniformBufferProcessor(this.line,e.isFragment),e.lookForClosingBracketForUniformBuffer=!0)}n.endOfUniformBufferProcessor&&e.lookForClosingBracketForUniformBuffer&&-1!==this.line.indexOf("}")&&(e.lookForClosingBracketForUniformBuffer=!1,r=n.endOfUniformBufferProcessor(this.line,e.isFragment))}i+=r+"\r\n"}return this.children.forEach((function(r){i+=r.process(t,e)})),this.additionalDefineKey&&(t[this.additionalDefineKey]=this.additionalDefineValue||"true"),i},t}(),M=function(){function t(){}return Object.defineProperty(t.prototype,"currentLine",{get:function(){return this._lines[this.lineIndex]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canRead",{get:function(){return this.lineIndex<this._lines.length-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lines",{set:function(t){this._lines=[];for(var e=0,i=t;e<i.length;e++){var r=i[e];if("#"!==r[0])for(var n=r.split(";"),o=0;o<n.length;o++){var s=n[o];(s=s.trim())&&this._lines.push(s+(o!==n.length-1?";":""))}else this._lines.push(r)}},enumerable:!1,configurable:!0}),t}(),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.process=function(t,e){for(var i=0;i<this.children.length;i++){var r=this.children[i];if(r.isValid(t))return r.process(t,e)}return""},e}(T),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.isValid=function(t){return this.testExpression.isTrue(t)},e}(T),F=function(){function t(){}return t.prototype.isTrue=function(t){return!0},t.postfixToInfix=function(e){for(var i=[],r=0,n=e;r<n.length;r++){var o=n[r];if(void 0===t._OperatorPriority[o])i.push(o);else{var s=i[i.length-1],a=i[i.length-2];i.length-=2,i.push("("+a+o+s+")")}}return i[i.length-1]},t.infixToPostfix=function(e){for(var i=[],r=-1,n=function(){""!==(h=h.trim())&&(i.push(h),h="")},o=function(e){r<t._Stack.length-1&&(t._Stack[++r]=e)},s=function(){return t._Stack[r]},a=function(){return-1===r?"!!INVALID EXPRESSION!!":t._Stack[r--]},u=0,h="";u<e.length;){var l=e.charAt(u),c=u<e.length-1?e.substr(u,2):"";if("("===l)h="",o(l);else if(")"===l){for(n();-1!==r&&"("!==s();)i.push(a());a()}else if(t._OperatorPriority[c]>1){for(n();-1!==r&&t._OperatorPriority[s()]>=t._OperatorPriority[c];)i.push(a());o(c),u++}else h+=l;u++}for(n();-1!==r;)"("===s()?a():i.push(a());return i},t._OperatorPriority={")":0,"(":1,"||":2,"&&":3},t._Stack=["","","","","","","","","","","","","","","","","","","",""],t}(),S=function(t){function e(e,i){void 0===i&&(i=!1);var r=t.call(this)||this;return r.define=e,r.not=i,r}return n(e,t),e.prototype.isTrue=function(t){var e=void 0!==t[this.define];return this.not&&(e=!e),e},e}(F),D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.isTrue=function(t){return this.leftOperand.isTrue(t)||this.rightOperand.isTrue(t)},e}(F),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.isTrue=function(t){return this.leftOperand.isTrue(t)&&this.rightOperand.isTrue(t)},e}(F),C=function(t){function e(e,i,r){var n=t.call(this)||this;return n.define=e,n.operand=i,n.testValue=r,n}return n(e,t),e.prototype.isTrue=function(t){var e=t[this.define];void 0===e&&(e=this.define);var i=!1,r=parseInt(e),n=parseInt(this.testValue);switch(this.operand){case">":i=r>n;break;case"<":i=r<n;break;case"<=":i=r<=n;break;case">=":i=r>=n;break;case"==":i=r===n}return i},e}(F),B=/defined\s*?\((.+?)\)/g,w=/defined\s*?\[(.+?)\]/g,O=function(){function t(){}return t.Process=function(t,e,i,r){var n=this;this._ProcessIncludes(t,e,(function(t){var o=n._ProcessShaderConversion(t,e,r);i(o)}))},t._ProcessPrecision=function(t,e){var i=e.shouldUseHighPrecisionShader;return-1===t.indexOf("precision highp float")?t=i?"precision highp float;\n"+t:"precision mediump float;\n"+t:i||(t=t.replace("precision highp float","precision mediump float")),t},t._ExtractOperation=function(t){var e=/defined\((.+)\)/.exec(t);if(e&&e.length)return new S(e[1].trim(),"!"===t[0]);for(var i="",r=0,n=0,o=["==",">=","<=","<",">"];n<o.length&&(i=o[n],!((r=t.indexOf(i))>-1));n++);if(-1===r)return new S(t);var s=t.substring(0,r).trim(),a=t.substring(r+i.length).trim();return new C(s,i,a)},t._BuildSubExpression=function(t){t=t.replace(B,"defined[$1]");for(var e=[],i=0,r=F.infixToPostfix(t);i<r.length;i++){var n=r[i];if("||"!==n&&"&&"!==n)e.push(n);else if(e.length>=2){var o=e[e.length-1],s=e[e.length-2];e.length-=2;var a="&&"==n?new P:new D;"string"==typeof o&&(o=o.replace(w,"defined($1)")),"string"==typeof s&&(s=s.replace(w,"defined($1)")),a.leftOperand="string"==typeof s?this._ExtractOperation(s):s,a.rightOperand="string"==typeof o?this._ExtractOperation(o):o,e.push(a)}}var u=e[e.length-1];return"string"==typeof u&&(u=u.replace(w,"defined($1)")),"string"==typeof u?this._ExtractOperation(u):u},t._BuildExpression=function(t,e){var i=new I,r=t.substring(0,e),n=t.substring(e);return n=n.substring(0,(n.indexOf("//")+1||n.length+1)-1).trim(),i.testExpression="#ifdef"===r?new S(n):"#ifndef"===r?new S(n,!0):this._BuildSubExpression(n),i},t._MoveCursorWithinIf=function(t,e,i){for(var r=t.currentLine;this._MoveCursor(t,i);){var n=(r=t.currentLine).substring(0,5).toLowerCase();if("#else"===n){var o=new T;return e.children.push(o),void this._MoveCursor(t,o)}if("#elif"===n){var s=this._BuildExpression(r,5);e.children.push(s),i=s}}},t._MoveCursor=function(t,e){for(;t.canRead;){t.lineIndex++;var i=t.currentLine,r=/(#ifdef)|(#else)|(#elif)|(#endif)|(#ifndef)|(#if)/.exec(i);if(r&&r.length){switch(r[0]){case"#ifdef":var n=new R;e.children.push(n);var o=this._BuildExpression(i,6);n.children.push(o),this._MoveCursorWithinIf(t,n,o);break;case"#else":case"#elif":return!0;case"#endif":return!1;case"#ifndef":n=new R;e.children.push(n);o=this._BuildExpression(i,7);n.children.push(o),this._MoveCursorWithinIf(t,n,o);break;case"#if":n=new R,o=this._BuildExpression(i,3);e.children.push(n),n.children.push(o),this._MoveCursorWithinIf(t,n,o)}}else{var s=new T;if(s.line=i,e.children.push(s),"#"===i[0]&&"d"===i[1]){var a=i.replace(";","").split(" ");s.additionalDefineKey=a[1],3===a.length&&(s.additionalDefineValue=a[2])}}}return!1},t._EvaluatePreProcessors=function(t,e,i){var r=new T,n=new M;return n.lineIndex=-1,n.lines=t.split("\n"),this._MoveCursor(n,r),r.process(e,i)},t._PreparePreProcessors=function(t){for(var e={},i=0,r=t.defines;i<r.length;i++){var n=r[i].replace("#define","").replace(";","").trim().split(" ");e[n[0]]=n.length>1?n[1]:""}return e.GL_ES="true",e.__VERSION__=t.version,e[t.platformName]="true",e},t._ProcessShaderConversion=function(t,e,i){var r=this._ProcessPrecision(t,e);if(!e.processor)return r;if(-1!==r.indexOf("#version 3"))return r.replace("#version 300 es","");var n=e.defines,o=this._PreparePreProcessors(e);return e.processor.preProcessor&&(r=e.processor.preProcessor(r,n,e.isFragment)),r=this._EvaluatePreProcessors(r,o,e),e.processor.postProcessor&&(r=e.processor.postProcessor(r,n,e.isFragment,i)),r},t._ProcessIncludes=function(e,i,r){for(var n=this,o=/#include<(.+)>(\((.*)\))*(\[(.*)\])*/g,s=o.exec(e),a=new String(e),u=!1;null!=s;){var h=s[1];if(-1!==h.indexOf("__decl__")&&(h=h.replace(/__decl__/,""),i.supportsUniformBuffers&&(h=(h=h.replace(/Vertex/,"Ubo")).replace(/Fragment/,"Ubo")),h+="Declaration"),!i.includesShadersStore[h]){var l=i.shadersRepository+"ShadersInclude/"+h+".fx";return void t._FileToolsLoadFile(l,(function(t){i.includesShadersStore[h]=t,n._ProcessIncludes(a,i,r)}))}var c=i.includesShadersStore[h];if(s[2])for(var f=s[3].split(","),d=0;d<f.length;d+=2){var p=new RegExp(f[d],"g"),_=f[d+1];c=c.replace(p,_)}if(s[4]){var g=s[5];if(-1!==g.indexOf("..")){var m=g.split(".."),y=parseInt(m[0]),v=parseInt(m[1]),b=c.slice(0);c="",isNaN(v)&&(v=i.indexParameters[m[1]]);for(var x=y;x<v;x++)i.supportsUniformBuffers||(b=b.replace(/light\{X\}.(\w*)/g,(function(t,e){return e+"{X}"}))),c+=b.replace(/\{X\}/g,x.toString())+"\n"}else i.supportsUniformBuffers||(c=c.replace(/light\{X\}.(\w*)/g,(function(t,e){return e+"{X}"}))),c=c.replace(/\{X\}/g,g)}a=a.replace(s[0],c),u=u||c.indexOf("#include<")>=0,s=o.exec(e)}u?this._ProcessIncludes(a.toString(),i,r):r(a)},t._FileToolsLoadFile=function(t,e,i,r,n,o){throw m.WarnImport("FileTools")},t}(),L=function(){function t(e,i,r,n,o,s,a,u,h,f){var d,p=this;void 0===n&&(n=null),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===h&&(h=null),this.name=null,this.defines="",this.onCompiled=null,this.onError=null,this.onBind=null,this.uniqueId=0,this.onCompileObservable=new l,this.onErrorObservable=new l,this._onBindObservable=null,this._wasPreviouslyReady=!1,this._bonesComputationForcedToCPU=!1,this._multiTarget=!1,this._uniformBuffersNames={},this._samplers={},this._isReady=!1,this._compilationError="",this._allFallbacksProcessed=!1,this._uniforms={},this._key="",this._fallbacks=null,this._vertexSourceCode="",this._fragmentSourceCode="",this._vertexSourceCodeOverride="",this._fragmentSourceCodeOverride="",this._transformFeedbackVaryings=null,this._rawVertexSourceCode="",this._rawFragmentSourceCode="",this._pipelineContext=null,this._valueCache={},this.name=e;var _,g,m=null;if(i.attributes){var y=i;if(this._engine=r,this._attributesNames=y.attributes,this._uniformsNames=y.uniformsNames.concat(y.samplers),this._samplerList=y.samplers.slice(),this.defines=y.defines,this.onError=y.onError,this.onCompiled=y.onCompiled,this._fallbacks=y.fallbacks,this._indexParameters=y.indexParameters,this._transformFeedbackVaryings=y.transformFeedbackVaryings||null,this._multiTarget=!!y.multiTarget,y.uniformBuffersNames){this._uniformBuffersNamesList=y.uniformBuffersNames.slice();for(var v=0;v<y.uniformBuffersNames.length;v++)this._uniformBuffersNames[y.uniformBuffersNames[v]]=v}m=null!==(d=y.processFinalCode)&&void 0!==d?d:null}else this._engine=o,this.defines=null==s?"":s,this._uniformsNames=r.concat(n),this._samplerList=n?n.slice():[],this._attributesNames=i,this._uniformBuffersNamesList=[],this.onError=h,this.onCompiled=u,this._indexParameters=f,this._fallbacks=a;this._attributeLocationByName={},this.uniqueId=t._uniqueIdSeed++;var b=c.IsWindowObjectExist()?this._engine.getHostDocument():null;e.vertexSource?_="source:"+e.vertexSource:e.vertexElement?(_=b?b.getElementById(e.vertexElement):null)||(_=e.vertexElement):_=e.vertex||e,e.fragmentSource?g="source:"+e.fragmentSource:e.fragmentElement?(g=b?b.getElementById(e.fragmentElement):null)||(g=e.fragmentElement):g=e.fragment||e;var x={defines:this.defines.split("\n"),indexParameters:this._indexParameters,isFragment:!1,shouldUseHighPrecisionShader:this._engine._shouldUseHighPrecisionShader,processor:this._engine._shaderProcessor,supportsUniformBuffers:this._engine.supportsUniformBuffers,shadersRepository:t.ShadersRepository,includesShadersStore:t.IncludesShadersStore,version:(100*this._engine.webGLVersion).toString(),platformName:this._engine.webGLVersion>=2?"WEBGL2":"WEBGL1"};this._loadShader(_,"Vertex","",(function(t){p._rawVertexSourceCode=t,p._loadShader(g,"Fragment","Pixel",(function(i){p._rawFragmentSourceCode=i,O.Process(t,x,(function(t){m&&(t=m("vertex",t)),x.isFragment=!0,O.Process(i,x,(function(i){m&&(i=m("fragment",i)),p._useFinalCode(t,i,e)}),p._engine)}),p._engine)}))}))}return Object.defineProperty(t.prototype,"onBindObservable",{get:function(){return this._onBindObservable||(this._onBindObservable=new l),this._onBindObservable},enumerable:!1,configurable:!0}),t.prototype._useFinalCode=function(t,e,i){if(i){var r=i.vertexElement||i.vertex||i.spectorName||i,n=i.fragmentElement||i.fragment||i.spectorName||i;this._vertexSourceCode="#define SHADER_NAME vertex:"+r+"\n"+t,this._fragmentSourceCode="#define SHADER_NAME fragment:"+n+"\n"+e}else this._vertexSourceCode=t,this._fragmentSourceCode=e;this._prepareEffect()},Object.defineProperty(t.prototype,"key",{get:function(){return this._key},enumerable:!1,configurable:!0}),t.prototype.isReady=function(){try{return this._isReadyInternal()}catch(t){return!1}},t.prototype._isReadyInternal=function(){return!!this._isReady||!!this._pipelineContext&&this._pipelineContext.isReady},t.prototype.getEngine=function(){return this._engine},t.prototype.getPipelineContext=function(){return this._pipelineContext},t.prototype.getAttributesNames=function(){return this._attributesNames},t.prototype.getAttributeLocation=function(t){return this._attributes[t]},t.prototype.getAttributeLocationByName=function(t){return this._attributeLocationByName[t]},t.prototype.getAttributesCount=function(){return this._attributes.length},t.prototype.getUniformIndex=function(t){return this._uniformsNames.indexOf(t)},t.prototype.getUniform=function(t){return this._uniforms[t]},t.prototype.getSamplers=function(){return this._samplerList},t.prototype.getUniformNames=function(){return this._uniformsNames},t.prototype.getUniformBuffersNames=function(){return this._uniformBuffersNamesList},t.prototype.getIndexParameters=function(){return this._indexParameters},t.prototype.getCompilationError=function(){return this._compilationError},t.prototype.allFallbacksProcessed=function(){return this._allFallbacksProcessed},t.prototype.executeWhenCompiled=function(t){var e=this;this.isReady()?t(this):(this.onCompileObservable.add((function(e){t(e)})),this._pipelineContext&&!this._pipelineContext.isAsync||setTimeout((function(){e._checkIsReady(null)}),16))},t.prototype._checkIsReady=function(t){var e=this;try{if(this._isReadyInternal())return}catch(e){return void this._processCompilationErrors(e,t)}setTimeout((function(){e._checkIsReady(t)}),16)},t.prototype._loadShader=function(e,i,r,n){var o;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return void n(c.GetDOMTextContent(e));"source:"!==e.substr(0,7)?"base64:"!==e.substr(0,7)?t.ShadersStore[e+i+"Shader"]?n(t.ShadersStore[e+i+"Shader"]):r&&t.ShadersStore[e+r+"Shader"]?n(t.ShadersStore[e+r+"Shader"]):(o="."===e[0]||"/"===e[0]||e.indexOf("http")>-1?e:t.ShadersRepository+e,this._engine._loadFile(o+"."+i.toLowerCase()+".fx",n)):n(window.atob(e.substr(7))):n(e.substr(7))},Object.defineProperty(t.prototype,"vertexSourceCode",{get:function(){return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._vertexSourceCodeOverride:this._vertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fragmentSourceCode",{get:function(){return this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?this._fragmentSourceCodeOverride:this._fragmentSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rawVertexSourceCode",{get:function(){return this._rawVertexSourceCode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rawFragmentSourceCode",{get:function(){return this._rawFragmentSourceCode},enumerable:!1,configurable:!0}),t.prototype._rebuildProgram=function(t,e,i,r){var n=this;this._isReady=!1,this._vertexSourceCodeOverride=t,this._fragmentSourceCodeOverride=e,this.onError=function(t,e){r&&r(e)},this.onCompiled=function(){var t=n.getEngine().scenes;if(t)for(var e=0;e<t.length;e++)t[e].markAllMaterialsAsDirty(63);n._pipelineContext._handlesSpectorRebuildCallback(i)},this._fallbacks=null,this._prepareEffect()},t.prototype._prepareEffect=function(){var t=this,e=this._attributesNames,i=this.defines;this._valueCache={};var r=this._pipelineContext;try{var n=this._engine;this._pipelineContext=n.createPipelineContext();var o=this._rebuildProgram.bind(this);this._vertexSourceCodeOverride&&this._fragmentSourceCodeOverride?n._preparePipelineContext(this._pipelineContext,this._vertexSourceCodeOverride,this._fragmentSourceCodeOverride,!0,o,null,this._transformFeedbackVaryings):n._preparePipelineContext(this._pipelineContext,this._vertexSourceCode,this._fragmentSourceCode,!1,o,i,this._transformFeedbackVaryings),n._executeWhenRenderingStateIsCompiled(this._pipelineContext,(function(){if(n.supportsUniformBuffers)for(var i in t._uniformBuffersNames)t.bindUniformBlock(i,t._uniformBuffersNames[i]);var o;if(n.getUniforms(t._pipelineContext,t._uniformsNames).forEach((function(e,i){t._uniforms[t._uniformsNames[i]]=e})),t._attributes=n.getAttributes(t._pipelineContext,e),e)for(var s=0;s<e.length;s++){var a=e[s];t._attributeLocationByName[a]=t._attributes[s]}for(o=0;o<t._samplerList.length;o++){null==t.getUniform(t._samplerList[o])&&(t._samplerList.splice(o,1),o--)}t._samplerList.forEach((function(e,i){t._samplers[e]=i})),n.bindSamplers(t),t._compilationError="",t._isReady=!0,t.onCompiled&&t.onCompiled(t),t.onCompileObservable.notifyObservers(t),t.onCompileObservable.clear(),t._fallbacks&&t._fallbacks.unBindMesh(),r&&t.getEngine()._deletePipelineContext(r)})),this._pipelineContext.isAsync&&this._checkIsReady(r)}catch(t){this._processCompilationErrors(t,r)}},t.prototype._getShaderCodeAndErrorLine=function(t,e,i){var r=i?/FRAGMENT SHADER ERROR: 0:(\d+?):/:/VERTEX SHADER ERROR: 0:(\d+?):/,n=null;if(e&&t){var o=e.match(r);if(o&&2===o.length){var s=parseInt(o[1]),a=t.split("\n",-1);a.length>=s&&(n="Offending line ["+s+"] in "+(i?"fragment":"vertex")+" code: "+a[s-1])}}return[t,n]},t.prototype._processCompilationErrors=function(e,i){var r,n,o,s,a;void 0===i&&(i=null),this._compilationError=e.message;var u=this._attributesNames,h=this._fallbacks;if(f.Error("Unable to compile effect:"),f.Error("Uniforms: "+this._uniformsNames.map((function(t){return" "+t}))),f.Error("Attributes: "+u.map((function(t){return" "+t}))),f.Error("Defines:\r\n"+this.defines),t.LogShaderCodeOnCompilationError){var l=null,c=null,d=null;(null===(o=this._pipelineContext)||void 0===o?void 0:o._getVertexShaderCode())&&(d=(r=this._getShaderCodeAndErrorLine(this._pipelineContext._getVertexShaderCode(),this._compilationError,!1))[0],l=r[1],d&&(f.Error("Vertex code:"),f.Error(d))),(null===(s=this._pipelineContext)||void 0===s?void 0:s._getFragmentShaderCode())&&(d=(n=this._getShaderCodeAndErrorLine(null===(a=this._pipelineContext)||void 0===a?void 0:a._getFragmentShaderCode(),this._compilationError,!0))[0],c=n[1],d&&(f.Error("Fragment code:"),f.Error(d))),l&&f.Error(l),c&&f.Error(c)}f.Error("Error: "+this._compilationError),i&&(this._pipelineContext=i,this._isReady=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this)),h?(this._pipelineContext=null,h.hasMoreFallbacks?(this._allFallbacksProcessed=!1,f.Error("Trying next fallback."),this.defines=h.reduce(this.defines,this),this._prepareEffect()):(this._allFallbacksProcessed=!0,this.onError&&this.onError(this,this._compilationError),this.onErrorObservable.notifyObservers(this),this.onErrorObservable.clear(),this._fallbacks&&this._fallbacks.unBindMesh())):this._allFallbacksProcessed=!0},Object.defineProperty(t.prototype,"isSupported",{get:function(){return""===this._compilationError},enumerable:!1,configurable:!0}),t.prototype._bindTexture=function(t,e){this._engine._bindTexture(this._samplers[t],e)},t.prototype.setTexture=function(t,e){this._engine.setTexture(this._samplers[t],this._uniforms[t],e)},t.prototype.setDepthStencilTexture=function(t,e){this._engine.setDepthStencilTexture(this._samplers[t],this._uniforms[t],e)},t.prototype.setTextureArray=function(t,e){var i=t+"Ex";if(-1===this._samplerList.indexOf(i+"0")){for(var r=this._samplerList.indexOf(t),n=1;n<e.length;n++){var o=i+(n-1).toString();this._samplerList.splice(r+n,0,o)}for(var s=0,a=0,u=this._samplerList;a<u.length;a++){var h=u[a];this._samplers[h]=s,s+=1}}this._engine.setTextureArray(this._samplers[t],this._uniforms[t],e)},t.prototype.setTextureFromPostProcess=function(t,e){this._engine.setTextureFromPostProcess(this._samplers[t],e)},t.prototype.setTextureFromPostProcessOutput=function(t,e){this._engine.setTextureFromPostProcessOutput(this._samplers[t],e)},t.prototype._cacheMatrix=function(t,e){var i=this._valueCache[t],r=e.updateFlag;return(void 0===i||i!==r)&&(this._valueCache[t]=r,!0)},t.prototype._cacheFloat2=function(t,e,i){var r=this._valueCache[t];if(!r||2!==r.length)return r=[e,i],this._valueCache[t]=r,!0;var n=!1;return r[0]!==e&&(r[0]=e,n=!0),r[1]!==i&&(r[1]=i,n=!0),n},t.prototype._cacheFloat3=function(t,e,i,r){var n=this._valueCache[t];if(!n||3!==n.length)return n=[e,i,r],this._valueCache[t]=n,!0;var o=!1;return n[0]!==e&&(n[0]=e,o=!0),n[1]!==i&&(n[1]=i,o=!0),n[2]!==r&&(n[2]=r,o=!0),o},t.prototype._cacheFloat4=function(t,e,i,r,n){var o=this._valueCache[t];if(!o||4!==o.length)return o=[e,i,r,n],this._valueCache[t]=o,!0;var s=!1;return o[0]!==e&&(o[0]=e,s=!0),o[1]!==i&&(o[1]=i,s=!0),o[2]!==r&&(o[2]=r,s=!0),o[3]!==n&&(o[3]=n,s=!0),s},t.prototype.bindUniformBuffer=function(e,i){var r=this._uniformBuffersNames[i];void 0!==r&&t._baseCache[r]!==e&&(t._baseCache[r]=e,this._engine.bindUniformBufferBase(e,r))},t.prototype.bindUniformBlock=function(t,e){this._engine.bindUniformBlock(this._pipelineContext,t,e)},t.prototype.setInt=function(t,e){var i=this._valueCache[t];return void 0!==i&&i===e||this._engine.setInt(this._uniforms[t],e)&&(this._valueCache[t]=e),this},t.prototype.setIntArray=function(t,e){return this._valueCache[t]=null,this._engine.setIntArray(this._uniforms[t],e),this},t.prototype.setIntArray2=function(t,e){return this._valueCache[t]=null,this._engine.setIntArray2(this._uniforms[t],e),this},t.prototype.setIntArray3=function(t,e){return this._valueCache[t]=null,this._engine.setIntArray3(this._uniforms[t],e),this},t.prototype.setIntArray4=function(t,e){return this._valueCache[t]=null,this._engine.setIntArray4(this._uniforms[t],e),this},t.prototype.setFloatArray=function(t,e){return this._valueCache[t]=null,this._engine.setArray(this._uniforms[t],e),this},t.prototype.setFloatArray2=function(t,e){return this._valueCache[t]=null,this._engine.setArray2(this._uniforms[t],e),this},t.prototype.setFloatArray3=function(t,e){return this._valueCache[t]=null,this._engine.setArray3(this._uniforms[t],e),this},t.prototype.setFloatArray4=function(t,e){return this._valueCache[t]=null,this._engine.setArray4(this._uniforms[t],e),this},t.prototype.setArray=function(t,e){return this._valueCache[t]=null,this._engine.setArray(this._uniforms[t],e),this},t.prototype.setArray2=function(t,e){return this._valueCache[t]=null,this._engine.setArray2(this._uniforms[t],e),this},t.prototype.setArray3=function(t,e){return this._valueCache[t]=null,this._engine.setArray3(this._uniforms[t],e),this},t.prototype.setArray4=function(t,e){return this._valueCache[t]=null,this._engine.setArray4(this._uniforms[t],e),this},t.prototype.setMatrices=function(t,e){return e?(this._valueCache[t]=null,this._engine.setMatrices(this._uniforms[t],e),this):this},t.prototype.setMatrix=function(t,e){return this._cacheMatrix(t,e)&&(this._engine.setMatrices(this._uniforms[t],e.toArray())||(this._valueCache[t]=null)),this},t.prototype.setMatrix3x3=function(t,e){return this._valueCache[t]=null,this._engine.setMatrix3x3(this._uniforms[t],e),this},t.prototype.setMatrix2x2=function(t,e){return this._valueCache[t]=null,this._engine.setMatrix2x2(this._uniforms[t],e),this},t.prototype.setFloat=function(t,e){var i=this._valueCache[t];return void 0!==i&&i===e||this._engine.setFloat(this._uniforms[t],e)&&(this._valueCache[t]=e),this},t.prototype.setBool=function(t,e){var i=this._valueCache[t];return void 0!==i&&i===e||this._engine.setInt(this._uniforms[t],e?1:0)&&(this._valueCache[t]=e),this},t.prototype.setVector2=function(t,e){return this._cacheFloat2(t,e.x,e.y)&&(this._engine.setFloat2(this._uniforms[t],e.x,e.y)||(this._valueCache[t]=null)),this},t.prototype.setFloat2=function(t,e,i){return this._cacheFloat2(t,e,i)&&(this._engine.setFloat2(this._uniforms[t],e,i)||(this._valueCache[t]=null)),this},t.prototype.setVector3=function(t,e){return this._cacheFloat3(t,e.x,e.y,e.z)&&(this._engine.setFloat3(this._uniforms[t],e.x,e.y,e.z)||(this._valueCache[t]=null)),this},t.prototype.setFloat3=function(t,e,i,r){return this._cacheFloat3(t,e,i,r)&&(this._engine.setFloat3(this._uniforms[t],e,i,r)||(this._valueCache[t]=null)),this},t.prototype.setVector4=function(t,e){return this._cacheFloat4(t,e.x,e.y,e.z,e.w)&&(this._engine.setFloat4(this._uniforms[t],e.x,e.y,e.z,e.w)||(this._valueCache[t]=null)),this},t.prototype.setFloat4=function(t,e,i,r,n){return this._cacheFloat4(t,e,i,r,n)&&(this._engine.setFloat4(this._uniforms[t],e,i,r,n)||(this._valueCache[t]=null)),this},t.prototype.setColor3=function(t,e){return this._cacheFloat3(t,e.r,e.g,e.b)&&(this._engine.setFloat3(this._uniforms[t],e.r,e.g,e.b)||(this._valueCache[t]=null)),this},t.prototype.setColor4=function(t,e,i){return this._cacheFloat4(t,e.r,e.g,e.b,i)&&(this._engine.setFloat4(this._uniforms[t],e.r,e.g,e.b,i)||(this._valueCache[t]=null)),this},t.prototype.setDirectColor4=function(t,e){return this._cacheFloat4(t,e.r,e.g,e.b,e.a)&&(this._engine.setFloat4(this._uniforms[t],e.r,e.g,e.b,e.a)||(this._valueCache[t]=null)),this},t.prototype.dispose=function(){this._engine._releaseEffect(this)},t.RegisterShader=function(e,i,r){i&&(t.ShadersStore[e+"PixelShader"]=i),r&&(t.ShadersStore[e+"VertexShader"]=r)},t.ResetCache=function(){t._baseCache={}},t.ShadersRepository="src/Shaders/",t.LogShaderCodeOnCompilationError=!0,t._uniqueIdSeed=0,t._baseCache={},t.ShadersStore={},t.IncludesShadersStore={},t}(),U=function(){function t(){this._isDepthTestDirty=!1,this._isDepthMaskDirty=!1,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1,this.reset()}return Object.defineProperty(t.prototype,"isDirty",{get:function(){return this._isDepthFuncDirty||this._isDepthTestDirty||this._isDepthMaskDirty||this._isCullFaceDirty||this._isCullDirty||this._isZOffsetDirty||this._isFrontFaceDirty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zOffset",{get:function(){return this._zOffset},set:function(t){this._zOffset!==t&&(this._zOffset=t,this._isZOffsetDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cullFace",{get:function(){return this._cullFace},set:function(t){this._cullFace!==t&&(this._cullFace=t,this._isCullFaceDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cull",{get:function(){return this._cull},set:function(t){this._cull!==t&&(this._cull=t,this._isCullDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthFunc",{get:function(){return this._depthFunc},set:function(t){this._depthFunc!==t&&(this._depthFunc=t,this._isDepthFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthMask",{get:function(){return this._depthMask},set:function(t){this._depthMask!==t&&(this._depthMask=t,this._isDepthMaskDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTest",{get:function(){return this._depthTest},set:function(t){this._depthTest!==t&&(this._depthTest=t,this._isDepthTestDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frontFace",{get:function(){return this._frontFace},set:function(t){this._frontFace!==t&&(this._frontFace=t,this._isFrontFaceDirty=!0)},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this._depthMask=!0,this._depthTest=!0,this._depthFunc=null,this._cullFace=null,this._cull=null,this._zOffset=0,this._frontFace=null,this._isDepthTestDirty=!0,this._isDepthMaskDirty=!0,this._isDepthFuncDirty=!1,this._isCullFaceDirty=!1,this._isCullDirty=!1,this._isZOffsetDirty=!1,this._isFrontFaceDirty=!1},t.prototype.apply=function(t){this.isDirty&&(this._isCullDirty&&(this.cull?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this._isCullDirty=!1),this._isCullFaceDirty&&(t.cullFace(this.cullFace),this._isCullFaceDirty=!1),this._isDepthMaskDirty&&(t.depthMask(this.depthMask),this._isDepthMaskDirty=!1),this._isDepthTestDirty&&(this.depthTest?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this._isDepthTestDirty=!1),this._isDepthFuncDirty&&(t.depthFunc(this.depthFunc),this._isDepthFuncDirty=!1),this._isZOffsetDirty&&(this.zOffset?(t.enable(t.POLYGON_OFFSET_FILL),t.polygonOffset(this.zOffset,0)):t.disable(t.POLYGON_OFFSET_FILL),this._isZOffsetDirty=!1),this._isFrontFaceDirty&&(t.frontFace(this.frontFace),this._isFrontFaceDirty=!1))},t}(),N=function(){function t(){this._isStencilTestDirty=!1,this._isStencilMaskDirty=!1,this._isStencilFuncDirty=!1,this._isStencilOpDirty=!1,this.reset()}return Object.defineProperty(t.prototype,"isDirty",{get:function(){return this._isStencilTestDirty||this._isStencilMaskDirty||this._isStencilFuncDirty||this._isStencilOpDirty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stencilFunc",{get:function(){return this._stencilFunc},set:function(t){this._stencilFunc!==t&&(this._stencilFunc=t,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stencilFuncRef",{get:function(){return this._stencilFuncRef},set:function(t){this._stencilFuncRef!==t&&(this._stencilFuncRef=t,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stencilFuncMask",{get:function(){return this._stencilFuncMask},set:function(t){this._stencilFuncMask!==t&&(this._stencilFuncMask=t,this._isStencilFuncDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stencilOpStencilFail",{get:function(){return this._stencilOpStencilFail},set:function(t){this._stencilOpStencilFail!==t&&(this._stencilOpStencilFail=t,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stencilOpDepthFail",{get:function(){return this._stencilOpDepthFail},set:function(t){this._stencilOpDepthFail!==t&&(this._stencilOpDepthFail=t,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stencilOpStencilDepthPass",{get:function(){return this._stencilOpStencilDepthPass},set:function(t){this._stencilOpStencilDepthPass!==t&&(this._stencilOpStencilDepthPass=t,this._isStencilOpDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stencilMask",{get:function(){return this._stencilMask},set:function(t){this._stencilMask!==t&&(this._stencilMask=t,this._isStencilMaskDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stencilTest",{get:function(){return this._stencilTest},set:function(t){this._stencilTest!==t&&(this._stencilTest=t,this._isStencilTestDirty=!0)},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this._stencilTest=!1,this._stencilMask=255,this._stencilFunc=t.ALWAYS,this._stencilFuncRef=1,this._stencilFuncMask=255,this._stencilOpStencilFail=t.KEEP,this._stencilOpDepthFail=t.KEEP,this._stencilOpStencilDepthPass=t.REPLACE,this._isStencilTestDirty=!0,this._isStencilMaskDirty=!0,this._isStencilFuncDirty=!0,this._isStencilOpDirty=!0},t.prototype.apply=function(t){this.isDirty&&(this._isStencilTestDirty&&(this.stencilTest?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this._isStencilTestDirty=!1),this._isStencilMaskDirty&&(t.stencilMask(this.stencilMask),this._isStencilMaskDirty=!1),this._isStencilFuncDirty&&(t.stencilFunc(this.stencilFunc,this.stencilFuncRef,this.stencilFuncMask),this._isStencilFuncDirty=!1),this._isStencilOpDirty&&(t.stencilOp(this.stencilOpStencilFail,this.stencilOpDepthFail,this.stencilOpStencilDepthPass),this._isStencilOpDirty=!1))},t.ALWAYS=519,t.KEEP=7680,t.REPLACE=7681,t}(),V=function(){function t(){this._isAlphaBlendDirty=!1,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1,this._alphaBlend=!1,this._blendFunctionParameters=new Array(4),this._blendEquationParameters=new Array(2),this._blendConstants=new Array(4),this.reset()}return Object.defineProperty(t.prototype,"isDirty",{get:function(){return this._isAlphaBlendDirty||this._isBlendFunctionParametersDirty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alphaBlend",{get:function(){return this._alphaBlend},set:function(t){this._alphaBlend!==t&&(this._alphaBlend=t,this._isAlphaBlendDirty=!0)},enumerable:!1,configurable:!0}),t.prototype.setAlphaBlendConstants=function(t,e,i,r){this._blendConstants[0]===t&&this._blendConstants[1]===e&&this._blendConstants[2]===i&&this._blendConstants[3]===r||(this._blendConstants[0]=t,this._blendConstants[1]=e,this._blendConstants[2]=i,this._blendConstants[3]=r,this._isBlendConstantsDirty=!0)},t.prototype.setAlphaBlendFunctionParameters=function(t,e,i,r){this._blendFunctionParameters[0]===t&&this._blendFunctionParameters[1]===e&&this._blendFunctionParameters[2]===i&&this._blendFunctionParameters[3]===r||(this._blendFunctionParameters[0]=t,this._blendFunctionParameters[1]=e,this._blendFunctionParameters[2]=i,this._blendFunctionParameters[3]=r,this._isBlendFunctionParametersDirty=!0)},t.prototype.setAlphaEquationParameters=function(t,e){this._blendEquationParameters[0]===t&&this._blendEquationParameters[1]===e||(this._blendEquationParameters[0]=t,this._blendEquationParameters[1]=e,this._isBlendEquationParametersDirty=!0)},t.prototype.reset=function(){this._alphaBlend=!1,this._blendFunctionParameters[0]=null,this._blendFunctionParameters[1]=null,this._blendFunctionParameters[2]=null,this._blendFunctionParameters[3]=null,this._blendEquationParameters[0]=null,this._blendEquationParameters[1]=null,this._blendConstants[0]=null,this._blendConstants[1]=null,this._blendConstants[2]=null,this._blendConstants[3]=null,this._isAlphaBlendDirty=!0,this._isBlendFunctionParametersDirty=!1,this._isBlendEquationParametersDirty=!1,this._isBlendConstantsDirty=!1},t.prototype.apply=function(t){this.isDirty&&(this._isAlphaBlendDirty&&(this._alphaBlend?t.enable(t.BLEND):t.disable(t.BLEND),this._isAlphaBlendDirty=!1),this._isBlendFunctionParametersDirty&&(t.blendFuncSeparate(this._blendFunctionParameters[0],this._blendFunctionParameters[1],this._blendFunctionParameters[2],this._blendFunctionParameters[3]),this._isBlendFunctionParametersDirty=!1),this._isBlendEquationParametersDirty&&(t.blendEquationSeparate(this._blendEquationParameters[0],this._blendEquationParameters[1]),this._isBlendEquationParametersDirty=!1),this._isBlendConstantsDirty&&(t.blendColor(this._blendConstants[0],this._blendConstants[1],this._blendConstants[2],this._blendConstants[3]),this._isBlendConstantsDirty=!1))},t}(),k=function(){};!function(t){t[t.Unknown=0]="Unknown",t[t.Url=1]="Url",t[t.Temp=2]="Temp",t[t.Raw=3]="Raw",t[t.Dynamic=4]="Dynamic",t[t.RenderTarget=5]="RenderTarget",t[t.MultiRenderTarget=6]="MultiRenderTarget",t[t.Cube=7]="Cube",t[t.CubeRaw=8]="CubeRaw",t[t.CubePrefiltered=9]="CubePrefiltered",t[t.Raw3D=10]="Raw3D",t[t.Raw2DArray=11]="Raw2DArray",t[t.Depth=12]="Depth",t[t.CubeRawRGBD=13]="CubeRawRGBD"}(y||(y={}));var z,W=function(){function t(t,e,i){void 0===i&&(i=!1),this.isReady=!1,this.isCube=!1,this.is3D=!1,this.is2DArray=!1,this.isMultiview=!1,this.url="",this.samplingMode=-1,this.generateMipMaps=!1,this.samples=0,this.type=-1,this.format=-1,this.onLoadedObservable=new l,this.width=0,this.height=0,this.depth=0,this.baseWidth=0,this.baseHeight=0,this.baseDepth=0,this.invertY=!1,this._invertVScale=!1,this._associatedChannel=-1,this._source=y.Unknown,this._buffer=null,this._bufferView=null,this._bufferViewArray=null,this._bufferViewArrayArray=null,this._size=0,this._extension="",this._files=null,this._workingCanvas=null,this._workingContext=null,this._framebuffer=null,this._depthStencilBuffer=null,this._MSAAFramebuffer=null,this._MSAARenderBuffer=null,this._attachments=null,this._textureArray=null,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedWrapR=null,this._cachedAnisotropicFilteringLevel=null,this._isDisabled=!1,this._compression=null,this._generateStencilBuffer=!1,this._generateDepthBuffer=!1,this._comparisonFunction=0,this._sphericalPolynomial=null,this._lodGenerationScale=0,this._lodGenerationOffset=0,this._colorTextureArray=null,this._depthStencilTextureArray=null,this._lodTextureHigh=null,this._lodTextureMid=null,this._lodTextureLow=null,this._isRGBD=!1,this._linearSpecularLOD=!1,this._irradianceTexture=null,this._webGLTexture=null,this._references=1,this._gammaSpace=null,this._engine=t,this._source=e,i||(this._webGLTexture=t._createTexture())}return t.prototype.getEngine=function(){return this._engine},Object.defineProperty(t.prototype,"source",{get:function(){return this._source},enumerable:!1,configurable:!0}),t.prototype.incrementReferences=function(){this._references++},t.prototype.updateSize=function(t,e,i){void 0===i&&(i=1),this.width=t,this.height=e,this.depth=i,this.baseWidth=t,this.baseHeight=e,this.baseDepth=i,this._size=t*e*i},t.prototype._rebuild=function(){var e,i,r=this;switch(this.isReady=!1,this._cachedCoordinatesMode=null,this._cachedWrapU=null,this._cachedWrapV=null,this._cachedAnisotropicFilteringLevel=null,this.source){case y.Temp:return;case y.Url:return void(i=this._engine.createTexture(null!==(e=this._originalUrl)&&void 0!==e?e:this.url,!this.generateMipMaps,this.invertY,null,this.samplingMode,(function(){i._swapAndDie(r),r.isReady=!0}),null,this._buffer,void 0,this.format));case y.Raw:return(i=this._engine.createRawTexture(this._bufferView,this.baseWidth,this.baseHeight,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case y.Raw3D:return(i=this._engine.createRawTexture3D(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case y.Raw2DArray:return(i=this._engine.createRawTexture2DArray(this._bufferView,this.baseWidth,this.baseHeight,this.baseDepth,this.format,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case y.Dynamic:return(i=this._engine.createDynamicTexture(this.baseWidth,this.baseHeight,this.generateMipMaps,this.samplingMode))._swapAndDie(this),void this._engine.updateDynamicTexture(this,this._engine.getRenderingCanvas(),this.invertY,void 0,void 0,!0);case y.RenderTarget:var n=new k;if(n.generateDepthBuffer=this._generateDepthBuffer,n.generateMipMaps=this.generateMipMaps,n.generateStencilBuffer=this._generateStencilBuffer,n.samplingMode=this.samplingMode,n.type=this.type,this.isCube)i=this._engine.createRenderTargetCubeTexture(this.width,n);else{var o={width:this.width,height:this.height,layers:this.is2DArray?this.depth:void 0};i=this._engine.createRenderTargetTexture(o,n)}return i._swapAndDie(this),void(this.isReady=!0);case y.Depth:var s={bilinearFiltering:2!==this.samplingMode,comparisonFunction:this._comparisonFunction,generateStencil:this._generateStencilBuffer,isCube:this.isCube},a={width:this.width,height:this.height,layers:this.is2DArray?this.depth:void 0};return(i=this._engine.createDepthStencilTexture(a,s))._swapAndDie(this),void(this.isReady=!0);case y.Cube:return void(i=this._engine.createCubeTexture(this.url,null,this._files,!this.generateMipMaps,(function(){i._swapAndDie(r),r.isReady=!0}),null,this.format,this._extension));case y.CubeRaw:return(i=this._engine.createRawCubeTexture(this._bufferViewArray,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression))._swapAndDie(this),void(this.isReady=!0);case y.CubeRawRGBD:return i=this._engine.createRawCubeTexture(null,this.width,this.format,this.type,this.generateMipMaps,this.invertY,this.samplingMode,this._compression),void t._UpdateRGBDAsync(i,this._bufferViewArrayArray,this._sphericalPolynomial,this._lodGenerationScale,this._lodGenerationOffset).then((function(){i._swapAndDie(r),r.isReady=!0}));case y.CubePrefiltered:return void((i=this._engine.createPrefilteredCubeTexture(this.url,null,this._lodGenerationScale,this._lodGenerationOffset,(function(t){t&&t._swapAndDie(r),r.isReady=!0}),null,this.format,this._extension))._sphericalPolynomial=this._sphericalPolynomial)}},t.prototype._swapAndDie=function(t){t._webGLTexture=this._webGLTexture,t._isRGBD=this._isRGBD,this._framebuffer&&(t._framebuffer=this._framebuffer),this._depthStencilBuffer&&(t._depthStencilBuffer=this._depthStencilBuffer),t._depthStencilTexture=this._depthStencilTexture,this._lodTextureHigh&&(t._lodTextureHigh&&t._lodTextureHigh.dispose(),t._lodTextureHigh=this._lodTextureHigh),this._lodTextureMid&&(t._lodTextureMid&&t._lodTextureMid.dispose(),t._lodTextureMid=this._lodTextureMid),this._lodTextureLow&&(t._lodTextureLow&&t._lodTextureLow.dispose(),t._lodTextureLow=this._lodTextureLow),this._irradianceTexture&&(t._irradianceTexture&&t._irradianceTexture.dispose(),t._irradianceTexture=this._irradianceTexture);var e,i=this._engine.getLoadedTexturesCache();-1!==(e=i.indexOf(this))&&i.splice(e,1),-1===(e=i.indexOf(t))&&i.push(t)},t.prototype.dispose=function(){this._webGLTexture&&(this._references--,0===this._references&&(this._engine._releaseTexture(this),this._webGLTexture=null))},t._UpdateRGBDAsync=function(t,e,i,r,n){throw m.WarnImport("environmentTextureTools")},t}(),K=function(){function t(){}return t.prototype.postProcessor=function(t,e,i,r){if(!r.getCaps().drawBuffersExtension){t=t.replace(/#extension.+GL_EXT_draw_buffers.+(enable|require)/g,"")}return t},t}(),j=function(){function t(){}return t.prototype.attributeProcessor=function(t){return t.replace("attribute","in")},t.prototype.varyingProcessor=function(t,e){return t.replace("varying",e?"in":"out")},t.prototype.postProcessor=function(t,e,i){var r=-1!==t.search(/#extension.+GL_EXT_draw_buffers.+require/);if(t=(t=t.replace(/#extension.+(GL_OVR_multiview2|GL_OES_standard_derivatives|GL_EXT_shader_texture_lod|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/texture2D\s*\(/g,"texture("),i)t=(t=(t=(t=(t=(t=(t=t.replace(/texture2DLodEXT\s*\(/g,"textureLod(")).replace(/textureCubeLodEXT\s*\(/g,"textureLod(")).replace(/textureCube\s*\(/g,"texture(")).replace(/gl_FragDepthEXT/g,"gl_FragDepth")).replace(/gl_FragColor/g,"glFragColor")).replace(/gl_FragData/g,"glFragData")).replace(/void\s+?main\s*\(/g,(r?"":"out vec4 glFragColor;\n")+"void main(");else if(-1!==e.indexOf("#define MULTIVIEW"))return"#extension GL_OVR_multiview2 : require\nlayout (num_views = 2) in;\n"+t;return t},t}(),G=function(t){function e(e){var i=t.call(this)||this;return i._buffer=e,i}return n(e,t),Object.defineProperty(e.prototype,"underlyingResource",{get:function(){return this._buffer},enumerable:!1,configurable:!0}),e}(function(){function t(){this.references=0,this.capacity=0,this.is32Bits=!1}return Object.defineProperty(t.prototype,"underlyingResource",{get:function(){return null},enumerable:!1,configurable:!0}),t}()),X=function(){function t(){this.vertexCompilationError=null,this.fragmentCompilationError=null,this.programLinkError=null,this.programValidationError=null}return Object.defineProperty(t.prototype,"isAsync",{get:function(){return this.isParallelCompiled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isReady",{get:function(){return!!this.program&&(!this.isParallelCompiled||this.engine._isRenderingStateCompiled(this))},enumerable:!1,configurable:!0}),t.prototype._handlesSpectorRebuildCallback=function(t){t&&this.program&&t(this.program)},t.prototype._getVertexShaderCode=function(){return this.vertexShader?this.engine._getShaderSource(this.vertexShader):null},t.prototype._getFragmentShaderCode=function(){return this.fragmentShader?this.engine._getShaderSource(this.fragmentShader):null},t}(),H=function(){function t(){}return t.CreateCanvas=function(t,e){if("undefined"==typeof document)return new OffscreenCanvas(t,e);var i=document.createElement("canvas");return i.width=t,i.height=e,i},t}(),q=function(){function t(){}return t.SetMatrixPrecision=function(e){if(t.MatrixTrackPrecisionChange=!1,e&&!t.MatrixUse64Bits&&t.MatrixTrackedMatrices)for(var i=0;i<t.MatrixTrackedMatrices.length;++i){var r=t.MatrixTrackedMatrices[i],n=r._m;r._m=new Array(16);for(var o=0;o<16;++o)r._m[o]=n[o]}t.MatrixUse64Bits=e,t.MatrixCurrentType=t.MatrixUse64Bits?Array:Float32Array,t.MatrixTrackedMatrices=null},t.MatrixUse64Bits=!1,t.MatrixTrackPrecisionChange=!0,t.MatrixCurrentType=Float32Array,t.MatrixTrackedMatrices=[],t}(),Y=function(){},Q=function(){function t(e,i,r,n){var o=this;void 0===n&&(n=!1),this.forcePOTTextures=!1,this.isFullscreen=!1,this.cullBackFaces=!0,this.renderEvenInBackground=!0,this.preventCacheWipeBetweenFrames=!1,this.validateShaderPrograms=!1,this.useReverseDepthBuffer=!1,this.disableUniformBuffers=!1,this._uniformBuffers=new Array,this._webGLVersion=1,this._windowIsBackground=!1,this._highPrecisionShadersAllowed=!0,this._badOS=!1,this._badDesktopOS=!1,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this.onContextLostObservable=new l,this.onContextRestoredObservable=new l,this._contextWasLost=!1,this._doNotHandleContextLost=!1,this.disableVertexArrayObjects=!1,this._colorWrite=!0,this._colorWriteChanged=!0,this._depthCullingState=new U,this._stencilState=new N,this._alphaState=new V,this._alphaMode=1,this._alphaEquation=0,this._internalTexturesCache=new Array,this._activeChannel=0,this._currentTextureChannel=-1,this._boundTexturesCache={},this._compiledEffects={},this._vertexAttribArraysEnabled=[],this._uintIndicesCurrentlySet=!1,this._currentBoundBuffer=new Array,this._currentFramebuffer=null,this._dummyFramebuffer=null,this._currentBufferPointers=new Array,this._currentInstanceLocations=new Array,this._currentInstanceBuffers=new Array,this._vaoRecordInProgress=!1,this._mustWipeVertexAttributes=!1,this._nextFreeTextureSlots=new Array,this._maxSimultaneousTextures=0,this._activeRequests=new Array,this._transformTextureUrl=null,this.hostInformation={isMobile:!1},this.premultipliedAlpha=!0,this.onBeforeTextureInitObservable=new l,this._viewportCached={x:0,y:0,z:0,w:0},this._unpackFlipYCached=null,this.enableUnpackFlipYCached=!0,this._getDepthStencilBuffer=function(t,e,i,r,n,s){var a=o._gl,u=a.createRenderbuffer();return a.bindRenderbuffer(a.RENDERBUFFER,u),i>1&&a.renderbufferStorageMultisample?a.renderbufferStorageMultisample(a.RENDERBUFFER,i,n,t,e):a.renderbufferStorage(a.RENDERBUFFER,r,t,e),a.framebufferRenderbuffer(a.FRAMEBUFFER,s,a.RENDERBUFFER,u),a.bindRenderbuffer(a.RENDERBUFFER,null),u},this._boundUniforms={};var s=null;if(e){if(r=r||{},q.SetMatrixPrecision(!!r.useHighPrecisionMatrix),e.getContext){if(s=e,this._renderingCanvas=s,null!=i&&(r.antialias=i),void 0===r.deterministicLockstep&&(r.deterministicLockstep=!1),void 0===r.lockstepMaxSteps&&(r.lockstepMaxSteps=4),void 0===r.timeStep&&(r.timeStep=1/60),void 0===r.preserveDrawingBuffer&&(r.preserveDrawingBuffer=!1),void 0===r.audioEngine&&(r.audioEngine=!0),void 0===r.stencil&&(r.stencil=!0),!1===r.premultipliedAlpha&&(this.premultipliedAlpha=!1),void 0===r.xrCompatible&&(r.xrCompatible=!0),this._doNotHandleContextLost=!!r.doNotHandleContextLost,navigator&&navigator.userAgent){var a=navigator.userAgent;this.hostInformation.isMobile=-1!==a.indexOf("Mobile");for(var u=0,h=t.ExceptionList;u<h.length;u++){var d=h[u],p=d.key,_=d.targets;if(new RegExp(p).test(a)){if(d.capture&&d.captureConstraint){var g=d.capture,m=d.captureConstraint,y=new RegExp(g).exec(a);if(y&&y.length>0)if(parseInt(y[y.length-1])>=m)continue}for(var v=0,b=_;v<b.length;v++){switch(b[v]){case"uniformBuffer":this.disableUniformBuffers=!0;break;case"vao":this.disableVertexArrayObjects=!0}}}}}if(this._doNotHandleContextLost||(this._onContextLost=function(t){t.preventDefault(),o._contextWasLost=!0,f.Warn("WebGL context lost."),o.onContextLostObservable.notifyObservers(o)},this._onContextRestored=function(){setTimeout((function(){o._initGLContext(),o._rebuildEffects(),o._rebuildInternalTextures(),o._rebuildBuffers(),o.wipeCaches(!0),f.Warn("WebGL context successfully restored."),o.onContextRestoredObservable.notifyObservers(o),o._contextWasLost=!1}),0)},s.addEventListener("webglcontextlost",this._onContextLost,!1),s.addEventListener("webglcontextrestored",this._onContextRestored,!1),r.powerPreference="high-performance"),!r.disableWebGL2Support)try{this._gl=s.getContext("webgl2",r)||s.getContext("experimental-webgl2",r),this._gl&&(this._webGLVersion=2,this._gl.deleteQuery||(this._webGLVersion=1))}catch(t){}if(!this._gl){if(!s)throw new Error("The provided canvas is null or undefined.");try{this._gl=s.getContext("webgl",r)||s.getContext("experimental-webgl",r)}catch(t){throw new Error("WebGL not supported")}}if(!this._gl)throw new Error("WebGL not supported")}else{this._gl=e,this._renderingCanvas=this._gl.canvas,this._gl.renderbufferStorageMultisample&&(this._webGLVersion=2);var x=this._gl.getContextAttributes();x&&(r.stencil=x.stencil)}this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),void 0!==r.useHighPrecisionFloats&&(this._highPrecisionShadersAllowed=r.useHighPrecisionFloats);var A=c.IsWindowObjectExist()&&window.devicePixelRatio||1,E=r.limitDeviceRatio||A;this._hardwareScalingLevel=n?1/Math.min(E,A):1,this.resize(),this._isStencilEnable=!!r.stencil,this._initGLContext();for(var T=0;T<this._caps.maxVertexAttribs;T++)this._currentBufferPointers[T]=new Y;this.webGLVersion>1?this._shaderProcessor=new j:this._shaderProcessor=new K,this._badOS=/iPad/i.test(navigator.userAgent)||/iPhone/i.test(navigator.userAgent),this._badDesktopOS=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this._creationOptions=r,console.log("Babylon.js v"+t.Version+" - "+this.description)}}return Object.defineProperty(t,"NpmPackage",{get:function(){return"babylonjs@4.2.0"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"Version",{get:function(){return"4.2.0"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){var t="WebGL"+this.webGLVersion;return this._caps.parallelShaderCompile&&(t+=" - Parallel shader compilation"),t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ShadersRepository",{get:function(){return L.ShadersRepository},set:function(t){L.ShadersRepository=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"supportsUniformBuffers",{get:function(){return this.webGLVersion>1&&!this.disableUniformBuffers},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_shouldUseHighPrecisionShader",{get:function(){return!(!this._caps.highPrecisionShaderSupported||!this._highPrecisionShadersAllowed)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needPOTTextures",{get:function(){return this._webGLVersion<2||this.forcePOTTextures},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doNotHandleContextLost",{get:function(){return this._doNotHandleContextLost},set:function(t){this._doNotHandleContextLost=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_supportsHardwareTextureRescaling",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"framebufferDimensionsObject",{set:function(t){this._framebufferDimensionsObject=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentViewport",{get:function(){return this._cachedViewport},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"emptyTexture",{get:function(){return this._emptyTexture||(this._emptyTexture=this.createRawTexture(new Uint8Array(4),1,1,5,!1,!1,1)),this._emptyTexture},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"emptyTexture3D",{get:function(){return this._emptyTexture3D||(this._emptyTexture3D=this.createRawTexture3D(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture3D},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"emptyTexture2DArray",{get:function(){return this._emptyTexture2DArray||(this._emptyTexture2DArray=this.createRawTexture2DArray(new Uint8Array(4),1,1,1,5,!1,!1,1)),this._emptyTexture2DArray},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"emptyCubeTexture",{get:function(){if(!this._emptyCubeTexture){var t=new Uint8Array(4),e=[t,t,t,t,t,t];this._emptyCubeTexture=this.createRawCubeTexture(e,1,5,0,!1,!1,1)}return this._emptyCubeTexture},enumerable:!1,configurable:!0}),t.prototype._rebuildInternalTextures=function(){for(var t=0,e=this._internalTexturesCache.slice();t<e.length;t++){e[t]._rebuild()}},t.prototype._rebuildEffects=function(){for(var t in this._compiledEffects){this._compiledEffects[t]._prepareEffect()}L.ResetCache()},t.prototype.areAllEffectsReady=function(){for(var t in this._compiledEffects){if(!this._compiledEffects[t].isReady())return!1}return!0},t.prototype._rebuildBuffers=function(){for(var t=0,e=this._uniformBuffers;t<e.length;t++){e[t]._rebuild()}},t.prototype._initGLContext=function(){this._caps={maxTexturesImageUnits:this._gl.getParameter(this._gl.MAX_TEXTURE_IMAGE_UNITS),maxCombinedTexturesImageUnits:this._gl.getParameter(this._gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),maxVertexTextureImageUnits:this._gl.getParameter(this._gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS),maxTextureSize:this._gl.getParameter(this._gl.MAX_TEXTURE_SIZE),maxSamples:this._webGLVersion>1?this._gl.getParameter(this._gl.MAX_SAMPLES):1,maxCubemapTextureSize:this._gl.getParameter(this._gl.MAX_CUBE_MAP_TEXTURE_SIZE),maxRenderTextureSize:this._gl.getParameter(this._gl.MAX_RENDERBUFFER_SIZE),maxVertexAttribs:this._gl.getParameter(this._gl.MAX_VERTEX_ATTRIBS),maxVaryingVectors:this._gl.getParameter(this._gl.MAX_VARYING_VECTORS),maxFragmentUniformVectors:this._gl.getParameter(this._gl.MAX_FRAGMENT_UNIFORM_VECTORS),maxVertexUniformVectors:this._gl.getParameter(this._gl.MAX_VERTEX_UNIFORM_VECTORS),parallelShaderCompile:this._gl.getExtension("KHR_parallel_shader_compile"),standardDerivatives:this._webGLVersion>1||null!==this._gl.getExtension("OES_standard_derivatives"),maxAnisotropy:1,astc:this._gl.getExtension("WEBGL_compressed_texture_astc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_astc"),bptc:this._gl.getExtension("EXT_texture_compression_bptc")||this._gl.getExtension("WEBKIT_EXT_texture_compression_bptc"),s3tc:this._gl.getExtension("WEBGL_compressed_texture_s3tc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"),pvrtc:this._gl.getExtension("WEBGL_compressed_texture_pvrtc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),etc1:this._gl.getExtension("WEBGL_compressed_texture_etc1")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"),etc2:this._gl.getExtension("WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBKIT_WEBGL_compressed_texture_etc")||this._gl.getExtension("WEBGL_compressed_texture_es3_0"),textureAnisotropicFilterExtension:this._gl.getExtension("EXT_texture_filter_anisotropic")||this._gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||this._gl.getExtension("MOZ_EXT_texture_filter_anisotropic"),uintIndices:this._webGLVersion>1||null!==this._gl.getExtension("OES_element_index_uint"),fragmentDepthSupported:this._webGLVersion>1||null!==this._gl.getExtension("EXT_frag_depth"),highPrecisionShaderSupported:!1,timerQuery:this._gl.getExtension("EXT_disjoint_timer_query_webgl2")||this._gl.getExtension("EXT_disjoint_timer_query"),canUseTimestampForTimerQuery:!1,drawBuffersExtension:!1,maxMSAASamples:1,colorBufferFloat:this._webGLVersion>1&&this._gl.getExtension("EXT_color_buffer_float"),textureFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_float")),textureHalfFloat:!!(this._webGLVersion>1||this._gl.getExtension("OES_texture_half_float")),textureHalfFloatRender:!1,textureFloatLinearFiltering:!1,textureFloatRender:!1,textureHalfFloatLinearFiltering:!1,vertexArrayObject:!1,instancedArrays:!1,textureLOD:!!(this._webGLVersion>1||this._gl.getExtension("EXT_shader_texture_lod")),blendMinMax:!1,multiview:this._gl.getExtension("OVR_multiview2"),oculusMultiview:this._gl.getExtension("OCULUS_multiview"),depthTextureExtension:!1},this._glVersion=this._gl.getParameter(this._gl.VERSION);var t=this._gl.getExtension("WEBGL_debug_renderer_info");if(null!=t&&(this._glRenderer=this._gl.getParameter(t.UNMASKED_RENDERER_WEBGL),this._glVendor=this._gl.getParameter(t.UNMASKED_VENDOR_WEBGL)),this._glVendor||(this._glVendor="Unknown vendor"),this._glRenderer||(this._glRenderer="Unknown renderer"),36193!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=36193),34842!==this._gl.RGBA16F&&(this._gl.RGBA16F=34842),34836!==this._gl.RGBA32F&&(this._gl.RGBA32F=34836),35056!==this._gl.DEPTH24_STENCIL8&&(this._gl.DEPTH24_STENCIL8=35056),this._caps.timerQuery&&(1===this._webGLVersion&&(this._gl.getQuery=this._caps.timerQuery.getQueryEXT.bind(this._caps.timerQuery)),this._caps.canUseTimestampForTimerQuery=this._gl.getQuery(this._caps.timerQuery.TIMESTAMP_EXT,this._caps.timerQuery.QUERY_COUNTER_BITS_EXT)>0),this._caps.maxAnisotropy=this._caps.textureAnisotropicFilterExtension?this._gl.getParameter(this._caps.textureAnisotropicFilterExtension.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,this._caps.textureFloatLinearFiltering=!(!this._caps.textureFloat||!this._gl.getExtension("OES_texture_float_linear")),this._caps.textureFloatRender=!(!this._caps.textureFloat||!this._canRenderToFloatFramebuffer()),this._caps.textureHalfFloatLinearFiltering=!!(this._webGLVersion>1||this._caps.textureHalfFloat&&this._gl.getExtension("OES_texture_half_float_linear")),this._webGLVersion>1&&5131!==this._gl.HALF_FLOAT_OES&&(this._gl.HALF_FLOAT_OES=5131),this._caps.textureHalfFloatRender=this._caps.textureHalfFloat&&this._canRenderToHalfFloatFramebuffer(),this._webGLVersion>1)this._caps.drawBuffersExtension=!0,this._caps.maxMSAASamples=this._gl.getParameter(this._gl.MAX_SAMPLES);else{var e=this._gl.getExtension("WEBGL_draw_buffers");if(null!==e){this._caps.drawBuffersExtension=!0,this._gl.drawBuffers=e.drawBuffersWEBGL.bind(e),this._gl.DRAW_FRAMEBUFFER=this._gl.FRAMEBUFFER;for(var i=0;i<16;i++)this._gl["COLOR_ATTACHMENT"+i+"_WEBGL"]=e["COLOR_ATTACHMENT"+i+"_WEBGL"]}}if(this._webGLVersion>1)this._caps.depthTextureExtension=!0;else{var r=this._gl.getExtension("WEBGL_depth_texture");null!=r&&(this._caps.depthTextureExtension=!0,this._gl.UNSIGNED_INT_24_8=r.UNSIGNED_INT_24_8_WEBGL)}if(this.disableVertexArrayObjects)this._caps.vertexArrayObject=!1;else if(this._webGLVersion>1)this._caps.vertexArrayObject=!0;else{var n=this._gl.getExtension("OES_vertex_array_object");null!=n&&(this._caps.vertexArrayObject=!0,this._gl.createVertexArray=n.createVertexArrayOES.bind(n),this._gl.bindVertexArray=n.bindVertexArrayOES.bind(n),this._gl.deleteVertexArray=n.deleteVertexArrayOES.bind(n))}if(this._webGLVersion>1)this._caps.instancedArrays=!0;else{var o=this._gl.getExtension("ANGLE_instanced_arrays");null!=o?(this._caps.instancedArrays=!0,this._gl.drawArraysInstanced=o.drawArraysInstancedANGLE.bind(o),this._gl.drawElementsInstanced=o.drawElementsInstancedANGLE.bind(o),this._gl.vertexAttribDivisor=o.vertexAttribDivisorANGLE.bind(o)):this._caps.instancedArrays=!1}if(this._gl.getShaderPrecisionFormat){var s=this._gl.getShaderPrecisionFormat(this._gl.VERTEX_SHADER,this._gl.HIGH_FLOAT),a=this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER,this._gl.HIGH_FLOAT);s&&a&&(this._caps.highPrecisionShaderSupported=0!==s.precision&&0!==a.precision)}if(this._webGLVersion>1)this._caps.blendMinMax=!0;else{var u=this._gl.getExtension("EXT_blend_minmax");null!=u&&(this._caps.blendMinMax=!0,this._gl.MAX=u.MAX_EXT,this._gl.MIN=u.MIN_EXT)}this._depthCullingState.depthTest=!0,this._depthCullingState.depthFunc=this._gl.LEQUAL,this._depthCullingState.depthMask=!0,this._maxSimultaneousTextures=this._caps.maxCombinedTexturesImageUnits;for(var h=0;h<this._maxSimultaneousTextures;h++)this._nextFreeTextureSlots.push(h)},Object.defineProperty(t.prototype,"webGLVersion",{get:function(){return this._webGLVersion},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return"ThinEngine"},Object.defineProperty(t.prototype,"isStencilEnable",{get:function(){return this._isStencilEnable},enumerable:!1,configurable:!0}),t.prototype._prepareWorkingCanvas=function(){if(!this._workingCanvas){this._workingCanvas=H.CreateCanvas(1,1);var t=this._workingCanvas.getContext("2d");t&&(this._workingContext=t)}},t.prototype.resetTextureCache=function(){for(var t in this._boundTexturesCache)this._boundTexturesCache.hasOwnProperty(t)&&(this._boundTexturesCache[t]=null);this._currentTextureChannel=-1},t.prototype.getGlInfo=function(){return{vendor:this._glVendor,renderer:this._glRenderer,version:this._glVersion}},t.prototype.setHardwareScalingLevel=function(t){this._hardwareScalingLevel=t,this.resize()},t.prototype.getHardwareScalingLevel=function(){return this._hardwareScalingLevel},t.prototype.getLoadedTexturesCache=function(){return this._internalTexturesCache},t.prototype.getCaps=function(){return this._caps},t.prototype.stopRenderLoop=function(t){if(t){var e=this._activeRenderLoops.indexOf(t);e>=0&&this._activeRenderLoops.splice(e,1)}else this._activeRenderLoops=[]},t.prototype._renderLoop=function(){if(!this._contextWasLost){var t=!0;if(!this.renderEvenInBackground&&this._windowIsBackground&&(t=!1),t){this.beginFrame();for(var e=0;e<this._activeRenderLoops.length;e++){(0,this._activeRenderLoops[e])()}this.endFrame()}}this._activeRenderLoops.length>0?this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1},t.prototype.getRenderingCanvas=function(){return this._renderingCanvas},t.prototype.getHostWindow=function(){return c.IsWindowObjectExist()?this._renderingCanvas&&this._renderingCanvas.ownerDocument&&this._renderingCanvas.ownerDocument.defaultView?this._renderingCanvas.ownerDocument.defaultView:window:null},t.prototype.getRenderWidth=function(t){return void 0===t&&(t=!1),!t&&this._currentRenderTarget?this._currentRenderTarget.width:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferWidth:this._gl.drawingBufferWidth},t.prototype.getRenderHeight=function(t){return void 0===t&&(t=!1),!t&&this._currentRenderTarget?this._currentRenderTarget.height:this._framebufferDimensionsObject?this._framebufferDimensionsObject.framebufferHeight:this._gl.drawingBufferHeight},t.prototype._queueNewFrame=function(e,i){return t.QueueNewFrame(e,i)},t.prototype.runRenderLoop=function(t){-1===this._activeRenderLoops.indexOf(t)&&(this._activeRenderLoops.push(t),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._boundRenderFunction=this._renderLoop.bind(this),this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow())))},t.prototype.clear=function(t,e,i,r){void 0===r&&(r=!1),this.applyStates();var n=0;e&&t&&(this._gl.clearColor(t.r,t.g,t.b,void 0!==t.a?t.a:1),n|=this._gl.COLOR_BUFFER_BIT),i&&(this.useReverseDepthBuffer?(this._depthCullingState.depthFunc=this._gl.GREATER,this._gl.clearDepth(0)):this._gl.clearDepth(1),n|=this._gl.DEPTH_BUFFER_BIT),r&&(this._gl.clearStencil(0),n|=this._gl.STENCIL_BUFFER_BIT),this._gl.clear(n)},t.prototype._viewport=function(t,e,i,r){t===this._viewportCached.x&&e===this._viewportCached.y&&i===this._viewportCached.z&&r===this._viewportCached.w||(this._viewportCached.x=t,this._viewportCached.y=e,this._viewportCached.z=i,this._viewportCached.w=r,this._gl.viewport(t,e,i,r))},t.prototype.setViewport=function(t,e,i){var r=e||this.getRenderWidth(),n=i||this.getRenderHeight(),o=t.x||0,s=t.y||0;this._cachedViewport=t,this._viewport(o*r,s*n,r*t.width,n*t.height)},t.prototype.beginFrame=function(){},t.prototype.endFrame=function(){this._badOS&&this.flushFramebuffer()},t.prototype.resize=function(){var t,e;c.IsWindowObjectExist()?(t=this._renderingCanvas?this._renderingCanvas.clientWidth||this._renderingCanvas.width:window.innerWidth,e=this._renderingCanvas?this._renderingCanvas.clientHeight||this._renderingCanvas.height:window.innerHeight):(t=this._renderingCanvas?this._renderingCanvas.width:100,e=this._renderingCanvas?this._renderingCanvas.height:100),this.setSize(t/this._hardwareScalingLevel,e/this._hardwareScalingLevel)},t.prototype.setSize=function(t,e){return!!this._renderingCanvas&&(t|=0,e|=0,(this._renderingCanvas.width!==t||this._renderingCanvas.height!==e)&&(this._renderingCanvas.width=t,this._renderingCanvas.height=e,!0))},t.prototype.bindFramebuffer=function(t,e,i,r,n,o,s){void 0===e&&(e=0),void 0===o&&(o=0),void 0===s&&(s=0),this._currentRenderTarget&&this.unBindFramebuffer(this._currentRenderTarget),this._currentRenderTarget=t,this._bindUnboundFramebuffer(t._MSAAFramebuffer?t._MSAAFramebuffer:t._framebuffer);var a=this._gl;t.is2DArray?a.framebufferTextureLayer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,t._webGLTexture,o,s):t.isCube&&a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+e,t._webGLTexture,o);var u=t._depthStencilTexture;if(u){var h=u._generateStencilBuffer?a.DEPTH_STENCIL_ATTACHMENT:a.DEPTH_ATTACHMENT;t.is2DArray?a.framebufferTextureLayer(a.FRAMEBUFFER,h,u._webGLTexture,o,s):t.isCube?a.framebufferTexture2D(a.FRAMEBUFFER,h,a.TEXTURE_CUBE_MAP_POSITIVE_X+e,u._webGLTexture,o):a.framebufferTexture2D(a.FRAMEBUFFER,h,a.TEXTURE_2D,u._webGLTexture,o)}this._cachedViewport&&!n?this.setViewport(this._cachedViewport,i,r):(i||(i=t.width,o&&(i/=Math.pow(2,o))),r||(r=t.height,o&&(r/=Math.pow(2,o))),this._viewport(0,0,i,r)),this.wipeCaches()},t.prototype._bindUnboundFramebuffer=function(t){this._currentFramebuffer!==t&&(this._gl.bindFramebuffer(this._gl.FRAMEBUFFER,t),this._currentFramebuffer=t)},t.prototype.unBindFramebuffer=function(t,e,i){void 0===e&&(e=!1),this._currentRenderTarget=null;var r=this._gl;if(t._MSAAFramebuffer){if(t._textureArray)return void this.unBindMultiColorAttachmentFramebuffer(t._textureArray,e,i);r.bindFramebuffer(r.READ_FRAMEBUFFER,t._MSAAFramebuffer),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,t._framebuffer),r.blitFramebuffer(0,0,t.width,t.height,0,0,t.width,t.height,r.COLOR_BUFFER_BIT,r.NEAREST)}!t.generateMipMaps||e||t.isCube||(this._bindTextureDirectly(r.TEXTURE_2D,t,!0),r.generateMipmap(r.TEXTURE_2D),this._bindTextureDirectly(r.TEXTURE_2D,null)),i&&(t._MSAAFramebuffer&&this._bindUnboundFramebuffer(t._framebuffer),i()),this._bindUnboundFramebuffer(null)},t.prototype.flushFramebuffer=function(){this._gl.flush()},t.prototype.restoreDefaultFramebuffer=function(){this._currentRenderTarget?this.unBindFramebuffer(this._currentRenderTarget):this._bindUnboundFramebuffer(null),this._cachedViewport&&this.setViewport(this._cachedViewport),this.wipeCaches()},t.prototype._resetVertexBufferBinding=function(){this.bindArrayBuffer(null),this._cachedVertexBuffers=null},t.prototype.createVertexBuffer=function(t){return this._createVertexBuffer(t,this._gl.STATIC_DRAW)},t.prototype._createVertexBuffer=function(t,e){var i=this._gl.createBuffer();if(!i)throw new Error("Unable to create vertex buffer");var r=new G(i);return this.bindArrayBuffer(r),t instanceof Array?this._gl.bufferData(this._gl.ARRAY_BUFFER,new Float32Array(t),this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.ARRAY_BUFFER,t,this._gl.STATIC_DRAW),this._resetVertexBufferBinding(),r.references=1,r},t.prototype.createDynamicVertexBuffer=function(t){return this._createVertexBuffer(t,this._gl.DYNAMIC_DRAW)},t.prototype._resetIndexBufferBinding=function(){this.bindIndexBuffer(null),this._cachedIndexBuffer=null},t.prototype.createIndexBuffer=function(t,e){var i=this._gl.createBuffer(),r=new G(i);if(!i)throw new Error("Unable to create index buffer");this.bindIndexBuffer(r);var n=this._normalizeIndexData(t);return this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,n,e?this._gl.DYNAMIC_DRAW:this._gl.STATIC_DRAW),this._resetIndexBufferBinding(),r.references=1,r.is32Bits=4===n.BYTES_PER_ELEMENT,r},t.prototype._normalizeIndexData=function(t){if(t instanceof Uint16Array)return t;if(this._caps.uintIndices){if(t instanceof Uint32Array)return t;for(var e=0;e<t.length;e++)if(t[e]>=65535)return new Uint32Array(t);return new Uint16Array(t)}return new Uint16Array(t)},t.prototype.bindArrayBuffer=function(t){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.bindBuffer(t,this._gl.ARRAY_BUFFER)},t.prototype.bindUniformBlock=function(t,e,i){var r=t.program,n=this._gl.getUniformBlockIndex(r,e);this._gl.uniformBlockBinding(r,n,i)},t.prototype.bindIndexBuffer=function(t){this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.bindBuffer(t,this._gl.ELEMENT_ARRAY_BUFFER)},t.prototype.bindBuffer=function(t,e){(this._vaoRecordInProgress||this._currentBoundBuffer[e]!==t)&&(this._gl.bindBuffer(e,t?t.underlyingResource:null),this._currentBoundBuffer[e]=t)},t.prototype.updateArrayBuffer=function(t){this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,t)},t.prototype._vertexAttribPointer=function(t,e,i,r,n,o,s){var a=this._currentBufferPointers[e];if(a){var u=!1;a.active?(a.buffer!==t&&(a.buffer=t,u=!0),a.size!==i&&(a.size=i,u=!0),a.type!==r&&(a.type=r,u=!0),a.normalized!==n&&(a.normalized=n,u=!0),a.stride!==o&&(a.stride=o,u=!0),a.offset!==s&&(a.offset=s,u=!0)):(u=!0,a.active=!0,a.index=e,a.size=i,a.type=r,a.normalized=n,a.stride=o,a.offset=s,a.buffer=t),(u||this._vaoRecordInProgress)&&(this.bindArrayBuffer(t),this._gl.vertexAttribPointer(e,i,r,n,o,s))}},t.prototype._bindIndexBufferWithCache=function(t){null!=t&&this._cachedIndexBuffer!==t&&(this._cachedIndexBuffer=t,this.bindIndexBuffer(t),this._uintIndicesCurrentlySet=t.is32Bits)},t.prototype._bindVertexBuffersAttributes=function(t,e){var i=e.getAttributesNames();this._vaoRecordInProgress||this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var r=0;r<i.length;r++){var n=e.getAttributeLocation(r);if(n>=0){var o=t[i[r]];if(!o)continue;this._gl.enableVertexAttribArray(n),this._vaoRecordInProgress||(this._vertexAttribArraysEnabled[n]=!0);var s=o.getBuffer();s&&(this._vertexAttribPointer(s,n,o.getSize(),o.type,o.normalized,o.byteStride,o.byteOffset),o.getIsInstanced()&&(this._gl.vertexAttribDivisor(n,o.getInstanceDivisor()),this._vaoRecordInProgress||(this._currentInstanceLocations.push(n),this._currentInstanceBuffers.push(s))))}}},t.prototype.recordVertexArrayObject=function(t,e,i){var r=this._gl.createVertexArray();return this._vaoRecordInProgress=!0,this._gl.bindVertexArray(r),this._mustWipeVertexAttributes=!0,this._bindVertexBuffersAttributes(t,i),this.bindIndexBuffer(e),this._vaoRecordInProgress=!1,this._gl.bindVertexArray(null),r},t.prototype.bindVertexArrayObject=function(t,e){this._cachedVertexArrayObject!==t&&(this._cachedVertexArrayObject=t,this._gl.bindVertexArray(t),this._cachedVertexBuffers=null,this._cachedIndexBuffer=null,this._uintIndicesCurrentlySet=null!=e&&e.is32Bits,this._mustWipeVertexAttributes=!0)},t.prototype.bindBuffersDirectly=function(t,e,i,r,n){if(this._cachedVertexBuffers!==t||this._cachedEffectForVertexBuffers!==n){this._cachedVertexBuffers=t,this._cachedEffectForVertexBuffers=n;var o=n.getAttributesCount();this._unbindVertexArrayObject(),this.unbindAllAttributes();for(var s=0,a=0;a<o;a++)if(a<i.length){var u=n.getAttributeLocation(a);u>=0&&(this._gl.enableVertexAttribArray(u),this._vertexAttribArraysEnabled[u]=!0,this._vertexAttribPointer(t,u,i[a],this._gl.FLOAT,!1,r,s)),s+=4*i[a]}}this._bindIndexBufferWithCache(e)},t.prototype._unbindVertexArrayObject=function(){this._cachedVertexArrayObject&&(this._cachedVertexArrayObject=null,this._gl.bindVertexArray(null))},t.prototype.bindBuffers=function(t,e,i){this._cachedVertexBuffers===t&&this._cachedEffectForVertexBuffers===i||(this._cachedVertexBuffers=t,this._cachedEffectForVertexBuffers=i,this._bindVertexBuffersAttributes(t,i)),this._bindIndexBufferWithCache(e)},t.prototype.unbindInstanceAttributes=function(){for(var t,e=0,i=this._currentInstanceLocations.length;e<i;e++){var r=this._currentInstanceBuffers[e];t!=r&&r.references&&(t=r,this.bindArrayBuffer(r));var n=this._currentInstanceLocations[e];this._gl.vertexAttribDivisor(n,0)}this._currentInstanceBuffers.length=0,this._currentInstanceLocations.length=0},t.prototype.releaseVertexArrayObject=function(t){this._gl.deleteVertexArray(t)},t.prototype._releaseBuffer=function(t){return t.references--,0===t.references&&(this._deleteBuffer(t),!0)},t.prototype._deleteBuffer=function(t){this._gl.deleteBuffer(t.underlyingResource)},t.prototype.updateAndBindInstancesBuffer=function(t,e,i){if(this.bindArrayBuffer(t),e&&this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e),void 0!==i[0].index)this.bindInstancesBuffer(t,i,!0);else for(var r=0;r<4;r++){var n=i[r];this._vertexAttribArraysEnabled[n]||(this._gl.enableVertexAttribArray(n),this._vertexAttribArraysEnabled[n]=!0),this._vertexAttribPointer(t,n,4,this._gl.FLOAT,!1,64,16*r),this._gl.vertexAttribDivisor(n,1),this._currentInstanceLocations.push(n),this._currentInstanceBuffers.push(t)}},t.prototype.bindInstancesBuffer=function(t,e,i){void 0===i&&(i=!0),this.bindArrayBuffer(t);var r=0;if(i)for(var n=0;n<e.length;n++){r+=4*(o=e[n]).attributeSize}for(n=0;n<e.length;n++){var o;void 0===(o=e[n]).index&&(o.index=this._currentEffect.getAttributeLocationByName(o.attributeName)),o.index<0||(this._vertexAttribArraysEnabled[o.index]||(this._gl.enableVertexAttribArray(o.index),this._vertexAttribArraysEnabled[o.index]=!0),this._vertexAttribPointer(t,o.index,o.attributeSize,o.attributeType||this._gl.FLOAT,o.normalized||!1,r,o.offset),this._gl.vertexAttribDivisor(o.index,void 0===o.divisor?1:o.divisor),this._currentInstanceLocations.push(o.index),this._currentInstanceBuffers.push(t))}},t.prototype.disableInstanceAttributeByName=function(t){if(this._currentEffect){var e=this._currentEffect.getAttributeLocationByName(t);this.disableInstanceAttribute(e)}},t.prototype.disableInstanceAttribute=function(t){for(var e,i=!1;-1!==(e=this._currentInstanceLocations.indexOf(t));)this._currentInstanceLocations.splice(e,1),this._currentInstanceBuffers.splice(e,1),i=!0,e=this._currentInstanceLocations.indexOf(t);i&&(this._gl.vertexAttribDivisor(t,0),this.disableAttributeByIndex(t))},t.prototype.disableAttributeByIndex=function(t){this._gl.disableVertexAttribArray(t),this._vertexAttribArraysEnabled[t]=!1,this._currentBufferPointers[t].active=!1},t.prototype.draw=function(t,e,i,r){this.drawElementsType(t?0:1,e,i,r)},t.prototype.drawPointClouds=function(t,e,i){this.drawArraysType(2,t,e,i)},t.prototype.drawUnIndexed=function(t,e,i,r){this.drawArraysType(t?0:1,e,i,r)},t.prototype.drawElementsType=function(t,e,i,r){this.applyStates(),this._reportDrawCall();var n=this._drawMode(t),o=this._uintIndicesCurrentlySet?this._gl.UNSIGNED_INT:this._gl.UNSIGNED_SHORT,s=this._uintIndicesCurrentlySet?4:2;r?this._gl.drawElementsInstanced(n,i,o,e*s,r):this._gl.drawElements(n,i,o,e*s)},t.prototype.drawArraysType=function(t,e,i,r){this.applyStates(),this._reportDrawCall();var n=this._drawMode(t);r?this._gl.drawArraysInstanced(n,e,i,r):this._gl.drawArrays(n,e,i)},t.prototype._drawMode=function(t){switch(t){case 0:return this._gl.TRIANGLES;case 2:return this._gl.POINTS;case 1:return this._gl.LINES;case 3:return this._gl.POINTS;case 4:return this._gl.LINES;case 5:return this._gl.LINE_LOOP;case 6:return this._gl.LINE_STRIP;case 7:return this._gl.TRIANGLE_STRIP;case 8:return this._gl.TRIANGLE_FAN;default:return this._gl.TRIANGLES}},t.prototype._reportDrawCall=function(){},t.prototype._releaseEffect=function(t){this._compiledEffects[t._key]&&(delete this._compiledEffects[t._key],this._deletePipelineContext(t.getPipelineContext()))},t.prototype._deletePipelineContext=function(t){var e=t;e&&e.program&&(e.program.__SPECTOR_rebuildProgram=null,this._gl.deleteProgram(e.program))},t.prototype.createEffect=function(t,e,i,r,n,o,s,a,u){var h=(t.vertexElement||t.vertex||t.vertexToken||t.vertexSource||t)+"+"+(t.fragmentElement||t.fragment||t.fragmentToken||t.fragmentSource||t)+"@"+(n||e.defines);if(this._compiledEffects[h]){var l=this._compiledEffects[h];return s&&l.isReady()&&s(l),l}var c=new L(t,e,i,r,this,n,o,s,a,u);return c._key=h,this._compiledEffects[h]=c,c},t._ConcatenateShader=function(t,e,i){return void 0===i&&(i=""),i+(e?e+"\n":"")+t},t.prototype._compileShader=function(e,i,r,n){return this._compileRawShader(t._ConcatenateShader(e,r,n),i)},t.prototype._compileRawShader=function(t,e){var i=this._gl,r=i.createShader("vertex"===e?i.VERTEX_SHADER:i.FRAGMENT_SHADER);if(!r)throw new Error("Something went wrong while compile the shader.");return i.shaderSource(r,t),i.compileShader(r),r},t.prototype._getShaderSource=function(t){return this._gl.getShaderSource(t)},t.prototype.createRawShaderProgram=function(t,e,i,r,n){void 0===n&&(n=null),r=r||this._gl;var o=this._compileRawShader(e,"vertex"),s=this._compileRawShader(i,"fragment");return this._createShaderProgram(t,o,s,r,n)},t.prototype.createShaderProgram=function(t,e,i,r,n,o){void 0===o&&(o=null),n=n||this._gl;var s=this._webGLVersion>1?"#version 300 es\n#define WEBGL2 \n":"",a=this._compileShader(e,"vertex",r,s),u=this._compileShader(i,"fragment",r,s);return this._createShaderProgram(t,a,u,n,o)},t.prototype.createPipelineContext=function(){var t=new X;return t.engine=this,this._caps.parallelShaderCompile&&(t.isParallelCompiled=!0),t},t.prototype._createShaderProgram=function(t,e,i,r,n){void 0===n&&(n=null);var o=r.createProgram();if(t.program=o,!o)throw new Error("Unable to create program");return r.attachShader(o,e),r.attachShader(o,i),r.linkProgram(o),t.context=r,t.vertexShader=e,t.fragmentShader=i,t.isParallelCompiled||this._finalizePipelineContext(t),o},t.prototype._finalizePipelineContext=function(t){var e=t.context,i=t.vertexShader,r=t.fragmentShader,n=t.program;if(!e.getProgramParameter(n,e.LINK_STATUS)){var o,s;if(!this._gl.getShaderParameter(i,this._gl.COMPILE_STATUS))if(o=this._gl.getShaderInfoLog(i))throw t.vertexCompilationError=o,new Error("VERTEX SHADER "+o);if(!this._gl.getShaderParameter(r,this._gl.COMPILE_STATUS))if(o=this._gl.getShaderInfoLog(r))throw t.fragmentCompilationError=o,new Error("FRAGMENT SHADER "+o);if(s=e.getProgramInfoLog(n))throw t.programLinkError=s,new Error(s)}if(this.validateShaderPrograms&&(e.validateProgram(n),!e.getProgramParameter(n,e.VALIDATE_STATUS)&&(s=e.getProgramInfoLog(n))))throw t.programValidationError=s,new Error(s);e.deleteShader(i),e.deleteShader(r),t.vertexShader=void 0,t.fragmentShader=void 0,t.onCompiled&&(t.onCompiled(),t.onCompiled=void 0)},t.prototype._preparePipelineContext=function(t,e,i,r,n,o,s){var a=t;a.program=r?this.createRawShaderProgram(a,e,i,void 0,s):this.createShaderProgram(a,e,i,o,void 0,s),a.program.__SPECTOR_rebuildProgram=n},t.prototype._isRenderingStateCompiled=function(t){var e=t;return!!this._gl.getProgramParameter(e.program,this._caps.parallelShaderCompile.COMPLETION_STATUS_KHR)&&(this._finalizePipelineContext(e),!0)},t.prototype._executeWhenRenderingStateIsCompiled=function(t,e){var i=t;if(i.isParallelCompiled){var r=i.onCompiled;i.onCompiled=r?function(){r(),e()}:e}else e()},t.prototype.getUniforms=function(t,e){for(var i=new Array,r=t,n=0;n<e.length;n++)i.push(this._gl.getUniformLocation(r.program,e[n]));return i},t.prototype.getAttributes=function(t,e){for(var i=[],r=t,n=0;n<e.length;n++)try{i.push(this._gl.getAttribLocation(r.program,e[n]))}catch(t){i.push(-1)}return i},t.prototype.enableEffect=function(t){t&&t!==this._currentEffect&&(this.bindSamplers(t),this._currentEffect=t,t.onBind&&t.onBind(t),t._onBindObservable&&t._onBindObservable.notifyObservers(t))},t.prototype.setInt=function(t,e){return!!t&&(this._gl.uniform1i(t,e),!0)},t.prototype.setIntArray=function(t,e){return!!t&&(this._gl.uniform1iv(t,e),!0)},t.prototype.setIntArray2=function(t,e){return!(!t||e.length%2!=0)&&(this._gl.uniform2iv(t,e),!0)},t.prototype.setIntArray3=function(t,e){return!(!t||e.length%3!=0)&&(this._gl.uniform3iv(t,e),!0)},t.prototype.setIntArray4=function(t,e){return!(!t||e.length%4!=0)&&(this._gl.uniform4iv(t,e),!0)},t.prototype.setArray=function(t,e){return!!t&&(this._gl.uniform1fv(t,e),!0)},t.prototype.setArray2=function(t,e){return!(!t||e.length%2!=0)&&(this._gl.uniform2fv(t,e),!0)},t.prototype.setArray3=function(t,e){return!(!t||e.length%3!=0)&&(this._gl.uniform3fv(t,e),!0)},t.prototype.setArray4=function(t,e){return!(!t||e.length%4!=0)&&(this._gl.uniform4fv(t,e),!0)},t.prototype.setMatrices=function(t,e){return!!t&&(this._gl.uniformMatrix4fv(t,!1,e),!0)},t.prototype.setMatrix3x3=function(t,e){return!!t&&(this._gl.uniformMatrix3fv(t,!1,e),!0)},t.prototype.setMatrix2x2=function(t,e){return!!t&&(this._gl.uniformMatrix2fv(t,!1,e),!0)},t.prototype.setFloat=function(t,e){return!!t&&(this._gl.uniform1f(t,e),!0)},t.prototype.setFloat2=function(t,e,i){return!!t&&(this._gl.uniform2f(t,e,i),!0)},t.prototype.setFloat3=function(t,e,i,r){return!!t&&(this._gl.uniform3f(t,e,i,r),!0)},t.prototype.setFloat4=function(t,e,i,r,n){return!!t&&(this._gl.uniform4f(t,e,i,r,n),!0)},t.prototype.applyStates=function(){if(this._depthCullingState.apply(this._gl),this._stencilState.apply(this._gl),this._alphaState.apply(this._gl),this._colorWriteChanged){this._colorWriteChanged=!1;var t=this._colorWrite;this._gl.colorMask(t,t,t,t)}},t.prototype.setColorWrite=function(t){t!==this._colorWrite&&(this._colorWriteChanged=!0,this._colorWrite=t)},t.prototype.getColorWrite=function(){return this._colorWrite},Object.defineProperty(t.prototype,"depthCullingState",{get:function(){return this._depthCullingState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alphaState",{get:function(){return this._alphaState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stencilState",{get:function(){return this._stencilState},enumerable:!1,configurable:!0}),t.prototype.clearInternalTexturesCache=function(){this._internalTexturesCache=[]},t.prototype.wipeCaches=function(t){this.preventCacheWipeBetweenFrames&&!t||(this._currentEffect=null,this._viewportCached.x=0,this._viewportCached.y=0,this._viewportCached.z=0,this._viewportCached.w=0,this._unbindVertexArrayObject(),t&&(this._currentProgram=null,this.resetTextureCache(),this._stencilState.reset(),this._depthCullingState.reset(),this._depthCullingState.depthFunc=this._gl.LEQUAL,this._alphaState.reset(),this._alphaMode=1,this._alphaEquation=0,this._colorWrite=!0,this._colorWriteChanged=!0,this._unpackFlipYCached=null,this._gl.pixelStorei(this._gl.UNPACK_COLORSPACE_CONVERSION_WEBGL,this._gl.NONE),this._gl.pixelStorei(this._gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,0),this._mustWipeVertexAttributes=!0,this.unbindAllAttributes()),this._resetVertexBufferBinding(),this._cachedIndexBuffer=null,this._cachedEffectForVertexBuffers=null,this.bindIndexBuffer(null))},t.prototype._getSamplingParameters=function(t,e){var i=this._gl,r=i.NEAREST,n=i.NEAREST;switch(t){case 11:r=i.LINEAR,n=e?i.LINEAR_MIPMAP_NEAREST:i.LINEAR;break;case 3:r=i.LINEAR,n=e?i.LINEAR_MIPMAP_LINEAR:i.LINEAR;break;case 8:r=i.NEAREST,n=e?i.NEAREST_MIPMAP_LINEAR:i.NEAREST;break;case 4:r=i.NEAREST,n=e?i.NEAREST_MIPMAP_NEAREST:i.NEAREST;break;case 5:r=i.NEAREST,n=e?i.LINEAR_MIPMAP_NEAREST:i.LINEAR;break;case 6:r=i.NEAREST,n=e?i.LINEAR_MIPMAP_LINEAR:i.LINEAR;break;case 7:r=i.NEAREST,n=i.LINEAR;break;case 1:r=i.NEAREST,n=i.NEAREST;break;case 9:r=i.LINEAR,n=e?i.NEAREST_MIPMAP_NEAREST:i.NEAREST;break;case 10:r=i.LINEAR,n=e?i.NEAREST_MIPMAP_LINEAR:i.NEAREST;break;case 2:r=i.LINEAR,n=i.LINEAR;break;case 12:r=i.LINEAR,n=i.NEAREST}return{min:n,mag:r}},t.prototype._createTexture=function(){var t=this._gl.createTexture();if(!t)throw new Error("Unable to create texture");return t},t.prototype.createTexture=function(e,i,r,n,o,s,a,u,h,l,c,d,p){var _=this;void 0===o&&(o=3),void 0===s&&(s=null),void 0===a&&(a=null),void 0===u&&(u=null),void 0===h&&(h=null),void 0===l&&(l=null),void 0===c&&(c=null);var g="data:"===(e=e||"").substr(0,5),m="blob:"===e.substr(0,5),v=g&&-1!==e.indexOf(";base64,"),x=h||new W(this,y.Url),A=e;!this._transformTextureUrl||v||h||u||(e=this._transformTextureUrl(e)),A!==e&&(x._originalUrl=A);var E=e.lastIndexOf("."),T=c||(E>-1?e.substring(E).toLowerCase():""),M=null;T.indexOf("?")>-1&&(T=T.split("?")[0]);for(var R=0,I=t._TextureLoaders;R<I.length;R++){var F=I[R];if(F.canLoad(T,d)){M=F;break}}n&&n._addPendingData(x),x.url=e,x.generateMipMaps=!i,x.samplingMode=o,x.invertY=r,this._doNotHandleContextLost||(x._buffer=u);var S=null;s&&!h&&(S=x.onLoadedObservable.add(s)),h||this._internalTexturesCache.push(x);var D=function(t,r){n&&n._removePendingData(x),e===A?(S&&x.onLoadedObservable.remove(S),b.UseFallbackTexture&&_.createTexture(b.FallbackTexture,i,x.invertY,n,o,null,a,u,x),a&&a((t||"Unknown error")+(b.UseFallbackTexture?" - Fallback texture was used":""),r)):(f.Warn("Failed to load "+e+", falling back to "+A),_.createTexture(A,i,x.invertY,n,o,s,a,u,x,l,c,d,p))};if(M){var P=function(t){M.loadData(t,x,(function(t,e,i,r,s,a){a?D("TextureLoader failed to load data"):_._prepareWebGLTexture(x,n,t,e,x.invertY,!i,r,(function(){return s(),!1}),o)}),p)};u?u instanceof ArrayBuffer?P(new Uint8Array(u)):ArrayBuffer.isView(u)?P(u):a&&a("Unable to load: only ArrayBuffer or ArrayBufferView is supported",null):this._loadFile(e,(function(t){return P(new Uint8Array(t))}),void 0,n?n.offlineProvider:void 0,!0,(function(t,e){D("Unable to load "+(t&&t.responseURL,e))}))}else{var C=function(t){m&&!_._doNotHandleContextLost&&(x._buffer=t),_._prepareWebGLTexture(x,n,t.width,t.height,x.invertY,i,!1,(function(e,i,r){var o=_._gl,s=t.width===e&&t.height===i,a=l?_._getInternalFormat(l):".jpg"===T?o.RGB:o.RGBA;if(s)return o.texImage2D(o.TEXTURE_2D,0,a,a,o.UNSIGNED_BYTE,t),!1;var u=_._caps.maxTextureSize;if(t.width>u||t.height>u||!_._supportsHardwareTextureRescaling)return _._prepareWorkingCanvas(),!(!_._workingCanvas||!_._workingContext)&&(_._workingCanvas.width=e,_._workingCanvas.height=i,_._workingContext.drawImage(t,0,0,t.width,t.height,0,0,e,i),o.texImage2D(o.TEXTURE_2D,0,a,a,o.UNSIGNED_BYTE,_._workingCanvas),x.width=e,x.height=i,!1);var h=new W(_,y.Temp);return _._bindTextureDirectly(o.TEXTURE_2D,h,!0),o.texImage2D(o.TEXTURE_2D,0,a,a,o.UNSIGNED_BYTE,t),_._rescaleTexture(h,x,n,a,(function(){_._releaseTexture(h),_._bindTextureDirectly(o.TEXTURE_2D,x,!0),r()})),!0}),o)};!g||v?u&&(u.decoding||u.close)?C(u):t._FileToolsLoadImage(e,C,D,n?n.offlineProvider:null,d):"string"==typeof u||u instanceof ArrayBuffer||ArrayBuffer.isView(u)||u instanceof Blob?t._FileToolsLoadImage(u,C,D,n?n.offlineProvider:null,d):u&&C(u)}return x},t._FileToolsLoadImage=function(t,e,i,r,n){throw m.WarnImport("FileTools")},t.prototype._rescaleTexture=function(t,e,i,r,n){},t.prototype.createRawTexture=function(t,e,i,r,n,o,s,a,u){throw void 0===a&&(a=null),void 0===u&&(u=0),m.WarnImport("Engine.RawTexture")},t.prototype.createRawCubeTexture=function(t,e,i,r,n,o,s,a){throw void 0===a&&(a=null),m.WarnImport("Engine.RawTexture")},t.prototype.createRawTexture3D=function(t,e,i,r,n,o,s,a,u,h){throw void 0===u&&(u=null),void 0===h&&(h=0),m.WarnImport("Engine.RawTexture")},t.prototype.createRawTexture2DArray=function(t,e,i,r,n,o,s,a,u,h){throw void 0===u&&(u=null),void 0===h&&(h=0),m.WarnImport("Engine.RawTexture")},t.prototype._unpackFlipY=function(t){this._unpackFlipYCached!==t&&(this._gl.pixelStorei(this._gl.UNPACK_FLIP_Y_WEBGL,t?1:0),this.enableUnpackFlipYCached&&(this._unpackFlipYCached=t))},t.prototype._getUnpackAlignement=function(){return this._gl.getParameter(this._gl.UNPACK_ALIGNMENT)},t.prototype._getTextureTarget=function(t){return t.isCube?this._gl.TEXTURE_CUBE_MAP:t.is3D?this._gl.TEXTURE_3D:t.is2DArray||t.isMultiview?this._gl.TEXTURE_2D_ARRAY:this._gl.TEXTURE_2D},t.prototype.updateTextureSamplingMode=function(t,e,i){void 0===i&&(i=!1);var r=this._getTextureTarget(e),n=this._getSamplingParameters(t,e.generateMipMaps||i);this._setTextureParameterInteger(r,this._gl.TEXTURE_MAG_FILTER,n.mag,e),this._setTextureParameterInteger(r,this._gl.TEXTURE_MIN_FILTER,n.min),i&&(e.generateMipMaps=!0,this._gl.generateMipmap(r)),this._bindTextureDirectly(r,null),e.samplingMode=t},t.prototype.updateTextureWrappingMode=function(t,e,i,r){void 0===i&&(i=null),void 0===r&&(r=null);var n=this._getTextureTarget(t);null!==e&&(this._setTextureParameterInteger(n,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(e),t),t._cachedWrapU=e),null!==i&&(this._setTextureParameterInteger(n,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(i),t),t._cachedWrapV=i),(t.is2DArray||t.is3D)&&null!==r&&(this._setTextureParameterInteger(n,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(r),t),t._cachedWrapR=r),this._bindTextureDirectly(n,null)},t.prototype._setupDepthStencilTexture=function(t,e,i,r,n){var o=e.width||e,s=e.height||e,a=e.layers||0;t.baseWidth=o,t.baseHeight=s,t.width=o,t.height=s,t.is2DArray=a>0,t.depth=a,t.isReady=!0,t.samples=1,t.generateMipMaps=!1,t._generateDepthBuffer=!0,t._generateStencilBuffer=i,t.samplingMode=r?2:1,t.type=0,t._comparisonFunction=n;var u=this._gl,h=this._getTextureTarget(t),l=this._getSamplingParameters(t.samplingMode,!1);u.texParameteri(h,u.TEXTURE_MAG_FILTER,l.mag),u.texParameteri(h,u.TEXTURE_MIN_FILTER,l.min),u.texParameteri(h,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(h,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),0===n?(u.texParameteri(h,u.TEXTURE_COMPARE_FUNC,515),u.texParameteri(h,u.TEXTURE_COMPARE_MODE,u.NONE)):(u.texParameteri(h,u.TEXTURE_COMPARE_FUNC,n),u.texParameteri(h,u.TEXTURE_COMPARE_MODE,u.COMPARE_REF_TO_TEXTURE))},t.prototype._uploadCompressedDataToTextureDirectly=function(t,e,i,r,n,o,s){void 0===o&&(o=0),void 0===s&&(s=0);var a=this._gl,u=a.TEXTURE_2D;t.isCube&&(u=a.TEXTURE_CUBE_MAP_POSITIVE_X+o),this._gl.compressedTexImage2D(u,s,e,i,r,0,n)},t.prototype._uploadDataToTextureDirectly=function(t,e,i,r,n,o){void 0===i&&(i=0),void 0===r&&(r=0),void 0===o&&(o=!1);var s=this._gl,a=this._getWebGLTextureType(t.type),u=this._getInternalFormat(t.format),h=void 0===n?this._getRGBABufferInternalSizedFormat(t.type,t.format):this._getInternalFormat(n);this._unpackFlipY(t.invertY);var l=s.TEXTURE_2D;t.isCube&&(l=s.TEXTURE_CUBE_MAP_POSITIVE_X+i);var c=Math.round(Math.log(t.width)*Math.LOG2E),f=Math.round(Math.log(t.height)*Math.LOG2E),d=o?t.width:Math.pow(2,Math.max(c-r,0)),p=o?t.height:Math.pow(2,Math.max(f-r,0));s.texImage2D(l,r,h,d,p,0,u,a,e)},t.prototype.updateTextureData=function(t,e,i,r,n,o,s,a){void 0===s&&(s=0),void 0===a&&(a=0);var u=this._gl,h=this._getWebGLTextureType(t.type),l=this._getInternalFormat(t.format);this._unpackFlipY(t.invertY);var c=u.TEXTURE_2D;t.isCube&&(c=u.TEXTURE_CUBE_MAP_POSITIVE_X+s),u.texSubImage2D(c,a,i,r,n,o,l,h,e)},t.prototype._uploadArrayBufferViewToTexture=function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=this._gl,o=t.isCube?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D;this._bindTextureDirectly(o,t,!0),this._uploadDataToTextureDirectly(t,e,i,r),this._bindTextureDirectly(o,null,!0)},t.prototype._prepareWebGLTextureContinuation=function(t,e,i,r,n){var o=this._gl;if(o){var s=this._getSamplingParameters(n,!i);o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,s.mag),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,s.min),i||r||o.generateMipmap(o.TEXTURE_2D),this._bindTextureDirectly(o.TEXTURE_2D,null),e&&e._removePendingData(t),t.onLoadedObservable.notifyObservers(t),t.onLoadedObservable.clear()}},t.prototype._prepareWebGLTexture=function(e,i,r,n,o,s,a,u,h){var l=this;void 0===h&&(h=3);var c=this.getCaps().maxTextureSize,f=Math.min(c,this.needPOTTextures?t.GetExponentOfTwo(r,c):r),d=Math.min(c,this.needPOTTextures?t.GetExponentOfTwo(n,c):n),p=this._gl;p&&(e._webGLTexture?(this._bindTextureDirectly(p.TEXTURE_2D,e,!0),this._unpackFlipY(void 0===o||!!o),e.baseWidth=r,e.baseHeight=n,e.width=f,e.height=d,e.isReady=!0,u(f,d,(function(){l._prepareWebGLTextureContinuation(e,i,s,a,h)}))||this._prepareWebGLTextureContinuation(e,i,s,a,h)):i&&i._removePendingData(e))},t.prototype._setupFramebufferDepthAttachments=function(t,e,i,r,n){void 0===n&&(n=1);var o=this._gl;if(t&&e)return this._getDepthStencilBuffer(i,r,n,o.DEPTH_STENCIL,o.DEPTH24_STENCIL8,o.DEPTH_STENCIL_ATTACHMENT);if(e){var s=o.DEPTH_COMPONENT16;return this._webGLVersion>1&&(s=o.DEPTH_COMPONENT32F),this._getDepthStencilBuffer(i,r,n,s,s,o.DEPTH_ATTACHMENT)}return t?this._getDepthStencilBuffer(i,r,n,o.STENCIL_INDEX8,o.STENCIL_INDEX8,o.STENCIL_ATTACHMENT):null},t.prototype._releaseFramebufferObjects=function(t){var e=this._gl;t._framebuffer&&(e.deleteFramebuffer(t._framebuffer),t._framebuffer=null),t._depthStencilBuffer&&(e.deleteRenderbuffer(t._depthStencilBuffer),t._depthStencilBuffer=null),t._MSAAFramebuffer&&(e.deleteFramebuffer(t._MSAAFramebuffer),t._MSAAFramebuffer=null),t._MSAARenderBuffer&&(e.deleteRenderbuffer(t._MSAARenderBuffer),t._MSAARenderBuffer=null)},t.prototype._releaseTexture=function(t){this._releaseFramebufferObjects(t),this._deleteTexture(t._webGLTexture),this.unbindAllTextures();var e=this._internalTexturesCache.indexOf(t);-1!==e&&this._internalTexturesCache.splice(e,1),t._lodTextureHigh&&t._lodTextureHigh.dispose(),t._lodTextureMid&&t._lodTextureMid.dispose(),t._lodTextureLow&&t._lodTextureLow.dispose(),t._irradianceTexture&&t._irradianceTexture.dispose()},t.prototype._deleteTexture=function(t){this._gl.deleteTexture(t)},t.prototype._setProgram=function(t){this._currentProgram!==t&&(this._gl.useProgram(t),this._currentProgram=t)},t.prototype.bindSamplers=function(t){var e=t.getPipelineContext();this._setProgram(e.program);for(var i=t.getSamplers(),r=0;r<i.length;r++){var n=t.getUniform(i[r]);n&&(this._boundUniforms[r]=n)}this._currentEffect=null},t.prototype._activateCurrentTexture=function(){this._currentTextureChannel!==this._activeChannel&&(this._gl.activeTexture(this._gl.TEXTURE0+this._activeChannel),this._currentTextureChannel=this._activeChannel)},t.prototype._bindTextureDirectly=function(t,e,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1);var n=!1,o=e&&e._associatedChannel>-1;return i&&o&&(this._activeChannel=e._associatedChannel),this._boundTexturesCache[this._activeChannel]!==e||r?(this._activateCurrentTexture(),e&&e.isMultiview?this._gl.bindTexture(t,e?e._colorTextureArray:null):this._gl.bindTexture(t,e?e._webGLTexture:null),this._boundTexturesCache[this._activeChannel]=e,e&&(e._associatedChannel=this._activeChannel)):i&&(n=!0,this._activateCurrentTexture()),o&&!i&&this._bindSamplerUniformToChannel(e._associatedChannel,this._activeChannel),n},t.prototype._bindTexture=function(t,e){if(void 0!==t){e&&(e._associatedChannel=t),this._activeChannel=t;var i=e?this._getTextureTarget(e):this._gl.TEXTURE_2D;this._bindTextureDirectly(i,e)}},t.prototype.unbindAllTextures=function(){for(var t=0;t<this._maxSimultaneousTextures;t++)this._activeChannel=t,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))},t.prototype.setTexture=function(t,e,i){void 0!==t&&(e&&(this._boundUniforms[t]=e),this._setTexture(t,i))},t.prototype._bindSamplerUniformToChannel=function(t,e){var i=this._boundUniforms[t];i&&i._currentState!==e&&(this._gl.uniform1i(i,e),i._currentState=e)},t.prototype._getTextureWrapMode=function(t){switch(t){case 1:return this._gl.REPEAT;case 0:return this._gl.CLAMP_TO_EDGE;case 2:return this._gl.MIRRORED_REPEAT}return this._gl.REPEAT},t.prototype._setTexture=function(t,e,i,r){if(void 0===i&&(i=!1),void 0===r&&(r=!1),!e)return null!=this._boundTexturesCache[t]&&(this._activeChannel=t,this._bindTextureDirectly(this._gl.TEXTURE_2D,null),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null),this.webGLVersion>1&&(this._bindTextureDirectly(this._gl.TEXTURE_3D,null),this._bindTextureDirectly(this._gl.TEXTURE_2D_ARRAY,null))),!1;if(e.video)this._activeChannel=t,e.update();else if(4===e.delayLoadState)return e.delayLoad(),!1;var n;n=r?e.depthStencilTexture:e.isReady()?e.getInternalTexture():e.isCube?this.emptyCubeTexture:e.is3D?this.emptyTexture3D:e.is2DArray?this.emptyTexture2DArray:this.emptyTexture,!i&&n&&(n._associatedChannel=t);var o=!0;this._boundTexturesCache[t]===n&&(i||this._bindSamplerUniformToChannel(n._associatedChannel,t),o=!1),this._activeChannel=t;var s=this._getTextureTarget(n);if(o&&this._bindTextureDirectly(s,n,i),n&&!n.isMultiview){if(n.isCube&&n._cachedCoordinatesMode!==e.coordinatesMode){n._cachedCoordinatesMode=e.coordinatesMode;var a=3!==e.coordinatesMode&&5!==e.coordinatesMode?1:0;e.wrapU=a,e.wrapV=a}n._cachedWrapU!==e.wrapU&&(n._cachedWrapU=e.wrapU,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_S,this._getTextureWrapMode(e.wrapU),n)),n._cachedWrapV!==e.wrapV&&(n._cachedWrapV=e.wrapV,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_T,this._getTextureWrapMode(e.wrapV),n)),n.is3D&&n._cachedWrapR!==e.wrapR&&(n._cachedWrapR=e.wrapR,this._setTextureParameterInteger(s,this._gl.TEXTURE_WRAP_R,this._getTextureWrapMode(e.wrapR),n)),this._setAnisotropicLevel(s,n,e.anisotropicFilteringLevel)}return!0},t.prototype.setTextureArray=function(t,e,i){if(void 0!==t&&e){this._textureUnits&&this._textureUnits.length===i.length||(this._textureUnits=new Int32Array(i.length));for(var r=0;r<i.length;r++){var n=i[r].getInternalTexture();n?(this._textureUnits[r]=t+r,n._associatedChannel=t+r):this._textureUnits[r]=-1}this._gl.uniform1iv(e,this._textureUnits);for(var o=0;o<i.length;o++)this._setTexture(this._textureUnits[o],i[o],!0)}},t.prototype._setAnisotropicLevel=function(t,e,i){var r=this._caps.textureAnisotropicFilterExtension;11!==e.samplingMode&&3!==e.samplingMode&&2!==e.samplingMode&&(i=1),r&&e._cachedAnisotropicFilteringLevel!==i&&(this._setTextureParameterFloat(t,r.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i,this._caps.maxAnisotropy),e),e._cachedAnisotropicFilteringLevel=i)},t.prototype._setTextureParameterFloat=function(t,e,i,r){this._bindTextureDirectly(t,r,!0,!0),this._gl.texParameterf(t,e,i)},t.prototype._setTextureParameterInteger=function(t,e,i,r){r&&this._bindTextureDirectly(t,r,!0,!0),this._gl.texParameteri(t,e,i)},t.prototype.unbindAllAttributes=function(){if(this._mustWipeVertexAttributes){this._mustWipeVertexAttributes=!1;for(var t=0;t<this._caps.maxVertexAttribs;t++)this.disableAttributeByIndex(t)}else{t=0;for(var e=this._vertexAttribArraysEnabled.length;t<e;t++)t>=this._caps.maxVertexAttribs||!this._vertexAttribArraysEnabled[t]||this.disableAttributeByIndex(t)}},t.prototype.releaseEffects=function(){for(var t in this._compiledEffects){var e=this._compiledEffects[t].getPipelineContext();this._deletePipelineContext(e)}this._compiledEffects={}},t.prototype.dispose=function(){this.stopRenderLoop(),this.onBeforeTextureInitObservable&&this.onBeforeTextureInitObservable.clear(),this._emptyTexture&&(this._releaseTexture(this._emptyTexture),this._emptyTexture=null),this._emptyCubeTexture&&(this._releaseTexture(this._emptyCubeTexture),this._emptyCubeTexture=null),this._dummyFramebuffer&&this._gl.deleteFramebuffer(this._dummyFramebuffer),this.releaseEffects(),this.unbindAllAttributes(),this._boundUniforms=[],c.IsWindowObjectExist()&&this._renderingCanvas&&(this._doNotHandleContextLost||(this._renderingCanvas.removeEventListener("webglcontextlost",this._onContextLost),this._renderingCanvas.removeEventListener("webglcontextrestored",this._onContextRestored))),this._workingCanvas=null,this._workingContext=null,this._currentBufferPointers=[],this._renderingCanvas=null,this._currentProgram=null,this._boundRenderFunction=null,L.ResetCache();for(var t=0,e=this._activeRequests;t<e.length;t++){e[t].abort()}},t.prototype.attachContextLostEvent=function(t){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextlost",t,!1)},t.prototype.attachContextRestoredEvent=function(t){this._renderingCanvas&&this._renderingCanvas.addEventListener("webglcontextrestored",t,!1)},t.prototype.getError=function(){return this._gl.getError()},t.prototype._canRenderToFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(1)},t.prototype._canRenderToHalfFloatFramebuffer=function(){return this._webGLVersion>1?this._caps.colorBufferFloat:this._canRenderToFramebuffer(2)},t.prototype._canRenderToFramebuffer=function(t){for(var e=this._gl;e.getError()!==e.NO_ERROR;);var i=!0,r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,this._getRGBABufferInternalSizedFormat(t),1,1,0,e.RGBA,this._getWebGLTextureType(t),null),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST);var n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER);if((i=(i=i&&o===e.FRAMEBUFFER_COMPLETE)&&e.getError()===e.NO_ERROR)&&(e.clear(e.COLOR_BUFFER_BIT),i=i&&e.getError()===e.NO_ERROR),i){e.bindFramebuffer(e.FRAMEBUFFER,null);var s=e.RGBA,a=e.UNSIGNED_BYTE,u=new Uint8Array(4);e.readPixels(0,0,1,1,s,a,u),i=i&&e.getError()===e.NO_ERROR}for(e.deleteTexture(r),e.deleteFramebuffer(n),e.bindFramebuffer(e.FRAMEBUFFER,null);!i&&e.getError()!==e.NO_ERROR;);return i},t.prototype._getWebGLTextureType=function(t){if(1===this._webGLVersion){switch(t){case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT_OES;case 0:return this._gl.UNSIGNED_BYTE;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5}return this._gl.UNSIGNED_BYTE}switch(t){case 3:return this._gl.BYTE;case 0:return this._gl.UNSIGNED_BYTE;case 4:return this._gl.SHORT;case 5:return this._gl.UNSIGNED_SHORT;case 6:return this._gl.INT;case 7:return this._gl.UNSIGNED_INT;case 1:return this._gl.FLOAT;case 2:return this._gl.HALF_FLOAT;case 8:return this._gl.UNSIGNED_SHORT_4_4_4_4;case 9:return this._gl.UNSIGNED_SHORT_5_5_5_1;case 10:return this._gl.UNSIGNED_SHORT_5_6_5;case 11:return this._gl.UNSIGNED_INT_2_10_10_10_REV;case 12:return this._gl.UNSIGNED_INT_24_8;case 13:return this._gl.UNSIGNED_INT_10F_11F_11F_REV;case 14:return this._gl.UNSIGNED_INT_5_9_9_9_REV;case 15:return this._gl.FLOAT_32_UNSIGNED_INT_24_8_REV}return this._gl.UNSIGNED_BYTE},t.prototype._getInternalFormat=function(t){var e=this._gl.RGBA;switch(t){case 0:e=this._gl.ALPHA;break;case 1:e=this._gl.LUMINANCE;break;case 2:e=this._gl.LUMINANCE_ALPHA;break;case 6:e=this._gl.RED;break;case 7:e=this._gl.RG;break;case 4:e=this._gl.RGB;break;case 5:e=this._gl.RGBA}if(this._webGLVersion>1)switch(t){case 8:e=this._gl.RED_INTEGER;break;case 9:e=this._gl.RG_INTEGER;break;case 10:e=this._gl.RGB_INTEGER;break;case 11:e=this._gl.RGBA_INTEGER}return e},t.prototype._getRGBABufferInternalSizedFormat=function(t,e){if(1===this._webGLVersion){if(void 0!==e)switch(e){case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;case 4:return this._gl.RGB}return this._gl.RGBA}switch(t){case 3:switch(e){case 6:return this._gl.R8_SNORM;case 7:return this._gl.RG8_SNORM;case 4:return this._gl.RGB8_SNORM;case 8:return this._gl.R8I;case 9:return this._gl.RG8I;case 10:return this._gl.RGB8I;case 11:return this._gl.RGBA8I;default:return this._gl.RGBA8_SNORM}case 0:switch(e){case 6:return this._gl.R8;case 7:return this._gl.RG8;case 4:return this._gl.RGB8;case 5:return this._gl.RGBA8;case 8:return this._gl.R8UI;case 9:return this._gl.RG8UI;case 10:return this._gl.RGB8UI;case 11:return this._gl.RGBA8UI;case 0:return this._gl.ALPHA;case 1:return this._gl.LUMINANCE;case 2:return this._gl.LUMINANCE_ALPHA;default:return this._gl.RGBA8}case 4:switch(e){case 8:return this._gl.R16I;case 9:return this._gl.RG16I;case 10:return this._gl.RGB16I;case 11:default:return this._gl.RGBA16I}case 5:switch(e){case 8:return this._gl.R16UI;case 9:return this._gl.RG16UI;case 10:return this._gl.RGB16UI;case 11:default:return this._gl.RGBA16UI}case 6:switch(e){case 8:return this._gl.R32I;case 9:return this._gl.RG32I;case 10:return this._gl.RGB32I;case 11:default:return this._gl.RGBA32I}case 7:switch(e){case 8:return this._gl.R32UI;case 9:return this._gl.RG32UI;case 10:return this._gl.RGB32UI;case 11:default:return this._gl.RGBA32UI}case 1:switch(e){case 6:return this._gl.R32F;case 7:return this._gl.RG32F;case 4:return this._gl.RGB32F;case 5:default:return this._gl.RGBA32F}case 2:switch(e){case 6:return this._gl.R16F;case 7:return this._gl.RG16F;case 4:return this._gl.RGB16F;case 5:default:return this._gl.RGBA16F}case 10:return this._gl.RGB565;case 13:return this._gl.R11F_G11F_B10F;case 14:return this._gl.RGB9_E5;case 8:return this._gl.RGBA4;case 9:return this._gl.RGB5_A1;case 11:switch(e){case 5:return this._gl.RGB10_A2;case 11:return this._gl.RGB10_A2UI;default:return this._gl.RGB10_A2}}return this._gl.RGBA8},t.prototype._getRGBAMultiSampleBufferFormat=function(t){return 1===t?this._gl.RGBA32F:2===t?this._gl.RGBA16F:this._gl.RGBA8},t.prototype._loadFile=function(e,i,r,n,o,s){var a=this,u=t._FileToolsLoadFile(e,i,r,n,o,s);return this._activeRequests.push(u),u.onCompleteObservable.add((function(t){a._activeRequests.splice(a._activeRequests.indexOf(t),1)})),u},t._FileToolsLoadFile=function(t,e,i,r,n,o){throw m.WarnImport("FileTools")},t.prototype.readPixels=function(t,e,i,r,n){void 0===n&&(n=!0);var o=n?4:3,s=n?this._gl.RGBA:this._gl.RGB,a=new Uint8Array(r*i*o);return this._gl.readPixels(t,e,i,r,s,this._gl.UNSIGNED_BYTE,a),a},Object.defineProperty(t,"IsSupported",{get:function(){return this.isSupported()},enumerable:!1,configurable:!0}),t.isSupported=function(){if(null!==this._HasMajorPerformanceCaveat)return!this._HasMajorPerformanceCaveat;if(null===this._IsSupported)try{var t=H.CreateCanvas(1,1),e=t.getContext("webgl")||t.getContext("experimental-webgl");this._IsSupported=null!=e&&!!window.WebGLRenderingContext}catch(t){this._IsSupported=!1}return this._IsSupported},Object.defineProperty(t,"HasMajorPerformanceCaveat",{get:function(){if(null===this._HasMajorPerformanceCaveat)try{var t=H.CreateCanvas(1,1),e=t.getContext("webgl",{failIfMajorPerformanceCaveat:!0})||t.getContext("experimental-webgl",{failIfMajorPerformanceCaveat:!0});this._HasMajorPerformanceCaveat=!e}catch(t){this._HasMajorPerformanceCaveat=!1}return this._HasMajorPerformanceCaveat},enumerable:!1,configurable:!0}),t.CeilingPOT=function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t},t.FloorPOT=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)-(t>>1)},t.NearestPOT=function(e){var i=t.CeilingPOT(e),r=t.FloorPOT(e);return i-e>e-r?r:i},t.GetExponentOfTwo=function(e,i,r){var n;switch(void 0===r&&(r=2),r){case 1:n=t.FloorPOT(e);break;case 2:n=t.NearestPOT(e);break;case 3:default:n=t.CeilingPOT(e)}return Math.min(n,i)},t.QueueNewFrame=function(t,e){return c.IsWindowObjectExist()?(e||(e=window),e.requestPostAnimationFrame?e.requestPostAnimationFrame(t):e.requestAnimationFrame?e.requestAnimationFrame(t):e.msRequestAnimationFrame?e.msRequestAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(t):e.mozRequestAnimationFrame?e.mozRequestAnimationFrame(t):e.oRequestAnimationFrame?e.oRequestAnimationFrame(t):window.setTimeout(t,16)):"undefined"!=typeof requestAnimationFrame?requestAnimationFrame(t):setTimeout(t,16)},t.prototype.getHostDocument=function(){return this._renderingCanvas&&this._renderingCanvas.ownerDocument?this._renderingCanvas.ownerDocument:document},t.ExceptionList=[{key:"Chrome/63.0",capture:"63\\.0\\.3239\\.(\\d+)",captureConstraint:108,targets:["uniformBuffer"]},{key:"Firefox/58",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Firefox/59",capture:null,captureConstraint:null,targets:["uniformBuffer"]},{key:"Chrome/72.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/73.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Chrome/74.+?Mobile",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/71",capture:null,captureConstraint:null,targets:["vao"]},{key:"Mac OS.+Chrome/72",capture:null,captureConstraint:null,targets:["vao"]}],t._TextureLoaders=[],t.CollisionsEpsilon=.001,t._IsSupported=null,t._HasMajorPerformanceCaveat=null,t}(),Z=function(t){function e(i,r){var n=t.call(this,i)||this;return n.name="LoadFileError",E._setPrototypeOf(n,e.prototype),r instanceof v?n.request=r:n.file=r,n}return n(e,t),e}(E),J=function(t){function e(i,r){var n=t.call(this,i)||this;return n.request=r,n.name="RequestFileError",E._setPrototypeOf(n,e.prototype),n}return n(e,t),e}(E),$=function(t){function e(i,r){var n=t.call(this,i)||this;return n.file=r,n.name="ReadFileError",E._setPrototypeOf(n,e.prototype),n}return n(e,t),e}(E),tt=function(){function t(){}return t._CleanUrl=function(t){return t=t.replace(/#/gm,"%23")},t.SetCorsBehavior=function(e,i){if((!e||0!==e.indexOf("data:"))&&t.CorsBehavior)if("string"==typeof t.CorsBehavior||this.CorsBehavior instanceof String)i.crossOrigin=t.CorsBehavior;else{var r=t.CorsBehavior(e);r&&(i.crossOrigin=r)}},t.LoadImage=function(e,i,r,n,o){var s;void 0===o&&(o="");var a=!1;if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)?"undefined"!=typeof Blob?(s=URL.createObjectURL(new Blob([e],{type:o})),a=!0):s="data:"+o+";base64,"+d.EncodeArrayBufferToBase64(e):e instanceof Blob?(s=URL.createObjectURL(e),a=!0):(s=t._CleanUrl(e),s=t.PreprocessUrl(e)),"undefined"==typeof Image)return t.LoadFile(s,(function(t){createImageBitmap(new Blob([t],{type:o})).then((function(t){i(t),a&&URL.revokeObjectURL(s)})).catch((function(t){r&&r("Error while trying to load image: "+e,t)}))}),void 0,n||void 0,!0,(function(t,i){r&&r("Error while trying to load image: "+e,i)})),null;var u=new Image;t.SetCorsBehavior(s,u);var h=function(){u.removeEventListener("load",h),u.removeEventListener("error",l),i(u),a&&u.src&&URL.revokeObjectURL(u.src)},l=function(t){if(u.removeEventListener("load",h),u.removeEventListener("error",l),r){var i=e.toString();r("Error while trying to load image: "+(i.length<32?i:i.slice(0,32)+"..."),t)}a&&u.src&&URL.revokeObjectURL(u.src)};u.addEventListener("load",h),u.addEventListener("error",l);var c=function(){u.src=s};if("data:"!==s.substr(0,5)&&n&&n.enableTexturesOffline)n.open((function(){n&&n.loadImage(s,u)}),c);else{if(-1!==s.indexOf("file:")){var f=decodeURIComponent(s.substring(5).toLowerCase());if(x.FilesToLoad[f]){try{var p;try{p=URL.createObjectURL(x.FilesToLoad[f])}catch(t){p=URL.createObjectURL(x.FilesToLoad[f])}u.src=p,a=!0}catch(t){u.src=""}return u}}c()}return u},t.ReadFile=function(t,e,i,r,n){var o=new FileReader,s={onCompleteObservable:new l,abort:function(){return o.abort()}};return o.onloadend=function(t){return s.onCompleteObservable.notifyObservers(s)},n&&(o.onerror=function(e){n(new $("Unable to read "+t.name,t))}),o.onload=function(t){e(t.target.result)},i&&(o.onprogress=i),r?o.readAsArrayBuffer(t):o.readAsText(t),s},t.LoadFile=function(e,i,r,n,o,s){if(-1!==e.indexOf("file:")){var a=decodeURIComponent(e.substring(5).toLowerCase());0===a.indexOf("./")&&(a=a.substring(2));var u=x.FilesToLoad[a];if(u)return t.ReadFile(u,i,r,o,s?function(t){return s(void 0,new Z(t.message,t.file))}:void 0)}return t.RequestFile(e,(function(t,e){i(t,e?e.responseURL:void 0)}),r,n,o,s?function(t){s(t.request,new Z(t.message,t.request))}:void 0)},t.RequestFile=function(e,i,r,n,o,s,a){e=t._CleanUrl(e),e=t.PreprocessUrl(e);var u=t.BaseUrl+e,h=!1,f={onCompleteObservable:new l,abort:function(){return h=!0}},d=function(){var e=new v,n=null;f.abort=function(){h=!0,e.readyState!==(XMLHttpRequest.DONE||4)&&e.abort(),null!==n&&(clearTimeout(n),n=null)};var l=function(d){e.open("GET",u),a&&a(e),o&&(e.responseType="arraybuffer"),r&&e.addEventListener("progress",r);var p=function(){e.removeEventListener("loadend",p),f.onCompleteObservable.notifyObservers(f),f.onCompleteObservable.clear()};e.addEventListener("loadend",p);var _=function(){if(!h&&e.readyState===(XMLHttpRequest.DONE||4)){if(e.removeEventListener("readystatechange",_),e.status>=200&&e.status<300||0===e.status&&(!c.IsWindowObjectExist()||t.IsFileURL()))return void i(o?e.response:e.responseText,e);var r=t.DefaultRetryStrategy;if(r){var a=r(u,e,d);if(-1!==a)return e.removeEventListener("loadend",p),e=new v,void(n=setTimeout((function(){return l(d+1)}),a))}var f=new J("Error status: "+e.status+" "+e.statusText+" - Unable to load "+u,e);s&&s(f)}};e.addEventListener("readystatechange",_),e.send()};l(0)};if(n&&n.enableSceneOffline){var p=function(t){t&&t.status>400?s&&s(t):d()};n.open((function(){n&&n.loadFile(t.BaseUrl+e,(function(t){h||i(t),f.onCompleteObservable.notifyObservers(f)}),r?function(t){h||r(t)}:void 0,p,o)}),p)}else d();return f},t.IsFileURL=function(){return"undefined"!=typeof location&&"file:"===location.protocol},t.DefaultRetryStrategy=A.ExponentialBackoff(),t.BaseUrl="",t.CorsBehavior="anonymous",t.PreprocessUrl=function(t){return t},t}();Q._FileToolsLoadImage=tt.LoadImage.bind(tt),Q._FileToolsLoadFile=tt.LoadFile.bind(tt),O._FileToolsLoadFile=tt.LoadFile.bind(tt),function(t){t[t.Pending=0]="Pending",t[t.Fulfilled=1]="Fulfilled",t[t.Rejected=2]="Rejected"}(z||(z={}));var et=function(){this.count=0,this.target=0,this.results=[]},it=function(){function t(t){var e=this;if(this._state=z.Pending,this._children=new Array,this._rejectWasConsumed=!1,t)try{t((function(t){e._resolve(t)}),(function(t){e._reject(t)}))}catch(t){this._reject(t)}}return Object.defineProperty(t.prototype,"_result",{get:function(){return this._resultValue},set:function(t){this._resultValue=t,this._parent&&void 0===this._parent._result&&(this._parent._result=t)},enumerable:!1,configurable:!0}),t.prototype.catch=function(t){return this.then(void 0,t)},t.prototype.then=function(e,i){var r=this,n=new t;return n._onFulfilled=e,n._onRejected=i,this._children.push(n),n._parent=this,this._state!==z.Pending&&setTimeout((function(){if(r._state===z.Fulfilled||r._rejectWasConsumed){var t=n._resolve(r._result);if(null!=t)if(void 0!==t._state){var e=t;n._children.push(e),e._parent=n,n=e}else n._result=t}else n._reject(r._reason)})),n},t.prototype._moveChildren=function(t){var e,i=this;if((e=this._children).push.apply(e,t.splice(0,t.length)),this._children.forEach((function(t){t._parent=i})),this._state===z.Fulfilled)for(var r=0,n=this._children;r<n.length;r++){n[r]._resolve(this._result)}else if(this._state===z.Rejected)for(var o=0,s=this._children;o<s.length;o++){s[o]._reject(this._reason)}},t.prototype._resolve=function(t){try{this._state=z.Fulfilled;var e=null;if(this._onFulfilled&&(e=this._onFulfilled(t)),null!=e)if(void 0!==e._state){var i=e;i._parent=this,i._moveChildren(this._children),t=i._result}else t=e;this._result=t;for(var r=0,n=this._children;r<n.length;r++){n[r]._resolve(t)}this._children.length=0,delete this._onFulfilled,delete this._onRejected}catch(t){this._reject(t,!0)}},t.prototype._reject=function(t,e){if(void 0===e&&(e=!1),this._state=z.Rejected,this._reason=t,this._onRejected&&!e)try{this._onRejected(t),this._rejectWasConsumed=!0}catch(e){t=e}for(var i=0,r=this._children;i<r.length;i++){var n=r[i];this._rejectWasConsumed?n._resolve(null):n._reject(t)}this._children.length=0,delete this._onFulfilled,delete this._onRejected},t.resolve=function(e){var i=new t;return i._resolve(e),i},t._RegisterForFulfillment=function(t,e,i){t.then((function(t){return e.results[i]=t,e.count++,e.count===e.target&&e.rootPromise._resolve(e.results),null}),(function(t){e.rootPromise._state!==z.Rejected&&e.rootPromise._reject(t)}))},t.all=function(e){var i=new t,r=new et;if(r.target=e.length,r.rootPromise=i,e.length)for(var n=0;n<e.length;n++)t._RegisterForFulfillment(e[n],r,n);else i._resolve([]);return i},t.race=function(e){var i=new t;if(e.length)for(var r=0,n=e;r<n.length;r++){n[r].then((function(t){return i&&(i._resolve(t),i=null),null}),(function(t){i&&(i._reject(t),i=null)}))}return i},t}(),rt=function(){function t(){}return t.Apply=function(t){(void 0===t&&(t=!1),t||"undefined"==typeof Promise)&&(window.Promise=it)},t}(),nt=function(){function t(){}return t.SetImmediate=function(t){c.IsWindowObjectExist()&&window.setImmediate?window.setImmediate(t):setTimeout(t,1)},t}(),ot=function(){function t(){}return t.GetClass=function(t){return this.RegisteredTypes&&this.RegisteredTypes[t]?this.RegisteredTypes[t]:null},t.RegisteredTypes={},t}(),st=function(){function t(){}return t.Instantiate=function(t){if(this.RegisteredExternalClasses&&this.RegisteredExternalClasses[t])return this.RegisteredExternalClasses[t];var e=ot.GetClass(t);if(e)return e;f.Warn(t+" not found, you may have missed an import.");for(var i=t.split("."),r=window||this,n=0,o=i.length;n<o;n++)r=r[i[n]];return"function"!=typeof r?null:r},t.RegisteredExternalClasses={},t}(),at=function(){function t(){}return t.RandomId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},t}(),ut=function(){function t(){}return Object.defineProperty(t,"BaseUrl",{get:function(){return tt.BaseUrl},set:function(t){tt.BaseUrl=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"DefaultRetryStrategy",{get:function(){return tt.DefaultRetryStrategy},set:function(t){tt.DefaultRetryStrategy=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CorsBehavior",{get:function(){return tt.CorsBehavior},set:function(t){tt.CorsBehavior=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"UseFallbackTexture",{get:function(){return b.UseFallbackTexture},set:function(t){b.UseFallbackTexture=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"RegisteredExternalClasses",{get:function(){return st.RegisteredExternalClasses},set:function(t){st.RegisteredExternalClasses=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"fallbackTexture",{get:function(){return b.FallbackTexture},set:function(t){b.FallbackTexture=t},enumerable:!1,configurable:!0}),t.FetchToRef=function(t,e,i,r,n,o){var s=4*((Math.abs(t)*i%i|0)+(Math.abs(e)*r%r|0)*i);o.r=n[s]/255,o.g=n[s+1]/255,o.b=n[s+2]/255,o.a=n[s+3]/255},t.Mix=function(t,e,i){return t*(1-i)+e*i},t.Instantiate=function(t){return st.Instantiate(t)},t.Slice=function(t,e,i){return t.slice?t.slice(e,i):Array.prototype.slice.call(t,e,i)},t.SliceToArray=function(t,e,i){return Array.isArray(t)?t.slice(e,i):Array.prototype.slice.call(t,e,i)},t.SetImmediate=function(t){nt.SetImmediate(t)},t.IsExponentOfTwo=function(t){var e=1;do{e*=2}while(e<t);return e===t},t.FloatRound=function(e){return Math.fround?Math.fround(e):t._tmpFloatArray[0]=e},t.GetFilename=function(t){var e=t.lastIndexOf("/");return e<0?t:t.substring(e+1)},t.GetFolderPath=function(t,e){void 0===e&&(e=!1);var i=t.lastIndexOf("/");return i<0?e?t:"":t.substring(0,i+1)},t.ToDegrees=function(t){return 180*t/Math.PI},t.ToRadians=function(t){return t*Math.PI/180},t.MakeArray=function(t,e){return!0===e||void 0!==t&&null!=t?Array.isArray(t)?t:[t]:null},t.GetPointerPrefix=function(t){var e="pointer";return c.IsWindowObjectExist()&&!window.PointerEvent&&c.IsNavigatorAvailable()&&!navigator.pointerEnabled&&(e="mouse"),!t._badDesktopOS||t._badOS||document&&"ontouchend"in document||(e="mouse"),e},t.SetCorsBehavior=function(t,e){tt.SetCorsBehavior(t,e)},t.CleanUrl=function(t){return t=t.replace(/#/gm,"%23")},Object.defineProperty(t,"PreprocessUrl",{get:function(){return tt.PreprocessUrl},set:function(t){tt.PreprocessUrl=t},enumerable:!1,configurable:!0}),t.LoadImage=function(t,e,i,r,n){return tt.LoadImage(t,e,i,r,n)},t.LoadFile=function(t,e,i,r,n,o){return tt.LoadFile(t,e,i,r,n,o)},t.LoadFileAsync=function(t,e){return void 0===e&&(e=!0),new Promise((function(i,r){tt.LoadFile(t,(function(t){i(t)}),void 0,void 0,e,(function(t,e){r(e)}))}))},t.LoadScript=function(t,e,i,r){if(c.IsWindowObjectExist()){var n=document.getElementsByTagName("head")[0],o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",t),r&&(o.id=r),o.onload=function(){e&&e()},o.onerror=function(e){i&&i("Unable to load script '"+t+"'",e)},n.appendChild(o)}},t.LoadScriptAsync=function(t,e){var i=this;return new Promise((function(e,r){i.LoadScript(t,(function(){e()}),(function(t,e){r(e)}))}))},t.ReadFileAsDataURL=function(t,e,i){var r=new FileReader,n={onCompleteObservable:new l,abort:function(){return r.abort()}};return r.onloadend=function(t){n.onCompleteObservable.notifyObservers(n)},r.onload=function(t){e(t.target.result)},r.onprogress=i,r.readAsDataURL(t),n},t.ReadFile=function(t,e,i,r,n){return tt.ReadFile(t,e,i,r,n)},t.FileAsURL=function(t){var e=new Blob([t]);return(window.URL||window.webkitURL).createObjectURL(e)},t.Format=function(t,e){return void 0===e&&(e=2),t.toFixed(e)},t.DeepCopy=function(t,e,i,r){_.DeepCopy(t,e,i,r)},t.IsEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},t.RegisterTopRootEvents=function(t,e){for(var i=0;i<e.length;i++){var r=e[i];t.addEventListener(r.name,r.handler,!1);try{window.parent&&window.parent.addEventListener(r.name,r.handler,!1)}catch(t){}}},t.UnregisterTopRootEvents=function(t,e){for(var i=0;i<e.length;i++){var r=e[i];t.removeEventListener(r.name,r.handler);try{t.parent&&t.parent.removeEventListener(r.name,r.handler)}catch(t){}}},t.DumpFramebuffer=function(e,i,r,n,o,s){void 0===o&&(o="image/png");for(var a=4*e,u=i/2,h=r.readPixels(0,0,e,i),l=0;l<u;l++)for(var c=0;c<a;c++){var f=c+l*a,d=c+(i-l-1)*a,p=h[f];h[f]=h[d],h[d]=p}t._ScreenshotCanvas||(t._ScreenshotCanvas=document.createElement("canvas")),t._ScreenshotCanvas.width=e,t._ScreenshotCanvas.height=i;var _=t._ScreenshotCanvas.getContext("2d");if(_){var g=_.createImageData(e,i);g.data.set(h),_.putImageData(g,0,0),t.EncodeScreenshotCanvasData(n,o,s)}},t.ToBlob=function(t,e,i){void 0===i&&(i="image/png"),t.toBlob||(t.toBlob=function(t,e,i){var r=this;setTimeout((function(){for(var n=atob(r.toDataURL(e,i).split(",")[1]),o=n.length,s=new Uint8Array(o),a=0;a<o;a++)s[a]=n.charCodeAt(a);t(new Blob([s]))}))}),t.toBlob((function(t){e(t)}),i)},t.EncodeScreenshotCanvasData=function(e,i,r){(void 0===i&&(i="image/png"),e)?e(t._ScreenshotCanvas.toDataURL(i)):this.ToBlob(t._ScreenshotCanvas,(function(e){if("download"in document.createElement("a")){if(!r){var i=new Date,n=(i.getFullYear()+"-"+(i.getMonth()+1)).slice(2)+"-"+i.getDate()+"_"+i.getHours()+"-"+("0"+i.getMinutes()).slice(-2);r="screenshot_"+n+".png"}t.Download(e,r)}else{var o=URL.createObjectURL(e),s=window.open("");if(!s)return;var a=s.document.createElement("img");a.onload=function(){URL.revokeObjectURL(o)},a.src=o,s.document.body.appendChild(a)}}),i)},t.Download=function(t,e){if(navigator&&navigator.msSaveBlob)navigator.msSaveBlob(t,e);else{var i=window.URL.createObjectURL(t),r=document.createElement("a");document.body.appendChild(r),r.style.display="none",r.href=i,r.download=e,r.addEventListener("click",(function(){r.parentElement&&r.parentElement.removeChild(r)})),r.click(),window.URL.revokeObjectURL(i)}},t.BackCompatCameraNoPreventDefault=function(t){return"boolean"==typeof t[0]?t[0]:"boolean"==typeof t[1]&&t[1]},t.CreateScreenshot=function(t,e,i,r,n){throw void 0===n&&(n="image/png"),m.WarnImport("ScreenshotTools")},t.CreateScreenshotAsync=function(t,e,i,r){throw void 0===r&&(r="image/png"),m.WarnImport("ScreenshotTools")},t.CreateScreenshotUsingRenderTarget=function(t,e,i,r,n,o,s,a){throw void 0===n&&(n="image/png"),void 0===o&&(o=1),void 0===s&&(s=!1),m.WarnImport("ScreenshotTools")},t.CreateScreenshotUsingRenderTargetAsync=function(t,e,i,r,n,o,s){throw void 0===r&&(r="image/png"),void 0===n&&(n=1),void 0===o&&(o=!1),m.WarnImport("ScreenshotTools")},t.RandomId=function(){return at.RandomId()},t.IsBase64=function(t){return!(t.length<5)&&"data:"===t.substr(0,5)},t.DecodeBase64=function(t){for(var e=atob(t.split(",")[1]),i=e.length,r=new Uint8Array(new ArrayBuffer(i)),n=0;n<i;n++)r[n]=e.charCodeAt(n);return r.buffer},t.GetAbsoluteUrl=function(t){var e=document.createElement("a");return e.href=t,e.href},Object.defineProperty(t,"errorsCount",{get:function(){return f.errorsCount},enumerable:!1,configurable:!0}),t.Log=function(t){f.Log(t)},t.Warn=function(t){f.Warn(t)},t.Error=function(t){f.Error(t)},Object.defineProperty(t,"LogCache",{get:function(){return f.LogCache},enumerable:!1,configurable:!0}),t.ClearLogCache=function(){f.ClearLogCache()},Object.defineProperty(t,"LogLevels",{set:function(t){f.LogLevels=t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"PerformanceLogLevel",{set:function(e){return(e&t.PerformanceUserMarkLogLevel)===t.PerformanceUserMarkLogLevel?(t.StartPerformanceCounter=t._StartUserMark,void(t.EndPerformanceCounter=t._EndUserMark)):(e&t.PerformanceConsoleLogLevel)===t.PerformanceConsoleLogLevel?(t.StartPerformanceCounter=t._StartPerformanceConsole,void(t.EndPerformanceCounter=t._EndPerformanceConsole)):(t.StartPerformanceCounter=t._StartPerformanceCounterDisabled,void(t.EndPerformanceCounter=t._EndPerformanceCounterDisabled))},enumerable:!1,configurable:!0}),t._StartPerformanceCounterDisabled=function(t,e){},t._EndPerformanceCounterDisabled=function(t,e){},t._StartUserMark=function(e,i){if(void 0===i&&(i=!0),!t._performance){if(!c.IsWindowObjectExist())return;t._performance=window.performance}i&&t._performance.mark&&t._performance.mark(e+"-Begin")},t._EndUserMark=function(e,i){void 0===i&&(i=!0),i&&t._performance.mark&&(t._performance.mark(e+"-End"),t._performance.measure(e,e+"-Begin",e+"-End"))},t._StartPerformanceConsole=function(e,i){void 0===i&&(i=!0),i&&(t._StartUserMark(e,i),console.time&&console.time(e))},t._EndPerformanceConsole=function(e,i){void 0===i&&(i=!0),i&&(t._EndUserMark(e,i),console.timeEnd(e))},Object.defineProperty(t,"Now",{get:function(){return g.Now},enumerable:!1,configurable:!0}),t.GetClassName=function(t,e){void 0===e&&(e=!1);var i=null;if(!e&&t.getClassName)i=t.getClassName();else{if(t instanceof Object)i=(e?t:Object.getPrototypeOf(t)).constructor.__bjsclassName__;i||(i=typeof t)}return i},t.First=function(t,e){for(var i=0,r=t;i<r.length;i++){var n=r[i];if(e(n))return n}return null},t.getFullClassName=function(t,e){void 0===e&&(e=!1);var i=null,r=null;if(!e&&t.getClassName)i=t.getClassName();else{if(t instanceof Object){var n=e?t:Object.getPrototypeOf(t);i=n.constructor.__bjsclassName__,r=n.constructor.__bjsmoduleName__}i||(i=typeof t)}return i?(null!=r?r+".":"")+i:null},t.DelayAsync=function(t){return new Promise((function(e){setTimeout((function(){e()}),t)}))},t.IsSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},t.UseCustomRequestHeaders=!1,t.CustomRequestHeaders=v.CustomRequestHeaders,t._tmpFloatArray=new Float32Array(1),t.GetDOMTextContent=c.GetDOMTextContent,t.NoneLogLevel=f.NoneLogLevel,t.MessageLogLevel=f.MessageLogLevel,t.WarningLogLevel=f.WarningLogLevel,t.ErrorLogLevel=f.ErrorLogLevel,t.AllLogLevel=f.AllLogLevel,t.IsWindowObjectExist=c.IsWindowObjectExist,t.PerformanceNoneLogLevel=0,t.PerformanceUserMarkLogLevel=1,t.PerformanceConsoleLogLevel=2,t.StartPerformanceCounter=t._StartPerformanceCounterDisabled,t.EndPerformanceCounter=t._EndPerformanceCounterDisabled,t}();var ht=function(){function t(t,e,i,r){void 0===r&&(r=0),this.iterations=t,this.index=r-1,this._done=!1,this._fn=e,this._successCallback=i}return t.prototype.executeNext=function(){this._done||(this.index+1<this.iterations?(++this.index,this._fn(this)):this.breakLoop())},t.prototype.breakLoop=function(){this._done=!0,this._successCallback()},t.Run=function(e,i,r,n){void 0===n&&(n=0);var o=new t(e,i,r,n);return o.executeNext(),o},t.SyncAsyncForLoop=function(e,i,r,n,o,s){return void 0===s&&(s=0),t.Run(Math.ceil(e/i),(function(t){o&&o()?t.breakLoop():setTimeout((function(){for(var n=0;n<i;++n){var s=t.index*i+n;if(s>=e)break;if(r(s),o&&o()){t.breakLoop();break}}t.executeNext()}),s)}),n)},t}();b.FallbackTexture="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QBmRXhpZgAATU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAAExAAIAAAAQAAAATgAAAAAAAABgAAAAAQAAAGAAAAABcGFpbnQubmV0IDQuMC41AP/bAEMABAIDAwMCBAMDAwQEBAQFCQYFBQUFCwgIBgkNCw0NDQsMDA4QFBEODxMPDAwSGBITFRYXFxcOERkbGRYaFBYXFv/bAEMBBAQEBQUFCgYGChYPDA8WFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFv/AABEIAQABAAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APH6KKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76CiiigD5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BQooooA+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/voKKKKAPl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FCiiigD6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++gooooA+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gUKKKKAPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76Pl+iiivuj+BT6gooor4U/vo+X6KKK+6P4FPqCiiivhT++j5fooor7o/gU+oKKKK+FP76P//Z",rt.Apply();var lt=function(){function t(){}return t.Eval=function(e,i){return"true"===(e=e.match(/\([^\(\)]*\)/g)?e.replace(/\([^\(\)]*\)/g,(function(e){return e=e.slice(1,e.length-1),t._HandleParenthesisContent(e,i)})):t._HandleParenthesisContent(e,i))||"false"!==e&&t.Eval(e,i)},t._HandleParenthesisContent=function(e,i){var r;i=i||function(t){return"true"===t};var n=e.split("||");for(var o in n)if(n.hasOwnProperty(o)){var s=t._SimplifyNegation(n[o].trim()),a=s.split("&&");if(a.length>1)for(var u=0;u<a.length;++u){var h=t._SimplifyNegation(a[u].trim());if(!(r="true"!==h&&"false"!==h?"!"===h[0]?!i(h.substring(1)):i(h):"true"===h)){s="false";break}}if(r||"true"===s){r=!0;break}r="true"!==s&&"false"!==s?"!"===s[0]?!i(s.substring(1)):i(s):"true"===s}return r?"true":"false"},t._SimplifyNegation=function(t){return"!true"===(t=(t=t.replace(/^[\s!]+/,(function(t){return(t=t.replace(/[\s]/g,(function(){return""}))).length%2?"!":""}))).trim())?t="false":"!false"===t&&(t="true"),t},t}(),ct=function(){function t(){}return t.EnableFor=function(e){e._tags=e._tags||{},e.hasTags=function(){return t.HasTags(e)},e.addTags=function(i){return t.AddTagsTo(e,i)},e.removeTags=function(i){return t.RemoveTagsFrom(e,i)},e.matchesTagsQuery=function(i){return t.MatchesQuery(e,i)}},t.DisableFor=function(t){delete t._tags,delete t.hasTags,delete t.addTags,delete t.removeTags,delete t.matchesTagsQuery},t.HasTags=function(t){if(!t._tags)return!1;var e=t._tags;for(var i in e)if(e.hasOwnProperty(i))return!0;return!1},t.GetTags=function(t,e){if(void 0===e&&(e=!0),!t._tags)return null;if(e){var i=[];for(var r in t._tags)t._tags.hasOwnProperty(r)&&!0===t._tags[r]&&i.push(r);return i.join(" ")}return t._tags},t.AddTagsTo=function(e,i){i&&("string"==typeof i&&i.split(" ").forEach((function(i,r,n){t._AddTagTo(e,i)})))},t._AddTagTo=function(e,i){""!==(i=i.trim())&&"true"!==i&&"false"!==i&&(i.match(/[\s]/)||i.match(/^([!]|([|]|[&]){2})/)||(t.EnableFor(e),e._tags[i]=!0))},t.RemoveTagsFrom=function(e,i){if(t.HasTags(e)){var r=i.split(" ");for(var n in r)t._RemoveTagFrom(e,r[n])}},t._RemoveTagFrom=function(t,e){delete t._tags[e]},t.MatchesQuery=function(e,i){return void 0===i||(""===i?t.HasTags(e):lt.Eval(i,(function(i){return t.HasTags(e)&&e._tags[i]})))},t}(),ft=function(){function t(){}return t.WithinEpsilon=function(t,e,i){void 0===i&&(i=1401298e-51);var r=t-e;return-i<=r&&r<=i},t.ToHex=function(t){var e=t.toString(16);return t<=15?("0"+e).toUpperCase():e.toUpperCase()},t.Sign=function(t){return 0===(t=+t)||isNaN(t)?t:t>0?1:-1},t.Clamp=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=1),Math.min(i,Math.max(e,t))},t.Log2=function(t){return Math.log(t)*Math.LOG2E},t.Repeat=function(t,e){return t-Math.floor(t/e)*e},t.Normalize=function(t,e,i){return(t-e)/(i-e)},t.Denormalize=function(t,e,i){return t*(i-e)+e},t.DeltaAngle=function(e,i){var r=t.Repeat(i-e,360);return r>180&&(r-=360),r},t.PingPong=function(e,i){var r=t.Repeat(e,2*i);return i-Math.abs(r-i)},t.SmoothStep=function(e,i,r){var n=t.Clamp(r);return i*(n=-2*n*n*n+3*n*n)+e*(1-n)},t.MoveTowards=function(e,i,r){return Math.abs(i-e)<=r?i:e+t.Sign(i-e)*r},t.MoveTowardsAngle=function(e,i,r){var n=t.DeltaAngle(e,i),o=0;return-r<n&&n<r?o=i:(i=e+n,o=t.MoveTowards(e,i,r)),o},t.Lerp=function(t,e,i){return t+(e-t)*i},t.LerpAngle=function(e,i,r){var n=t.Repeat(i-e,360);return n>180&&(n-=360),e+n*t.Clamp(r)},t.InverseLerp=function(e,i,r){return e!=i?t.Clamp((r-e)/(i-e)):0},t.Hermite=function(t,e,i,r,n){var o=n*n,s=n*o;return t*(2*s-3*o+1)+i*(-2*s+3*o)+e*(s-2*o+n)+r*(s-o)},t.RandomRange=function(t,e){return t===e?t:Math.random()*(e-t)+t},t.RangeToPercent=function(t,e,i){return(t-e)/(i-e)},t.PercentToRange=function(t,e,i){return(i-e)*t+e},t.NormalizeRadians=function(e){return e-=t.TwoPi*Math.floor((e+Math.PI)/t.TwoPi)},t.TwoPi=2*Math.PI,t}(),dt=function(){function t(){}return t.BuildArray=function(t,e){for(var i=[],r=0;r<t;++r)i.push(e());return i},t}(),pt=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.toString=function(){return"{X: "+this.x+" Y: "+this.y+"}"},t.prototype.getClassName=function(){return"Vector2"},t.prototype.getHashCode=function(){var t=0|this.x;return t=397*t^(0|this.y)},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,this},t.prototype.fromArray=function(e,i){return void 0===i&&(i=0),t.FromArrayToRef(e,i,this),this},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this},t.prototype.copyFromFloats=function(t,e){return this.x=t,this.y=e,this},t.prototype.set=function(t,e){return this.copyFromFloats(t,e)},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.addToRef=function(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,this},t.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.addVector3=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.subtractToRef=function(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,this},t.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this},t.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this},t.prototype.multiply=function(e){return new t(this.x*e.x,this.y*e.y)},t.prototype.multiplyToRef=function(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,this},t.prototype.multiplyByFloats=function(e,i){return new t(this.x*e,this.y*i)},t.prototype.divide=function(e){return new t(this.x/e.x,this.y/e.y)},t.prototype.divideToRef=function(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,this},t.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},t.prototype.negate=function(){return new t(-this.x,-this.y)},t.prototype.negateInPlace=function(){return this.x*=-1,this.y*=-1,this},t.prototype.negateToRef=function(t){return t.copyFromFloats(-1*this.x,-1*this.y)},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this},t.prototype.scale=function(e){var i=new t(0,0);return this.scaleToRef(e,i),i},t.prototype.scaleToRef=function(t,e){return e.x=this.x*t,e.y=this.y*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.x+=this.x*t,e.y+=this.y*t,this},t.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y},t.prototype.equalsWithEpsilon=function(t,e){return void 0===e&&(e=.001),t&&ft.WithinEpsilon(this.x,t.x,e)&&ft.WithinEpsilon(this.y,t.y,e)},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},t.prototype.normalize=function(){var t=this.length();return 0===t||(this.x/=t,this.y/=t),this},t.prototype.clone=function(){return new t(this.x,this.y)},t.Zero=function(){return new t(0,0)},t.One=function(){return new t(1,1)},t.FromArray=function(e,i){return void 0===i&&(i=0),new t(e[i],e[i+1])},t.FromArrayToRef=function(t,e,i){i.x=t[e],i.y=t[e+1]},t.CatmullRom=function(e,i,r,n,o){var s=o*o,a=o*s;return new t(.5*(2*i.x+(-e.x+r.x)*o+(2*e.x-5*i.x+4*r.x-n.x)*s+(-e.x+3*i.x-3*r.x+n.x)*a),.5*(2*i.y+(-e.y+r.y)*o+(2*e.y-5*i.y+4*r.y-n.y)*s+(-e.y+3*i.y-3*r.y+n.y)*a))},t.Clamp=function(e,i,r){var n=e.x;n=(n=n>r.x?r.x:n)<i.x?i.x:n;var o=e.y;return new t(n,o=(o=o>r.y?r.y:o)<i.y?i.y:o)},t.Hermite=function(e,i,r,n,o){var s=o*o,a=o*s,u=2*a-3*s+1,h=-2*a+3*s,l=a-2*s+o,c=a-s;return new t(e.x*u+r.x*h+i.x*l+n.x*c,e.y*u+r.y*h+i.y*l+n.y*c)},t.Lerp=function(e,i,r){return new t(e.x+(i.x-e.x)*r,e.y+(i.y-e.y)*r)},t.Dot=function(t,e){return t.x*e.x+t.y*e.y},t.Normalize=function(t){var e=t.clone();return e.normalize(),e},t.Minimize=function(e,i){return new t(e.x<i.x?e.x:i.x,e.y<i.y?e.y:i.y)},t.Maximize=function(e,i){return new t(e.x>i.x?e.x:i.x,e.y>i.y?e.y:i.y)},t.Transform=function(e,i){var r=t.Zero();return t.TransformToRef(e,i,r),r},t.TransformToRef=function(t,e,i){var r=e.m,n=t.x*r[0]+t.y*r[4]+r[12],o=t.x*r[1]+t.y*r[5]+r[13];i.x=n,i.y=o},t.PointInTriangle=function(t,e,i,r){var n=.5*(-i.y*r.x+e.y*(-i.x+r.x)+e.x*(i.y-r.y)+i.x*r.y),o=n<0?-1:1,s=(e.y*r.x-e.x*r.y+(r.y-e.y)*t.x+(e.x-r.x)*t.y)*o,a=(e.x*i.y-e.y*i.x+(e.y-i.y)*t.x+(i.x-e.x)*t.y)*o;return s>0&&a>0&&s+a<2*n*o},t.Distance=function(e,i){return Math.sqrt(t.DistanceSquared(e,i))},t.DistanceSquared=function(t,e){var i=t.x-e.x,r=t.y-e.y;return i*i+r*r},t.Center=function(t,e){var i=t.add(e);return i.scaleInPlace(.5),i},t.DistanceOfPointFromSegment=function(e,i,r){var n=t.DistanceSquared(i,r);if(0===n)return t.Distance(e,i);var o=r.subtract(i),s=Math.max(0,Math.min(1,t.Dot(e.subtract(i),o)/n)),a=i.add(o.multiplyByFloats(s,s));return t.Distance(e,a)},t}(),_t=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this._isDirty=!0,this._x=t,this._y=e,this._z=i}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t,this._isDirty=!0},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"{X: "+this._x+" Y:"+this._y+" Z:"+this._z+"}"},t.prototype.getClassName=function(){return"Vector3"},t.prototype.getHashCode=function(){var t=0|this._x;return t=397*(t=397*t^(0|this._y))^(0|this._z)},t.prototype.asArray=function(){var t=[];return this.toArray(t,0),t},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,this},t.prototype.fromArray=function(e,i){return void 0===i&&(i=0),t.FromArrayToRef(e,i,this),this},t.prototype.toQuaternion=function(){return mt.RotationYawPitchRoll(this._y,this._x,this._z)},t.prototype.addInPlace=function(t){return this.addInPlaceFromFloats(t._x,t._y,t._z)},t.prototype.addInPlaceFromFloats=function(t,e,i){return this.x+=t,this.y+=e,this.z+=i,this},t.prototype.add=function(e){return new t(this._x+e._x,this._y+e._y,this._z+e._z)},t.prototype.addToRef=function(t,e){return e.copyFromFloats(this._x+t._x,this._y+t._y,this._z+t._z)},t.prototype.subtractInPlace=function(t){return this.x-=t._x,this.y-=t._y,this.z-=t._z,this},t.prototype.subtract=function(e){return new t(this._x-e._x,this._y-e._y,this._z-e._z)},t.prototype.subtractToRef=function(t,e){return this.subtractFromFloatsToRef(t._x,t._y,t._z,e)},t.prototype.subtractFromFloats=function(e,i,r){return new t(this._x-e,this._y-i,this._z-r)},t.prototype.subtractFromFloatsToRef=function(t,e,i,r){return r.copyFromFloats(this._x-t,this._y-e,this._z-i)},t.prototype.negate=function(){return new t(-this._x,-this._y,-this._z)},t.prototype.negateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},t.prototype.negateToRef=function(t){return t.copyFromFloats(-1*this._x,-1*this._y,-1*this._z)},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this},t.prototype.scale=function(e){return new t(this._x*e,this._y*e,this._z*e)},t.prototype.scaleToRef=function(t,e){return e.copyFromFloats(this._x*t,this._y*t,this._z*t)},t.prototype.scaleAndAddToRef=function(t,e){return e.addInPlaceFromFloats(this._x*t,this._y*t,this._z*t)},t.prototype.projectOnPlane=function(e,i){var r=t.Zero();return this.projectOnPlaneToRef(e,i,r),r},t.prototype.projectOnPlaneToRef=function(e,i,r){var n=e.normal,o=e.d,s=vt.Vector3[0];this.subtractToRef(i,s),s.normalize();var a=t.Dot(s,n),u=-(t.Dot(i,n)+o)/a,h=s.scaleInPlace(u);i.addToRef(h,r)},t.prototype.equals=function(t){return t&&this._x===t._x&&this._y===t._y&&this._z===t._z},t.prototype.equalsWithEpsilon=function(t,e){return void 0===e&&(e=.001),t&&ft.WithinEpsilon(this._x,t._x,e)&&ft.WithinEpsilon(this._y,t._y,e)&&ft.WithinEpsilon(this._z,t._z,e)},t.prototype.equalsToFloats=function(t,e,i){return this._x===t&&this._y===e&&this._z===i},t.prototype.multiplyInPlace=function(t){return this.x*=t._x,this.y*=t._y,this.z*=t._z,this},t.prototype.multiply=function(t){return this.multiplyByFloats(t._x,t._y,t._z)},t.prototype.multiplyToRef=function(t,e){return e.copyFromFloats(this._x*t._x,this._y*t._y,this._z*t._z)},t.prototype.multiplyByFloats=function(e,i,r){return new t(this._x*e,this._y*i,this._z*r)},t.prototype.divide=function(e){return new t(this._x/e._x,this._y/e._y,this._z/e._z)},t.prototype.divideToRef=function(t,e){return e.copyFromFloats(this._x/t._x,this._y/t._y,this._z/t._z)},t.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},t.prototype.minimizeInPlace=function(t){return this.minimizeInPlaceFromFloats(t._x,t._y,t._z)},t.prototype.maximizeInPlace=function(t){return this.maximizeInPlaceFromFloats(t._x,t._y,t._z)},t.prototype.minimizeInPlaceFromFloats=function(t,e,i){return t<this._x&&(this.x=t),e<this._y&&(this.y=e),i<this._z&&(this.z=i),this},t.prototype.maximizeInPlaceFromFloats=function(t,e,i){return t>this._x&&(this.x=t),e>this._y&&(this.y=e),i>this._z&&(this.z=i),this},t.prototype.isNonUniformWithinEpsilon=function(t){var e=Math.abs(this._x),i=Math.abs(this._y);if(!ft.WithinEpsilon(e,i,t))return!0;var r=Math.abs(this._z);return!ft.WithinEpsilon(e,r,t)||!ft.WithinEpsilon(i,r,t)},Object.defineProperty(t.prototype,"isNonUniform",{get:function(){var t=Math.abs(this._x);return t!==Math.abs(this._y)||t!==Math.abs(this._z)},enumerable:!1,configurable:!0}),t.prototype.floor=function(){return new t(Math.floor(this._x),Math.floor(this._y),Math.floor(this._z))},t.prototype.fract=function(){return new t(this._x-Math.floor(this._x),this._y-Math.floor(this._y),this._z-Math.floor(this._z))},t.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)},t.prototype.lengthSquared=function(){return this._x*this._x+this._y*this._y+this._z*this._z},t.prototype.normalize=function(){return this.normalizeFromLength(this.length())},t.prototype.reorderInPlace=function(t){var e=this;return"xyz"===(t=t.toLowerCase())||(vt.Vector3[0].copyFrom(this),["x","y","z"].forEach((function(i,r){e[i]=vt.Vector3[0][t[r]]}))),this},t.prototype.rotateByQuaternionToRef=function(e,i){return e.toRotationMatrix(vt.Matrix[0]),t.TransformCoordinatesToRef(this,vt.Matrix[0],i),i},t.prototype.rotateByQuaternionAroundPointToRef=function(t,e,i){return this.subtractToRef(e,vt.Vector3[0]),vt.Vector3[0].rotateByQuaternionToRef(t,vt.Vector3[0]),e.addToRef(vt.Vector3[0],i),i},t.prototype.cross=function(e){return t.Cross(this,e)},t.prototype.normalizeFromLength=function(t){return 0===t||1===t?this:this.scaleInPlace(1/t)},t.prototype.normalizeToNew=function(){var e=new t(0,0,0);return this.normalizeToRef(e),e},t.prototype.normalizeToRef=function(t){var e=this.length();return 0===e||1===e?t.copyFromFloats(this._x,this._y,this._z):this.scaleToRef(1/e,t)},t.prototype.clone=function(){return new t(this._x,this._y,this._z)},t.prototype.copyFrom=function(t){return this.copyFromFloats(t._x,t._y,t._z)},t.prototype.copyFromFloats=function(t,e,i){return this.x=t,this.y=e,this.z=i,this},t.prototype.set=function(t,e,i){return this.copyFromFloats(t,e,i)},t.prototype.setAll=function(t){return this.x=this.y=this.z=t,this},t.GetClipFactor=function(e,i,r,n){var o=t.Dot(e,r)-n;return o/(o-(t.Dot(i,r)-n))},t.GetAngleBetweenVectors=function(e,i,r){var n=e.normalizeToRef(vt.Vector3[1]),o=i.normalizeToRef(vt.Vector3[2]),s=t.Dot(n,o),a=vt.Vector3[3];return t.CrossToRef(n,o,a),t.Dot(a,r)>0?Math.acos(s):-Math.acos(s)},t.FromArray=function(e,i){return void 0===i&&(i=0),new t(e[i],e[i+1],e[i+2])},t.FromFloatArray=function(e,i){return t.FromArray(e,i)},t.FromArrayToRef=function(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2]},t.FromFloatArrayToRef=function(e,i,r){return t.FromArrayToRef(e,i,r)},t.FromFloatsToRef=function(t,e,i,r){r.copyFromFloats(t,e,i)},t.Zero=function(){return new t(0,0,0)},t.One=function(){return new t(1,1,1)},t.Up=function(){return new t(0,1,0)},Object.defineProperty(t,"UpReadOnly",{get:function(){return t._UpReadOnly},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ZeroReadOnly",{get:function(){return t._ZeroReadOnly},enumerable:!1,configurable:!0}),t.Down=function(){return new t(0,-1,0)},t.Forward=function(e){return void 0===e&&(e=!1),new t(0,0,e?-1:1)},t.Backward=function(e){return void 0===e&&(e=!1),new t(0,0,e?1:-1)},t.Right=function(){return new t(1,0,0)},t.Left=function(){return new t(-1,0,0)},t.TransformCoordinates=function(e,i){var r=t.Zero();return t.TransformCoordinatesToRef(e,i,r),r},t.TransformCoordinatesToRef=function(e,i,r){t.TransformCoordinatesFromFloatsToRef(e._x,e._y,e._z,i,r)},t.TransformCoordinatesFromFloatsToRef=function(t,e,i,r,n){var o=r.m,s=t*o[0]+e*o[4]+i*o[8]+o[12],a=t*o[1]+e*o[5]+i*o[9]+o[13],u=t*o[2]+e*o[6]+i*o[10]+o[14],h=1/(t*o[3]+e*o[7]+i*o[11]+o[15]);n.x=s*h,n.y=a*h,n.z=u*h},t.TransformNormal=function(e,i){var r=t.Zero();return t.TransformNormalToRef(e,i,r),r},t.TransformNormalToRef=function(t,e,i){this.TransformNormalFromFloatsToRef(t._x,t._y,t._z,e,i)},t.TransformNormalFromFloatsToRef=function(t,e,i,r,n){var o=r.m;n.x=t*o[0]+e*o[4]+i*o[8],n.y=t*o[1]+e*o[5]+i*o[9],n.z=t*o[2]+e*o[6]+i*o[10]},t.CatmullRom=function(e,i,r,n,o){var s=o*o,a=o*s;return new t(.5*(2*i._x+(-e._x+r._x)*o+(2*e._x-5*i._x+4*r._x-n._x)*s+(-e._x+3*i._x-3*r._x+n._x)*a),.5*(2*i._y+(-e._y+r._y)*o+(2*e._y-5*i._y+4*r._y-n._y)*s+(-e._y+3*i._y-3*r._y+n._y)*a),.5*(2*i._z+(-e._z+r._z)*o+(2*e._z-5*i._z+4*r._z-n._z)*s+(-e._z+3*i._z-3*r._z+n._z)*a))},t.Clamp=function(e,i,r){var n=new t;return t.ClampToRef(e,i,r,n),n},t.ClampToRef=function(t,e,i,r){var n=t._x;n=(n=n>i._x?i._x:n)<e._x?e._x:n;var o=t._y;o=(o=o>i._y?i._y:o)<e._y?e._y:o;var s=t._z;s=(s=s>i._z?i._z:s)<e._z?e._z:s,r.copyFromFloats(n,o,s)},t.CheckExtends=function(t,e,i){e.minimizeInPlace(t),i.maximizeInPlace(t)},t.Hermite=function(e,i,r,n,o){var s=o*o,a=o*s,u=2*a-3*s+1,h=-2*a+3*s,l=a-2*s+o,c=a-s;return new t(e._x*u+r._x*h+i._x*l+n._x*c,e._y*u+r._y*h+i._y*l+n._y*c,e._z*u+r._z*h+i._z*l+n._z*c)},t.Lerp=function(e,i,r){var n=new t(0,0,0);return t.LerpToRef(e,i,r,n),n},t.LerpToRef=function(t,e,i,r){r.x=t._x+(e._x-t._x)*i,r.y=t._y+(e._y-t._y)*i,r.z=t._z+(e._z-t._z)*i},t.Dot=function(t,e){return t._x*e._x+t._y*e._y+t._z*e._z},t.Cross=function(e,i){var r=t.Zero();return t.CrossToRef(e,i,r),r},t.CrossToRef=function(t,e,i){var r=t._y*e._z-t._z*e._y,n=t._z*e._x-t._x*e._z,o=t._x*e._y-t._y*e._x;i.copyFromFloats(r,n,o)},t.Normalize=function(e){var i=t.Zero();return t.NormalizeToRef(e,i),i},t.NormalizeToRef=function(t,e){t.normalizeToRef(e)},t.Project=function(e,i,r,n){var o=new t;return t.ProjectToRef(e,i,r,n,o),o},t.ProjectToRef=function(e,i,r,n,o){var s=n.width,a=n.height,u=n.x,h=n.y,l=vt.Matrix[1];yt.FromValuesToRef(s/2,0,0,0,0,-a/2,0,0,0,0,.5,0,u+s/2,a/2+h,.5,1,l);var c=vt.Matrix[0];return i.multiplyToRef(r,c),c.multiplyToRef(l,c),t.TransformCoordinatesToRef(e,c,o),o},t._UnprojectFromInvertedMatrixToRef=function(e,i,r){t.TransformCoordinatesToRef(e,i,r);var n=i.m,o=e._x*n[3]+e._y*n[7]+e._z*n[11]+n[15];ft.WithinEpsilon(o,1)&&r.scaleInPlace(1/o)},t.UnprojectFromTransform=function(e,i,r,n,o){var s=vt.Matrix[0];n.multiplyToRef(o,s),s.invert(),e.x=e._x/i*2-1,e.y=-(e._y/r*2-1);var a=new t;return t._UnprojectFromInvertedMatrixToRef(e,s,a),a},t.Unproject=function(e,i,r,n,o,s){var a=t.Zero();return t.UnprojectToRef(e,i,r,n,o,s,a),a},t.UnprojectToRef=function(e,i,r,n,o,s,a){t.UnprojectFloatsToRef(e._x,e._y,e._z,i,r,n,o,s,a)},t.UnprojectFloatsToRef=function(e,i,r,n,o,s,a,u,h){var l=vt.Matrix[0];s.multiplyToRef(a,l),l.multiplyToRef(u,l),l.invert();var c=vt.Vector3[0];c.x=e/n*2-1,c.y=-(i/o*2-1),c.z=2*r-1,t._UnprojectFromInvertedMatrixToRef(c,l,h)},t.Minimize=function(t,e){var i=t.clone();return i.minimizeInPlace(e),i},t.Maximize=function(t,e){var i=t.clone();return i.maximizeInPlace(e),i},t.Distance=function(e,i){return Math.sqrt(t.DistanceSquared(e,i))},t.DistanceSquared=function(t,e){var i=t._x-e._x,r=t._y-e._y,n=t._z-e._z;return i*i+r*r+n*n},t.Center=function(t,e){var i=t.add(e);return i.scaleInPlace(.5),i},t.RotationFromAxis=function(e,i,r){var n=t.Zero();return t.RotationFromAxisToRef(e,i,r,n),n},t.RotationFromAxisToRef=function(t,e,i,r){var n=vt.Quaternion[0];mt.RotationQuaternionFromAxisToRef(t,e,i,n),n.toEulerAnglesToRef(r)},t._UpReadOnly=t.Up(),t._ZeroReadOnly=t.Zero(),t}(),gt=function(){function t(t,e,i,r){this.x=t,this.y=e,this.z=i,this.w=r}return t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"},t.prototype.getClassName=function(){return"Vector4"},t.prototype.getHashCode=function(){var t=0|this.x;return t=397*(t=397*(t=397*t^(0|this.y))^(0|this.z))^(0|this.w)},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,this},t.prototype.fromArray=function(e,i){return void 0===i&&(i=0),t.FromArrayToRef(e,i,this),this},t.prototype.addInPlace=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)},t.prototype.addToRef=function(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,e.z=this.z+t.z,e.w=this.w+t.w,this},t.prototype.subtractInPlace=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this},t.prototype.subtract=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)},t.prototype.subtractToRef=function(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,e.z=this.z-t.z,e.w=this.w-t.w,this},t.prototype.subtractFromFloats=function(e,i,r,n){return new t(this.x-e,this.y-i,this.z-r,this.w-n)},t.prototype.subtractFromFloatsToRef=function(t,e,i,r,n){return n.x=this.x-t,n.y=this.y-e,n.z=this.z-i,n.w=this.w-r,this},t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z,-this.w)},t.prototype.negateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.w*=-1,this},t.prototype.negateToRef=function(t){return t.copyFromFloats(-1*this.x,-1*this.y,-1*this.z,-1*this.w)},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.prototype.scale=function(e){return new t(this.x*e,this.y*e,this.z*e,this.w*e)},t.prototype.scaleToRef=function(t,e){return e.x=this.x*t,e.y=this.y*t,e.z=this.z*t,e.w=this.w*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.x+=this.x*t,e.y+=this.y*t,e.z+=this.z*t,e.w+=this.w*t,this},t.prototype.equals=function(t){return t&&this.x===t.x&&this.y===t.y&&this.z===t.z&&this.w===t.w},t.prototype.equalsWithEpsilon=function(t,e){return void 0===e&&(e=.001),t&&ft.WithinEpsilon(this.x,t.x,e)&&ft.WithinEpsilon(this.y,t.y,e)&&ft.WithinEpsilon(this.z,t.z,e)&&ft.WithinEpsilon(this.w,t.w,e)},t.prototype.equalsToFloats=function(t,e,i,r){return this.x===t&&this.y===e&&this.z===i&&this.w===r},t.prototype.multiplyInPlace=function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this},t.prototype.multiply=function(e){return new t(this.x*e.x,this.y*e.y,this.z*e.z,this.w*e.w)},t.prototype.multiplyToRef=function(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,e.z=this.z*t.z,e.w=this.w*t.w,this},t.prototype.multiplyByFloats=function(e,i,r,n){return new t(this.x*e,this.y*i,this.z*r,this.w*n)},t.prototype.divide=function(e){return new t(this.x/e.x,this.y/e.y,this.z/e.z,this.w/e.w)},t.prototype.divideToRef=function(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,e.z=this.z/t.z,e.w=this.w/t.w,this},t.prototype.divideInPlace=function(t){return this.divideToRef(t,this)},t.prototype.minimizeInPlace=function(t){return t.x<this.x&&(this.x=t.x),t.y<this.y&&(this.y=t.y),t.z<this.z&&(this.z=t.z),t.w<this.w&&(this.w=t.w),this},t.prototype.maximizeInPlace=function(t){return t.x>this.x&&(this.x=t.x),t.y>this.y&&(this.y=t.y),t.z>this.z&&(this.z=t.z),t.w>this.w&&(this.w=t.w),this},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.prototype.normalize=function(){var t=this.length();return 0===t?this:this.scaleInPlace(1/t)},t.prototype.toVector3=function(){return new _t(this.x,this.y,this.z)},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},t.prototype.copyFromFloats=function(t,e,i,r){return this.x=t,this.y=e,this.z=i,this.w=r,this},t.prototype.set=function(t,e,i,r){return this.copyFromFloats(t,e,i,r)},t.prototype.setAll=function(t){return this.x=this.y=this.z=this.w=t,this},t.FromArray=function(e,i){return i||(i=0),new t(e[i],e[i+1],e[i+2],e[i+3])},t.FromArrayToRef=function(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2],i.w=t[e+3]},t.FromFloatArrayToRef=function(e,i,r){t.FromArrayToRef(e,i,r)},t.FromFloatsToRef=function(t,e,i,r,n){n.x=t,n.y=e,n.z=i,n.w=r},t.Zero=function(){return new t(0,0,0,0)},t.One=function(){return new t(1,1,1,1)},t.Normalize=function(e){var i=t.Zero();return t.NormalizeToRef(e,i),i},t.NormalizeToRef=function(t,e){e.copyFrom(t),e.normalize()},t.Minimize=function(t,e){var i=t.clone();return i.minimizeInPlace(e),i},t.Maximize=function(t,e){var i=t.clone();return i.maximizeInPlace(e),i},t.Distance=function(e,i){return Math.sqrt(t.DistanceSquared(e,i))},t.DistanceSquared=function(t,e){var i=t.x-e.x,r=t.y-e.y,n=t.z-e.z,o=t.w-e.w;return i*i+r*r+n*n+o*o},t.Center=function(t,e){var i=t.add(e);return i.scaleInPlace(.5),i},t.TransformNormal=function(e,i){var r=t.Zero();return t.TransformNormalToRef(e,i,r),r},t.TransformNormalToRef=function(t,e,i){var r=e.m,n=t.x*r[0]+t.y*r[4]+t.z*r[8],o=t.x*r[1]+t.y*r[5]+t.z*r[9],s=t.x*r[2]+t.y*r[6]+t.z*r[10];i.x=n,i.y=o,i.z=s,i.w=t.w},t.TransformNormalFromFloatsToRef=function(t,e,i,r,n,o){var s=n.m;o.x=t*s[0]+e*s[4]+i*s[8],o.y=t*s[1]+e*s[5]+i*s[9],o.z=t*s[2]+e*s[6]+i*s[10],o.w=r},t.FromVector3=function(e,i){return void 0===i&&(i=0),new t(e._x,e._y,e._z,i)},t}(),mt=function(){function t(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),this._isDirty=!0,this._x=t,this._y=e,this._z=i,this._w=r}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"z",{get:function(){return this._z},set:function(t){this._z=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"w",{get:function(){return this._w},set:function(t){this._w=t,this._isDirty=!0},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"{X: "+this._x+" Y:"+this._y+" Z:"+this._z+" W:"+this._w+"}"},t.prototype.getClassName=function(){return"Quaternion"},t.prototype.getHashCode=function(){var t=0|this._x;return t=397*(t=397*(t=397*t^(0|this._y))^(0|this._z))^(0|this._w)},t.prototype.asArray=function(){return[this._x,this._y,this._z,this._w]},t.prototype.equals=function(t){return t&&this._x===t._x&&this._y===t._y&&this._z===t._z&&this._w===t._w},t.prototype.equalsWithEpsilon=function(t,e){return void 0===e&&(e=.001),t&&ft.WithinEpsilon(this._x,t._x,e)&&ft.WithinEpsilon(this._y,t._y,e)&&ft.WithinEpsilon(this._z,t._z,e)&&ft.WithinEpsilon(this._w,t._w,e)},t.prototype.clone=function(){return new t(this._x,this._y,this._z,this._w)},t.prototype.copyFrom=function(t){return this.x=t._x,this.y=t._y,this.z=t._z,this.w=t._w,this},t.prototype.copyFromFloats=function(t,e,i,r){return this.x=t,this.y=e,this.z=i,this.w=r,this},t.prototype.set=function(t,e,i,r){return this.copyFromFloats(t,e,i,r)},t.prototype.add=function(e){return new t(this._x+e._x,this._y+e._y,this._z+e._z,this._w+e._w)},t.prototype.addInPlace=function(t){return this._x+=t._x,this._y+=t._y,this._z+=t._z,this._w+=t._w,this},t.prototype.subtract=function(e){return new t(this._x-e._x,this._y-e._y,this._z-e._z,this._w-e._w)},t.prototype.scale=function(e){return new t(this._x*e,this._y*e,this._z*e,this._w*e)},t.prototype.scaleToRef=function(t,e){return e.x=this._x*t,e.y=this._y*t,e.z=this._z*t,e.w=this._w*t,this},t.prototype.scaleInPlace=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.x+=this._x*t,e.y+=this._y*t,e.z+=this._z*t,e.w+=this._w*t,this},t.prototype.multiply=function(e){var i=new t(0,0,0,1);return this.multiplyToRef(e,i),i},t.prototype.multiplyToRef=function(t,e){var i=this._x*t._w+this._y*t._z-this._z*t._y+this._w*t._x,r=-this._x*t._z+this._y*t._w+this._z*t._x+this._w*t._y,n=this._x*t._y-this._y*t._x+this._z*t._w+this._w*t._z,o=-this._x*t._x-this._y*t._y-this._z*t._z+this._w*t._w;return e.copyFromFloats(i,r,n,o),this},t.prototype.multiplyInPlace=function(t){return this.multiplyToRef(t,this),this},t.prototype.conjugateToRef=function(t){return t.copyFromFloats(-this._x,-this._y,-this._z,this._w),this},t.prototype.conjugateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},t.prototype.conjugate=function(){return new t(-this._x,-this._y,-this._z,this._w)},t.prototype.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},t.prototype.normalize=function(){var t=this.length();if(0===t)return this;var e=1/t;return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},t.prototype.toEulerAngles=function(t){void 0===t&&(t="YZX");var e=_t.Zero();return this.toEulerAnglesToRef(e),e},t.prototype.toEulerAnglesToRef=function(t){var e=this._z,i=this._x,r=this._y,n=this._w,o=n*n,s=e*e,a=i*i,u=r*r,h=r*e-i*n;return h<-.4999999?(t.y=2*Math.atan2(r,n),t.x=Math.PI/2,t.z=0):h>.4999999?(t.y=2*Math.atan2(r,n),t.x=-Math.PI/2,t.z=0):(t.z=Math.atan2(2*(i*r+e*n),-s-a+u+o),t.x=Math.asin(-2*(e*r-i*n)),t.y=Math.atan2(2*(e*i+r*n),s-a-u+o)),this},t.prototype.toRotationMatrix=function(t){return yt.FromQuaternionToRef(this,t),this},t.prototype.fromRotationMatrix=function(e){return t.FromRotationMatrixToRef(e,this),this},t.FromRotationMatrix=function(e){var i=new t;return t.FromRotationMatrixToRef(e,i),i},t.FromRotationMatrixToRef=function(t,e){var i,r=t.m,n=r[0],o=r[4],s=r[8],a=r[1],u=r[5],h=r[9],l=r[2],c=r[6],f=r[10],d=n+u+f;d>0?(i=.5/Math.sqrt(d+1),e.w=.25/i,e.x=(c-h)*i,e.y=(s-l)*i,e.z=(a-o)*i):n>u&&n>f?(i=2*Math.sqrt(1+n-u-f),e.w=(c-h)/i,e.x=.25*i,e.y=(o+a)/i,e.z=(s+l)/i):u>f?(i=2*Math.sqrt(1+u-n-f),e.w=(s-l)/i,e.x=(o+a)/i,e.y=.25*i,e.z=(h+c)/i):(i=2*Math.sqrt(1+f-n-u),e.w=(a-o)/i,e.x=(s+l)/i,e.y=(h+c)/i,e.z=.25*i)},t.Dot=function(t,e){return t._x*e._x+t._y*e._y+t._z*e._z+t._w*e._w},t.AreClose=function(e,i){return t.Dot(e,i)>=0},t.Zero=function(){return new t(0,0,0,0)},t.Inverse=function(e){return new t(-e._x,-e._y,-e._z,e._w)},t.InverseToRef=function(t,e){return e.set(-t._x,-t._y,-t._z,t._w),e},t.Identity=function(){return new t(0,0,0,1)},t.IsIdentity=function(t){return t&&0===t._x&&0===t._y&&0===t._z&&1===t._w},t.RotationAxis=function(e,i){return t.RotationAxisToRef(e,i,new t)},t.RotationAxisToRef=function(t,e,i){var r=Math.sin(e/2);return t.normalize(),i.w=Math.cos(e/2),i.x=t._x*r,i.y=t._y*r,i.z=t._z*r,i},t.FromArray=function(e,i){return i||(i=0),new t(e[i],e[i+1],e[i+2],e[i+3])},t.FromArrayToRef=function(t,e,i){i.x=t[e],i.y=t[e+1],i.z=t[e+2],i.w=t[e+3]},t.FromEulerAngles=function(e,i,r){var n=new t;return t.RotationYawPitchRollToRef(i,e,r,n),n},t.FromEulerAnglesToRef=function(e,i,r,n){return t.RotationYawPitchRollToRef(i,e,r,n),n},t.FromEulerVector=function(e){var i=new t;return t.RotationYawPitchRollToRef(e._y,e._x,e._z,i),i},t.FromEulerVectorToRef=function(e,i){return t.RotationYawPitchRollToRef(e._y,e._x,e._z,i),i},t.RotationYawPitchRoll=function(e,i,r){var n=new t;return t.RotationYawPitchRollToRef(e,i,r,n),n},t.RotationYawPitchRollToRef=function(t,e,i,r){var n=.5*i,o=.5*e,s=.5*t,a=Math.sin(n),u=Math.cos(n),h=Math.sin(o),l=Math.cos(o),c=Math.sin(s),f=Math.cos(s);r.x=f*h*u+c*l*a,r.y=c*l*u-f*h*a,r.z=f*l*a-c*h*u,r.w=f*l*u+c*h*a},t.RotationAlphaBetaGamma=function(e,i,r){var n=new t;return t.RotationAlphaBetaGammaToRef(e,i,r,n),n},t.RotationAlphaBetaGammaToRef=function(t,e,i,r){var n=.5*(i+t),o=.5*(i-t),s=.5*e;r.x=Math.cos(o)*Math.sin(s),r.y=Math.sin(o)*Math.sin(s),r.z=Math.sin(n)*Math.cos(s),r.w=Math.cos(n)*Math.cos(s)},t.RotationQuaternionFromAxis=function(e,i,r){var n=new t(0,0,0,0);return t.RotationQuaternionFromAxisToRef(e,i,r,n),n},t.RotationQuaternionFromAxisToRef=function(e,i,r,n){var o=vt.Matrix[0];yt.FromXYZAxesToRef(e.normalize(),i.normalize(),r.normalize(),o),t.FromRotationMatrixToRef(o,n)},t.Slerp=function(e,i,r){var n=t.Identity();return t.SlerpToRef(e,i,r,n),n},t.SlerpToRef=function(t,e,i,r){var n,o,s=t._x*e._x+t._y*e._y+t._z*e._z+t._w*e._w,a=!1;if(s<0&&(a=!0,s=-s),s>.999999)o=1-i,n=a?-i:i;else{var u=Math.acos(s),h=1/Math.sin(u);o=Math.sin((1-i)*u)*h,n=a?-Math.sin(i*u)*h:Math.sin(i*u)*h}r.x=o*t._x+n*e._x,r.y=o*t._y+n*e._y,r.z=o*t._z+n*e._z,r.w=o*t._w+n*e._w},t.Hermite=function(e,i,r,n,o){var s=o*o,a=o*s,u=2*a-3*s+1,h=-2*a+3*s,l=a-2*s+o,c=a-s;return new t(e._x*u+r._x*h+i._x*l+n._x*c,e._y*u+r._y*h+i._y*l+n._y*c,e._z*u+r._z*h+i._z*l+n._z*c,e._w*u+r._w*h+i._w*l+n._w*c)},t}(),yt=function(){function t(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this.updateFlag=-1,q.MatrixTrackPrecisionChange&&q.MatrixTrackedMatrices.push(this),this._m=new q.MatrixCurrentType(16),this._updateIdentityStatus(!1)}return Object.defineProperty(t,"Use64Bits",{get:function(){return q.MatrixUse64Bits},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"m",{get:function(){return this._m},enumerable:!1,configurable:!0}),t.prototype._markAsUpdated=function(){this.updateFlag=t._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0},t.prototype._updateIdentityStatus=function(e,i,r,n){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===n&&(n=!0),this.updateFlag=t._updateFlagSeed++,this._isIdentity=e,this._isIdentity3x2=e||r,this._isIdentityDirty=!this._isIdentity&&i,this._isIdentity3x2Dirty=!this._isIdentity3x2&&n},t.prototype.isIdentity=function(){if(this._isIdentityDirty){this._isIdentityDirty=!1;var t=this._m;this._isIdentity=1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&1===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&1===t[10]&&0===t[11]&&0===t[12]&&0===t[13]&&0===t[14]&&1===t[15]}return this._isIdentity},t.prototype.isIdentityAs3x2=function(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2},t.prototype.determinant=function(){if(!0===this._isIdentity)return 1;var t=this._m,e=t[0],i=t[1],r=t[2],n=t[3],o=t[4],s=t[5],a=t[6],u=t[7],h=t[8],l=t[9],c=t[10],f=t[11],d=t[12],p=t[13],_=t[14],g=t[15],m=c*g-_*f,y=l*g-p*f,v=l*_-p*c,b=h*g-d*f,x=h*_-c*d,A=h*p-d*l;return e*+(s*m-a*y+u*v)+i*-(o*m-a*b+u*x)+r*+(o*y-s*b+u*A)+n*-(o*v-s*x+a*A)},t.prototype.toArray=function(){return this._m},t.prototype.asArray=function(){return this._m},t.prototype.invert=function(){return this.invertToRef(this),this},t.prototype.reset=function(){return t.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this},t.prototype.add=function(e){var i=new t;return this.addToRef(e,i),i},t.prototype.addToRef=function(t,e){for(var i=this._m,r=e._m,n=t.m,o=0;o<16;o++)r[o]=i[o]+n[o];return e._markAsUpdated(),this},t.prototype.addToSelf=function(t){for(var e=this._m,i=t.m,r=0;r<16;r++)e[r]+=i[r];return this._markAsUpdated(),this},t.prototype.invertToRef=function(e){if(!0===this._isIdentity)return t.IdentityToRef(e),this;var i=this._m,r=i[0],n=i[1],o=i[2],s=i[3],a=i[4],u=i[5],h=i[6],l=i[7],c=i[8],f=i[9],d=i[10],p=i[11],_=i[12],g=i[13],m=i[14],y=i[15],v=d*y-m*p,b=f*y-g*p,x=f*m-g*d,A=c*y-_*p,E=c*m-d*_,T=c*g-_*f,M=+(u*v-h*b+l*x),R=-(a*v-h*A+l*E),I=+(a*b-u*A+l*T),F=-(a*x-u*E+h*T),S=r*M+n*R+o*I+s*F;if(0===S)return e.copyFrom(this),this;var D=1/S,P=h*y-m*l,C=u*y-g*l,B=u*m-g*h,w=a*y-_*l,O=a*m-_*h,L=a*g-_*u,U=h*p-d*l,N=u*p-f*l,V=u*d-f*h,k=a*p-c*l,z=a*d-c*h,W=a*f-c*u,K=-(n*v-o*b+s*x),j=+(r*v-o*A+s*E),G=-(r*b-n*A+s*T),X=+(r*x-n*E+o*T),H=+(n*P-o*C+s*B),q=-(r*P-o*w+s*O),Y=+(r*C-n*w+s*L),Q=-(r*B-n*O+o*L),Z=-(n*U-o*N+s*V),J=+(r*U-o*k+s*z),$=-(r*N-n*k+s*W),tt=+(r*V-n*z+o*W);return t.FromValuesToRef(M*D,K*D,H*D,Z*D,R*D,j*D,q*D,J*D,I*D,G*D,Y*D,$*D,F*D,X*D,Q*D,tt*D,e),this},t.prototype.addAtIndex=function(t,e){return this._m[t]+=e,this._markAsUpdated(),this},t.prototype.multiplyAtIndex=function(t,e){return this._m[t]*=e,this._markAsUpdated(),this},t.prototype.setTranslationFromFloats=function(t,e,i){return this._m[12]=t,this._m[13]=e,this._m[14]=i,this._markAsUpdated(),this},t.prototype.addTranslationFromFloats=function(t,e,i){return this._m[12]+=t,this._m[13]+=e,this._m[14]+=i,this._markAsUpdated(),this},t.prototype.setTranslation=function(t){return this.setTranslationFromFloats(t._x,t._y,t._z)},t.prototype.getTranslation=function(){return new _t(this._m[12],this._m[13],this._m[14])},t.prototype.getTranslationToRef=function(t){return t.x=this._m[12],t.y=this._m[13],t.z=this._m[14],this},t.prototype.removeRotationAndScaling=function(){var e=this.m;return t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e[12],e[13],e[14],e[15],this),this._updateIdentityStatus(0===e[12]&&0===e[13]&&0===e[14]&&1===e[15]),this},t.prototype.multiply=function(e){var i=new t;return this.multiplyToRef(e,i),i},t.prototype.copyFrom=function(t){t.copyToArray(this._m);var e=t;return this._updateIdentityStatus(e._isIdentity,e._isIdentityDirty,e._isIdentity3x2,e._isIdentity3x2Dirty),this},t.prototype.copyToArray=function(t,e){void 0===e&&(e=0);var i=this._m;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],this},t.prototype.multiplyToRef=function(t,e){return this._isIdentity?(e.copyFrom(t),this):t._isIdentity?(e.copyFrom(this),this):(this.multiplyToArray(t,e._m,0),e._markAsUpdated(),this)},t.prototype.multiplyToArray=function(t,e,i){var r=this._m,n=t.m,o=r[0],s=r[1],a=r[2],u=r[3],h=r[4],l=r[5],c=r[6],f=r[7],d=r[8],p=r[9],_=r[10],g=r[11],m=r[12],y=r[13],v=r[14],b=r[15],x=n[0],A=n[1],E=n[2],T=n[3],M=n[4],R=n[5],I=n[6],F=n[7],S=n[8],D=n[9],P=n[10],C=n[11],B=n[12],w=n[13],O=n[14],L=n[15];return e[i]=o*x+s*M+a*S+u*B,e[i+1]=o*A+s*R+a*D+u*w,e[i+2]=o*E+s*I+a*P+u*O,e[i+3]=o*T+s*F+a*C+u*L,e[i+4]=h*x+l*M+c*S+f*B,e[i+5]=h*A+l*R+c*D+f*w,e[i+6]=h*E+l*I+c*P+f*O,e[i+7]=h*T+l*F+c*C+f*L,e[i+8]=d*x+p*M+_*S+g*B,e[i+9]=d*A+p*R+_*D+g*w,e[i+10]=d*E+p*I+_*P+g*O,e[i+11]=d*T+p*F+_*C+g*L,e[i+12]=m*x+y*M+v*S+b*B,e[i+13]=m*A+y*R+v*D+b*w,e[i+14]=m*E+y*I+v*P+b*O,e[i+15]=m*T+y*F+v*C+b*L,this},t.prototype.equals=function(t){var e=t;if(!e)return!1;if((this._isIdentity||e._isIdentity)&&!this._isIdentityDirty&&!e._isIdentityDirty)return this._isIdentity&&e._isIdentity;var i=this.m,r=e.m;return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]&&i[4]===r[4]&&i[5]===r[5]&&i[6]===r[6]&&i[7]===r[7]&&i[8]===r[8]&&i[9]===r[9]&&i[10]===r[10]&&i[11]===r[11]&&i[12]===r[12]&&i[13]===r[13]&&i[14]===r[14]&&i[15]===r[15]},t.prototype.clone=function(){var e=new t;return e.copyFrom(this),e},t.prototype.getClassName=function(){return"Matrix"},t.prototype.getHashCode=function(){for(var t=0|this._m[0],e=1;e<16;e++)t=397*t^(0|this._m[e]);return t},t.prototype.decompose=function(e,i,r){if(this._isIdentity)return r&&r.setAll(0),e&&e.setAll(1),i&&i.copyFromFloats(0,0,0,1),!0;var n=this._m;if(r&&r.copyFromFloats(n[12],n[13],n[14]),(e=e||vt.Vector3[0]).x=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]),e.y=Math.sqrt(n[4]*n[4]+n[5]*n[5]+n[6]*n[6]),e.z=Math.sqrt(n[8]*n[8]+n[9]*n[9]+n[10]*n[10]),this.determinant()<=0&&(e.y*=-1),0===e._x||0===e._y||0===e._z)return i&&i.copyFromFloats(0,0,0,1),!1;if(i){var o=1/e._x,s=1/e._y,a=1/e._z;t.FromValuesToRef(n[0]*o,n[1]*o,n[2]*o,0,n[4]*s,n[5]*s,n[6]*s,0,n[8]*a,n[9]*a,n[10]*a,0,0,0,0,1,vt.Matrix[0]),mt.FromRotationMatrixToRef(vt.Matrix[0],i)}return!0},t.prototype.getRow=function(t){if(t<0||t>3)return null;var e=4*t;return new gt(this._m[e+0],this._m[e+1],this._m[e+2],this._m[e+3])},t.prototype.setRow=function(t,e){return this.setRowFromFloats(t,e.x,e.y,e.z,e.w)},t.prototype.transpose=function(){return t.Transpose(this)},t.prototype.transposeToRef=function(e){return t.TransposeToRef(this,e),this},t.prototype.setRowFromFloats=function(t,e,i,r,n){if(t<0||t>3)return this;var o=4*t;return this._m[o+0]=e,this._m[o+1]=i,this._m[o+2]=r,this._m[o+3]=n,this._markAsUpdated(),this},t.prototype.scale=function(e){var i=new t;return this.scaleToRef(e,i),i},t.prototype.scaleToRef=function(t,e){for(var i=0;i<16;i++)e._m[i]=this._m[i]*t;return e._markAsUpdated(),this},t.prototype.scaleAndAddToRef=function(t,e){for(var i=0;i<16;i++)e._m[i]+=this._m[i]*t;return e._markAsUpdated(),this},t.prototype.toNormalMatrix=function(e){var i=vt.Matrix[0];this.invertToRef(i),i.transposeToRef(e);var r=e._m;t.FromValuesToRef(r[0],r[1],r[2],0,r[4],r[5],r[6],0,r[8],r[9],r[10],0,0,0,0,1,e)},t.prototype.getRotationMatrix=function(){var e=new t;return this.getRotationMatrixToRef(e),e},t.prototype.getRotationMatrixToRef=function(e){var i=vt.Vector3[0];if(!this.decompose(i))return t.IdentityToRef(e),this;var r=this._m,n=1/i._x,o=1/i._y,s=1/i._z;return t.FromValuesToRef(r[0]*n,r[1]*n,r[2]*n,0,r[4]*o,r[5]*o,r[6]*o,0,r[8]*s,r[9]*s,r[10]*s,0,0,0,0,1,e),this},t.prototype.toggleModelMatrixHandInPlace=function(){var t=this._m;t[2]*=-1,t[6]*=-1,t[8]*=-1,t[9]*=-1,t[14]*=-1,this._markAsUpdated()},t.prototype.toggleProjectionMatrixHandInPlace=function(){var t=this._m;t[8]*=-1,t[9]*=-1,t[10]*=-1,t[11]*=-1,this._markAsUpdated()},t.FromArray=function(e,i){void 0===i&&(i=0);var r=new t;return t.FromArrayToRef(e,i,r),r},t.FromArrayToRef=function(t,e,i){for(var r=0;r<16;r++)i._m[r]=t[r+e];i._markAsUpdated()},t.FromFloat32ArrayToRefScaled=function(t,e,i,r){for(var n=0;n<16;n++)r._m[n]=t[n+e]*i;r._markAsUpdated()},Object.defineProperty(t,"IdentityReadOnly",{get:function(){return t._identityReadOnly},enumerable:!1,configurable:!0}),t.FromValuesToRef=function(t,e,i,r,n,o,s,a,u,h,l,c,f,d,p,_,g){var m=g._m;m[0]=t,m[1]=e,m[2]=i,m[3]=r,m[4]=n,m[5]=o,m[6]=s,m[7]=a,m[8]=u,m[9]=h,m[10]=l,m[11]=c,m[12]=f,m[13]=d,m[14]=p,m[15]=_,g._markAsUpdated()},t.FromValues=function(e,i,r,n,o,s,a,u,h,l,c,f,d,p,_,g){var m=new t,y=m._m;return y[0]=e,y[1]=i,y[2]=r,y[3]=n,y[4]=o,y[5]=s,y[6]=a,y[7]=u,y[8]=h,y[9]=l,y[10]=c,y[11]=f,y[12]=d,y[13]=p,y[14]=_,y[15]=g,m._markAsUpdated(),m},t.Compose=function(e,i,r){var n=new t;return t.ComposeToRef(e,i,r,n),n},t.ComposeToRef=function(t,e,i,r){var n=r._m,o=e._x,s=e._y,a=e._z,u=e._w,h=o+o,l=s+s,c=a+a,f=o*h,d=o*l,p=o*c,_=s*l,g=s*c,m=a*c,y=u*h,v=u*l,b=u*c,x=t._x,A=t._y,E=t._z;n[0]=(1-(_+m))*x,n[1]=(d+b)*x,n[2]=(p-v)*x,n[3]=0,n[4]=(d-b)*A,n[5]=(1-(f+m))*A,n[6]=(g+y)*A,n[7]=0,n[8]=(p+v)*E,n[9]=(g-y)*E,n[10]=(1-(f+_))*E,n[11]=0,n[12]=i._x,n[13]=i._y,n[14]=i._z,n[15]=1,r._markAsUpdated()},t.Identity=function(){var e=t.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return e._updateIdentityStatus(!0),e},t.IdentityToRef=function(e){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,e),e._updateIdentityStatus(!0)},t.Zero=function(){var e=t.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return e._updateIdentityStatus(!1),e},t.RotationX=function(e){var i=new t;return t.RotationXToRef(e,i),i},t.Invert=function(e){var i=new t;return e.invertToRef(i),i},t.RotationXToRef=function(e,i){var r=Math.sin(e),n=Math.cos(e);t.FromValuesToRef(1,0,0,0,0,n,r,0,0,-r,n,0,0,0,0,1,i),i._updateIdentityStatus(1===n&&0===r)},t.RotationY=function(e){var i=new t;return t.RotationYToRef(e,i),i},t.RotationYToRef=function(e,i){var r=Math.sin(e),n=Math.cos(e);t.FromValuesToRef(n,0,-r,0,0,1,0,0,r,0,n,0,0,0,0,1,i),i._updateIdentityStatus(1===n&&0===r)},t.RotationZ=function(e){var i=new t;return t.RotationZToRef(e,i),i},t.RotationZToRef=function(e,i){var r=Math.sin(e),n=Math.cos(e);t.FromValuesToRef(n,r,0,0,-r,n,0,0,0,0,1,0,0,0,0,1,i),i._updateIdentityStatus(1===n&&0===r)},t.RotationAxis=function(e,i){var r=new t;return t.RotationAxisToRef(e,i,r),r},t.RotationAxisToRef=function(t,e,i){var r=Math.sin(-e),n=Math.cos(-e),o=1-n;t.normalize();var s=i._m;s[0]=t._x*t._x*o+n,s[1]=t._x*t._y*o-t._z*r,s[2]=t._x*t._z*o+t._y*r,s[3]=0,s[4]=t._y*t._x*o+t._z*r,s[5]=t._y*t._y*o+n,s[6]=t._y*t._z*o-t._x*r,s[7]=0,s[8]=t._z*t._x*o-t._y*r,s[9]=t._z*t._y*o+t._x*r,s[10]=t._z*t._z*o+n,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,i._markAsUpdated()},t.RotationAlignToRef=function(t,e,i){var r=_t.Cross(e,t),n=_t.Dot(e,t),o=1/(1+n),s=i._m;s[0]=r._x*r._x*o+n,s[1]=r._y*r._x*o-r._z,s[2]=r._z*r._x*o+r._y,s[3]=0,s[4]=r._x*r._y*o+r._z,s[5]=r._y*r._y*o+n,s[6]=r._z*r._y*o-r._x,s[7]=0,s[8]=r._x*r._z*o-r._y,s[9]=r._y*r._z*o+r._x,s[10]=r._z*r._z*o+n,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,i._markAsUpdated()},t.RotationYawPitchRoll=function(e,i,r){var n=new t;return t.RotationYawPitchRollToRef(e,i,r,n),n},t.RotationYawPitchRollToRef=function(t,e,i,r){mt.RotationYawPitchRollToRef(t,e,i,vt.Quaternion[0]),vt.Quaternion[0].toRotationMatrix(r)},t.Scaling=function(e,i,r){var n=new t;return t.ScalingToRef(e,i,r,n),n},t.ScalingToRef=function(e,i,r,n){t.FromValuesToRef(e,0,0,0,0,i,0,0,0,0,r,0,0,0,0,1,n),n._updateIdentityStatus(1===e&&1===i&&1===r)},t.Translation=function(e,i,r){var n=new t;return t.TranslationToRef(e,i,r,n),n},t.TranslationToRef=function(e,i,r,n){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,e,i,r,1,n),n._updateIdentityStatus(0===e&&0===i&&0===r)},t.Lerp=function(e,i,r){var n=new t;return t.LerpToRef(e,i,r,n),n},t.LerpToRef=function(t,e,i,r){for(var n=r._m,o=t.m,s=e.m,a=0;a<16;a++)n[a]=o[a]*(1-i)+s[a]*i;r._markAsUpdated()},t.DecomposeLerp=function(e,i,r){var n=new t;return t.DecomposeLerpToRef(e,i,r,n),n},t.DecomposeLerpToRef=function(e,i,r,n){var o=vt.Vector3[0],s=vt.Quaternion[0],a=vt.Vector3[1];e.decompose(o,s,a);var u=vt.Vector3[2],h=vt.Quaternion[1],l=vt.Vector3[3];i.decompose(u,h,l);var c=vt.Vector3[4];_t.LerpToRef(o,u,r,c);var f=vt.Quaternion[2];mt.SlerpToRef(s,h,r,f);var d=vt.Vector3[5];_t.LerpToRef(a,l,r,d),t.ComposeToRef(c,f,d,n)},t.LookAtLH=function(e,i,r){var n=new t;return t.LookAtLHToRef(e,i,r,n),n},t.LookAtLHToRef=function(e,i,r,n){var o=vt.Vector3[0],s=vt.Vector3[1],a=vt.Vector3[2];i.subtractToRef(e,a),a.normalize(),_t.CrossToRef(r,a,o);var u=o.lengthSquared();0===u?o.x=1:o.normalizeFromLength(Math.sqrt(u)),_t.CrossToRef(a,o,s),s.normalize();var h=-_t.Dot(o,e),l=-_t.Dot(s,e),c=-_t.Dot(a,e);t.FromValuesToRef(o._x,s._x,a._x,0,o._y,s._y,a._y,0,o._z,s._z,a._z,0,h,l,c,1,n)},t.LookAtRH=function(e,i,r){var n=new t;return t.LookAtRHToRef(e,i,r,n),n},t.LookAtRHToRef=function(e,i,r,n){var o=vt.Vector3[0],s=vt.Vector3[1],a=vt.Vector3[2];e.subtractToRef(i,a),a.normalize(),_t.CrossToRef(r,a,o);var u=o.lengthSquared();0===u?o.x=1:o.normalizeFromLength(Math.sqrt(u)),_t.CrossToRef(a,o,s),s.normalize();var h=-_t.Dot(o,e),l=-_t.Dot(s,e),c=-_t.Dot(a,e);t.FromValuesToRef(o._x,s._x,a._x,0,o._y,s._y,a._y,0,o._z,s._z,a._z,0,h,l,c,1,n)},t.OrthoLH=function(e,i,r,n){var o=new t;return t.OrthoLHToRef(e,i,r,n,o),o},t.OrthoLHToRef=function(e,i,r,n,o){var s=2/e,a=2/i,u=2/(n-r),h=-(n+r)/(n-r);t.FromValuesToRef(s,0,0,0,0,a,0,0,0,0,u,0,0,0,h,1,o),o._updateIdentityStatus(1===s&&1===a&&1===u&&0===h)},t.OrthoOffCenterLH=function(e,i,r,n,o,s){var a=new t;return t.OrthoOffCenterLHToRef(e,i,r,n,o,s,a),a},t.OrthoOffCenterLHToRef=function(e,i,r,n,o,s,a){var u=2/(i-e),h=2/(n-r),l=2/(s-o),c=-(s+o)/(s-o),f=(e+i)/(e-i),d=(n+r)/(r-n);t.FromValuesToRef(u,0,0,0,0,h,0,0,0,0,l,0,f,d,c,1,a),a._markAsUpdated()},t.OrthoOffCenterRH=function(e,i,r,n,o,s){var a=new t;return t.OrthoOffCenterRHToRef(e,i,r,n,o,s,a),a},t.OrthoOffCenterRHToRef=function(e,i,r,n,o,s,a){t.OrthoOffCenterLHToRef(e,i,r,n,o,s,a),a._m[10]*=-1},t.PerspectiveLH=function(e,i,r,n){var o=new t,s=2*r/e,a=2*r/i,u=(n+r)/(n-r),h=-2*n*r/(n-r);return t.FromValuesToRef(s,0,0,0,0,a,0,0,0,0,u,1,0,0,h,0,o),o._updateIdentityStatus(!1),o},t.PerspectiveFovLH=function(e,i,r,n){var o=new t;return t.PerspectiveFovLHToRef(e,i,r,n,o),o},t.PerspectiveFovLHToRef=function(e,i,r,n,o,s){void 0===s&&(s=!0);var a=r,u=n,h=1/Math.tan(.5*e),l=s?h/i:h,c=s?h:h*i,f=(u+a)/(u-a),d=-2*u*a/(u-a);t.FromValuesToRef(l,0,0,0,0,c,0,0,0,0,f,1,0,0,d,0,o),o._updateIdentityStatus(!1)},t.PerspectiveFovReverseLHToRef=function(e,i,r,n,o,s){void 0===s&&(s=!0);var a=1/Math.tan(.5*e),u=s?a/i:a,h=s?a:a*i;t.FromValuesToRef(u,0,0,0,0,h,0,0,0,0,-r,1,0,0,1,0,o),o._updateIdentityStatus(!1)},t.PerspectiveFovRH=function(e,i,r,n){var o=new t;return t.PerspectiveFovRHToRef(e,i,r,n,o),o},t.PerspectiveFovRHToRef=function(e,i,r,n,o,s){void 0===s&&(s=!0);var a=r,u=n,h=1/Math.tan(.5*e),l=s?h/i:h,c=s?h:h*i,f=-(u+a)/(u-a),d=-2*u*a/(u-a);t.FromValuesToRef(l,0,0,0,0,c,0,0,0,0,f,-1,0,0,d,0,o),o._updateIdentityStatus(!1)},t.PerspectiveFovReverseRHToRef=function(e,i,r,n,o,s){void 0===s&&(s=!0);var a=1/Math.tan(.5*e),u=s?a/i:a,h=s?a:a*i;t.FromValuesToRef(u,0,0,0,0,h,0,0,0,0,-r,-1,0,0,-1,0,o),o._updateIdentityStatus(!1)},t.PerspectiveFovWebVRToRef=function(t,e,i,r,n){void 0===n&&(n=!1);var o=n?-1:1,s=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),u=Math.tan(t.leftDegrees*Math.PI/180),h=Math.tan(t.rightDegrees*Math.PI/180),l=2/(u+h),c=2/(s+a),f=r._m;f[0]=l,f[1]=f[2]=f[3]=f[4]=0,f[5]=c,f[6]=f[7]=0,f[8]=(u-h)*l*.5,f[9]=-(s-a)*c*.5,f[10]=-i/(e-i),f[11]=1*o,f[12]=f[13]=f[15]=0,f[14]=-2*i*e/(i-e),r._markAsUpdated()},t.GetFinalMatrix=function(e,i,r,n,o,s){var a=e.width,u=e.height,h=e.x,l=e.y,c=t.FromValues(a/2,0,0,0,0,-u/2,0,0,0,0,s-o,0,h+a/2,u/2+l,o,1),f=vt.Matrix[0];return i.multiplyToRef(r,f),f.multiplyToRef(n,f),f.multiply(c)},t.GetAsMatrix2x2=function(t){var e=t.m,i=[e[0],e[1],e[4],e[5]];return q.MatrixUse64Bits?i:new Float32Array(i)},t.GetAsMatrix3x3=function(t){var e=t.m,i=[e[0],e[1],e[2],e[4],e[5],e[6],e[8],e[9],e[10]];return q.MatrixUse64Bits?i:new Float32Array(i)},t.Transpose=function(e){var i=new t;return t.TransposeToRef(e,i),i},t.TransposeToRef=function(t,e){var i=e._m,r=t.m;i[0]=r[0],i[1]=r[4],i[2]=r[8],i[3]=r[12],i[4]=r[1],i[5]=r[5],i[6]=r[9],i[7]=r[13],i[8]=r[2],i[9]=r[6],i[10]=r[10],i[11]=r[14],i[12]=r[3],i[13]=r[7],i[14]=r[11],i[15]=r[15],e._updateIdentityStatus(t._isIdentity,t._isIdentityDirty)},t.Reflection=function(e){var i=new t;return t.ReflectionToRef(e,i),i},t.ReflectionToRef=function(e,i){e.normalize();var r=e.normal.x,n=e.normal.y,o=e.normal.z,s=-2*r,a=-2*n,u=-2*o;t.FromValuesToRef(s*r+1,a*r,u*r,0,s*n,a*n+1,u*n,0,s*o,a*o,u*o+1,0,s*e.d,a*e.d,u*e.d,1,i)},t.FromXYZAxesToRef=function(e,i,r,n){t.FromValuesToRef(e._x,e._y,e._z,0,i._x,i._y,i._z,0,r._x,r._y,r._z,0,0,0,0,1,n)},t.FromQuaternionToRef=function(t,e){var i=t._x*t._x,r=t._y*t._y,n=t._z*t._z,o=t._x*t._y,s=t._z*t._w,a=t._z*t._x,u=t._y*t._w,h=t._y*t._z,l=t._x*t._w;e._m[0]=1-2*(r+n),e._m[1]=2*(o+s),e._m[2]=2*(a-u),e._m[3]=0,e._m[4]=2*(o-s),e._m[5]=1-2*(n+i),e._m[6]=2*(h+l),e._m[7]=0,e._m[8]=2*(a+u),e._m[9]=2*(h-l),e._m[10]=1-2*(r+i),e._m[11]=0,e._m[12]=0,e._m[13]=0,e._m[14]=0,e._m[15]=1,e._markAsUpdated()},t._updateFlagSeed=0,t._identityReadOnly=t.Identity(),t}(),vt=function(){function t(){}return t.Vector3=dt.BuildArray(6,_t.Zero),t.Matrix=dt.BuildArray(2,yt.Identity),t.Quaternion=dt.BuildArray(3,mt.Zero),t}(),bt=function(){function t(){}return t.Vector2=dt.BuildArray(3,pt.Zero),t.Vector3=dt.BuildArray(13,_t.Zero),t.Vector4=dt.BuildArray(3,gt.Zero),t.Quaternion=dt.BuildArray(2,mt.Zero),t.Matrix=dt.BuildArray(8,yt.Identity),t}();ot.RegisteredTypes["BABYLON.Vector2"]=pt,ot.RegisteredTypes["BABYLON.Vector3"]=_t,ot.RegisteredTypes["BABYLON.Vector4"]=gt,ot.RegisteredTypes["BABYLON.Matrix"]=yt;var xt=function(){function t(t,e,i){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),this.r=t,this.g=e,this.b=i}return t.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"},t.prototype.getClassName=function(){return"Color3"},t.prototype.getHashCode=function(){var t=255*this.r|0;return t=397*(t=397*t^(255*this.g|0))^(255*this.b|0)},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,this},t.prototype.fromArray=function(e,i){return void 0===i&&(i=0),t.FromArrayToRef(e,i,this),this},t.prototype.toColor4=function(t){return void 0===t&&(t=1),new At(this.r,this.g,this.b,t)},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.toLuminance=function(){return.3*this.r+.59*this.g+.11*this.b},t.prototype.multiply=function(e){return new t(this.r*e.r,this.g*e.g,this.b*e.b)},t.prototype.multiplyToRef=function(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,this},t.prototype.equals=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b},t.prototype.equalsFloats=function(t,e,i){return this.r===t&&this.g===e&&this.b===i},t.prototype.scale=function(e){return new t(this.r*e,this.g*e,this.b*e)},t.prototype.scaleToRef=function(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,this},t.prototype.clampToRef=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=1),i.r=ft.Clamp(this.r,t,e),i.g=ft.Clamp(this.g,t,e),i.b=ft.Clamp(this.b,t,e),this},t.prototype.add=function(e){return new t(this.r+e.r,this.g+e.g,this.b+e.b)},t.prototype.addToRef=function(t,e){return e.r=this.r+t.r,e.g=this.g+t.g,e.b=this.b+t.b,this},t.prototype.subtract=function(e){return new t(this.r-e.r,this.g-e.g,this.b-e.b)},t.prototype.subtractToRef=function(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,this},t.prototype.clone=function(){return new t(this.r,this.g,this.b)},t.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},t.prototype.copyFromFloats=function(t,e,i){return this.r=t,this.g=e,this.b=i,this},t.prototype.set=function(t,e,i){return this.copyFromFloats(t,e,i)},t.prototype.toHexString=function(){var t=255*this.r|0,e=255*this.g|0,i=255*this.b|0;return"#"+ft.ToHex(t)+ft.ToHex(e)+ft.ToHex(i)},t.prototype.toLinearSpace=function(){var e=new t;return this.toLinearSpaceToRef(e),e},t.prototype.toHSV=function(){var e=new t;return this.toHSVToRef(e),e},t.prototype.toHSVToRef=function(t){var e=this.r,i=this.g,r=this.b,n=Math.max(e,i,r),o=Math.min(e,i,r),s=0,a=0,u=n,h=n-o;0!==n&&(a=h/n),n!=o&&(n==e?(s=(i-r)/h,i<r&&(s+=6)):n==i?s=(r-e)/h+2:n==r&&(s=(e-i)/h+4),s*=60),t.r=s,t.g=a,t.b=u},t.prototype.toLinearSpaceToRef=function(t){return t.r=Math.pow(this.r,2.2),t.g=Math.pow(this.g,2.2),t.b=Math.pow(this.b,2.2),this},t.prototype.toGammaSpace=function(){var e=new t;return this.toGammaSpaceToRef(e),e},t.prototype.toGammaSpaceToRef=function(t){return t.r=Math.pow(this.r,1/2.2),t.g=Math.pow(this.g,1/2.2),t.b=Math.pow(this.b,1/2.2),this},t.HSVtoRGBToRef=function(t,e,i,r){var n=i*e,o=t/60,s=n*(1-Math.abs(o%2-1)),a=0,u=0,h=0;o>=0&&o<=1?(a=n,u=s):o>=1&&o<=2?(a=s,u=n):o>=2&&o<=3?(u=n,h=s):o>=3&&o<=4?(u=s,h=n):o>=4&&o<=5?(a=s,h=n):o>=5&&o<=6&&(a=n,h=s);var l=i-n;r.set(a+l,u+l,h+l)},t.FromHexString=function(e){if("#"!==e.substring(0,1)||7!==e.length)return new t(0,0,0);var i=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),n=parseInt(e.substring(5,7),16);return t.FromInts(i,r,n)},t.FromArray=function(e,i){return void 0===i&&(i=0),new t(e[i],e[i+1],e[i+2])},t.FromArrayToRef=function(t,e,i){void 0===e&&(e=0),i.r=t[e],i.g=t[e+1],i.b=t[e+2]},t.FromInts=function(e,i,r){return new t(e/255,i/255,r/255)},t.Lerp=function(e,i,r){var n=new t(0,0,0);return t.LerpToRef(e,i,r,n),n},t.LerpToRef=function(t,e,i,r){r.r=t.r+(e.r-t.r)*i,r.g=t.g+(e.g-t.g)*i,r.b=t.b+(e.b-t.b)*i},t.Red=function(){return new t(1,0,0)},t.Green=function(){return new t(0,1,0)},t.Blue=function(){return new t(0,0,1)},t.Black=function(){return new t(0,0,0)},Object.defineProperty(t,"BlackReadOnly",{get:function(){return t._BlackReadOnly},enumerable:!1,configurable:!0}),t.White=function(){return new t(1,1,1)},t.Purple=function(){return new t(.5,0,.5)},t.Magenta=function(){return new t(1,0,1)},t.Yellow=function(){return new t(1,1,0)},t.Gray=function(){return new t(.5,.5,.5)},t.Teal=function(){return new t(0,1,1)},t.Random=function(){return new t(Math.random(),Math.random(),Math.random())},t._BlackReadOnly=t.Black(),t}(),At=function(){function t(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),this.r=t,this.g=e,this.b=i,this.a=r}return t.prototype.addInPlace=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this},t.prototype.asArray=function(){var t=new Array;return this.toArray(t,0),t},t.prototype.toArray=function(t,e){return void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t[e+3]=this.a,this},t.prototype.fromArray=function(e,i){return void 0===i&&(i=0),t.FromArrayToRef(e,i,this),this},t.prototype.equals=function(t){return t&&this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a},t.prototype.add=function(e){return new t(this.r+e.r,this.g+e.g,this.b+e.b,this.a+e.a)},t.prototype.subtract=function(e){return new t(this.r-e.r,this.g-e.g,this.b-e.b,this.a-e.a)},t.prototype.subtractToRef=function(t,e){return e.r=this.r-t.r,e.g=this.g-t.g,e.b=this.b-t.b,e.a=this.a-t.a,this},t.prototype.scale=function(e){return new t(this.r*e,this.g*e,this.b*e,this.a*e)},t.prototype.scaleToRef=function(t,e){return e.r=this.r*t,e.g=this.g*t,e.b=this.b*t,e.a=this.a*t,this},t.prototype.scaleAndAddToRef=function(t,e){return e.r+=this.r*t,e.g+=this.g*t,e.b+=this.b*t,e.a+=this.a*t,this},t.prototype.clampToRef=function(t,e,i){return void 0===t&&(t=0),void 0===e&&(e=1),i.r=ft.Clamp(this.r,t,e),i.g=ft.Clamp(this.g,t,e),i.b=ft.Clamp(this.b,t,e),i.a=ft.Clamp(this.a,t,e),this},t.prototype.multiply=function(e){return new t(this.r*e.r,this.g*e.g,this.b*e.b,this.a*e.a)},t.prototype.multiplyToRef=function(t,e){return e.r=this.r*t.r,e.g=this.g*t.g,e.b=this.b*t.b,e.a=this.a*t.a,e},t.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"},t.prototype.getClassName=function(){return"Color4"},t.prototype.getHashCode=function(){var t=255*this.r|0;return t=397*(t=397*(t=397*t^(255*this.g|0))^(255*this.b|0))^(255*this.a|0)},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},t.prototype.copyFrom=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this},t.prototype.copyFromFloats=function(t,e,i,r){return this.r=t,this.g=e,this.b=i,this.a=r,this},t.prototype.set=function(t,e,i,r){return this.copyFromFloats(t,e,i,r)},t.prototype.toHexString=function(t){void 0===t&&(t=!1);var e=255*this.r|0,i=255*this.g|0,r=255*this.b|0;if(t)return"#"+ft.ToHex(e)+ft.ToHex(i)+ft.ToHex(r);var n=255*this.a|0;return"#"+ft.ToHex(e)+ft.ToHex(i)+ft.ToHex(r)+ft.ToHex(n)},t.prototype.toLinearSpace=function(){var e=new t;return this.toLinearSpaceToRef(e),e},t.prototype.toLinearSpaceToRef=function(t){return t.r=Math.pow(this.r,2.2),t.g=Math.pow(this.g,2.2),t.b=Math.pow(this.b,2.2),t.a=this.a,this},t.prototype.toGammaSpace=function(){var e=new t;return this.toGammaSpaceToRef(e),e},t.prototype.toGammaSpaceToRef=function(t){return t.r=Math.pow(this.r,1/2.2),t.g=Math.pow(this.g,1/2.2),t.b=Math.pow(this.b,1/2.2),t.a=this.a,this},t.FromHexString=function(e){if("#"!==e.substring(0,1)||9!==e.length)return new t(0,0,0,0);var i=parseInt(e.substring(1,3),16),r=parseInt(e.substring(3,5),16),n=parseInt(e.substring(5,7),16),o=parseInt(e.substring(7,9),16);return t.FromInts(i,r,n,o)},t.Lerp=function(e,i,r){var n=new t(0,0,0,0);return t.LerpToRef(e,i,r,n),n},t.LerpToRef=function(t,e,i,r){r.r=t.r+(e.r-t.r)*i,r.g=t.g+(e.g-t.g)*i,r.b=t.b+(e.b-t.b)*i,r.a=t.a+(e.a-t.a)*i},t.FromColor3=function(e,i){return void 0===i&&(i=1),new t(e.r,e.g,e.b,i)},t.FromArray=function(e,i){return void 0===i&&(i=0),new t(e[i],e[i+1],e[i+2],e[i+3])},t.FromArrayToRef=function(t,e,i){void 0===e&&(e=0),i.r=t[e],i.g=t[e+1],i.b=t[e+2],i.a=t[e+3]},t.FromInts=function(e,i,r,n){return new t(e/255,i/255,r/255,n/255)},t.CheckColors4=function(t,e){if(t.length===3*e){for(var i=[],r=0;r<t.length;r+=3){var n=r/3*4;i[n]=t[r],i[n+1]=t[r+1],i[n+2]=t[r+2],i[n+3]=1}return i}return t},t}();!function(){function t(){}t.Color3=dt.BuildArray(3,xt.Black),t.Color4=dt.BuildArray(3,(function(){return new At(0,0,0,0)}))}();ot.RegisteredTypes["BABYLON.Color3"]=xt,ot.RegisteredTypes["BABYLON.Color4"]=At;var Et={},Tt={},Mt=function(t,e,i){var r=t();ct&&ct.AddTagsTo(r,e.tags);var n=Rt(r);for(var o in n){var s=n[o],a=e[o],u=s.type;if(null!=a&&"uniqueId"!==o)switch(u){case 0:case 6:case 11:r[o]=a;break;case 1:r[o]=i||a.isRenderTarget?a:a.clone();break;case 2:case 3:case 4:case 5:case 7:case 10:case 12:r[o]=i?a:a.clone()}}return r};function Rt(t){var e=t.getClassName();if(Tt[e])return Tt[e];Tt[e]={};for(var i=Tt[e],r=t,n=e;n;){var o=Et[n];for(var s in o)i[s]=o[s];var a=void 0,u=!1;do{if(!(a=Object.getPrototypeOf(r)).getClassName){u=!0;break}if(a.getClassName()!==n)break;r=a}while(a);if(u)break;n=a.getClassName(),r=a}return i}function It(t,e){return function(i,r){var n=function(t){var e=t.getClassName();return Et[e]||(Et[e]={}),Et[e]}(i);n[r]||(n[r]={type:t,sourceName:e})}}function Ft(t){return It(0,t)}function St(t){return It(5,t)}var Dt=function(){function t(){}return t.AppendSerializedAnimations=function(t,e){if(t.animations){e.animations=[];for(var i=0;i<t.animations.length;i++){var r=t.animations[i];e.animations.push(r.serialize())}}},t.Serialize=function(t,e){e||(e={}),ct&&(e.tags=ct.GetTags(t));var i=Rt(t);for(var r in i){var n=i[r],o=n.sourceName||r,s=n.type,a=t[r];if(null!=a&&"uniqueId"!==r)switch(s){case 0:e[o]=a;break;case 1:e[o]=a.serialize();break;case 2:e[o]=a.asArray();break;case 3:e[o]=a.serialize();break;case 4:case 5:e[o]=a.asArray();break;case 6:e[o]=a.id;break;case 7:e[o]=a.serialize();break;case 8:e[o]=a.asArray();break;case 9:e[o]=a.serialize();break;case 10:e[o]=a.asArray();break;case 11:e[o]=a.id;case 12:e[o]=a.asArray()}}return e},t.Parse=function(e,i,r,n){void 0===n&&(n=null);var o=e();n||(n=""),ct&&ct.AddTagsTo(o,i.tags);var s=Rt(o);for(var a in s){var u=s[a],h=i[u.sourceName||a],l=u.type;if(null!=h&&"uniqueId"!==a){var c=o;switch(l){case 0:c[a]=h;break;case 1:r&&(c[a]=t._TextureParser(h,r,n));break;case 2:c[a]=xt.FromArray(h);break;case 3:c[a]=t._FresnelParametersParser(h);break;case 4:c[a]=pt.FromArray(h);break;case 5:c[a]=_t.FromArray(h);break;case 6:r&&(c[a]=r.getLastMeshByID(h));break;case 7:c[a]=t._ColorCurvesParser(h);break;case 8:c[a]=At.FromArray(h);break;case 9:c[a]=t._ImageProcessingConfigurationParser(h);break;case 10:c[a]=mt.FromArray(h);break;case 11:r&&(c[a]=r.getCameraByID(h));case 12:c[a]=yt.FromArray(h)}}}return o},t.Clone=function(t,e){return Mt(t,e,!1)},t.Instanciate=function(t,e){return Mt(t,e,!0)},t._ImageProcessingConfigurationParser=function(t){throw m.WarnImport("ImageProcessingConfiguration")},t._FresnelParametersParser=function(t){throw m.WarnImport("FresnelParameters")},t._ColorCurvesParser=function(t){throw m.WarnImport("ColorCurves")},t._TextureParser=function(t,e,i){throw m.WarnImport("Texture")},t}(),Pt=function(){function t(t,e){void 0===e&&(e=null),this.state="",this.metadata=null,this.reservedDataStore=null,this._doNotSerialize=!1,this._isDisposed=!1,this.animations=new Array,this._ranges={},this.onReady=null,this._isEnabled=!0,this._isParentEnabled=!0,this._isReady=!0,this._currentRenderId=-1,this._parentUpdateId=-1,this._childUpdateId=-1,this._waitingParentId=null,this._cache={},this._parentNode=null,this._children=null,this._worldMatrix=yt.Identity(),this._worldMatrixDeterminant=0,this._worldMatrixDeterminantIsDirty=!0,this._sceneRootNodesIndex=-1,this._animationPropertiesOverride=null,this._isNode=!0,this.onDisposeObservable=new l,this._onDisposeObserver=null,this._behaviors=new Array,this.name=t,this.id=t,this._scene=e||b.LastCreatedScene,this.uniqueId=this._scene.getUniqueId(),this._initCache()}return t.AddNodeConstructor=function(t,e){this._NodeConstructors[t]=e},t.Construct=function(t,e,i,r){var n=this._NodeConstructors[t];return n?n(e,i,r):null},Object.defineProperty(t.prototype,"doNotSerialize",{get:function(){return!!this._doNotSerialize||!!this._parentNode&&this._parentNode.doNotSerialize},set:function(t){this._doNotSerialize=t},enumerable:!1,configurable:!0}),t.prototype.isDisposed=function(){return this._isDisposed},Object.defineProperty(t.prototype,"parent",{get:function(){return this._parentNode},set:function(t){if(this._parentNode!==t){var e=this._parentNode;if(this._parentNode&&void 0!==this._parentNode._children&&null!==this._parentNode._children){var i=this._parentNode._children.indexOf(this);-1!==i&&this._parentNode._children.splice(i,1),t||this._isDisposed||this._addToSceneRootNodes()}this._parentNode=t,this._parentNode&&(void 0!==this._parentNode._children&&null!==this._parentNode._children||(this._parentNode._children=new Array),this._parentNode._children.push(this),e||this._removeFromSceneRootNodes()),this._syncParentEnabledState()}},enumerable:!1,configurable:!0}),t.prototype._addToSceneRootNodes=function(){-1===this._sceneRootNodesIndex&&(this._sceneRootNodesIndex=this._scene.rootNodes.length,this._scene.rootNodes.push(this))},t.prototype._removeFromSceneRootNodes=function(){if(-1!==this._sceneRootNodesIndex){var t=this._scene.rootNodes,e=t.length-1;t[this._sceneRootNodesIndex]=t[e],t[this._sceneRootNodesIndex]._sceneRootNodesIndex=this._sceneRootNodesIndex,this._scene.rootNodes.pop(),this._sceneRootNodesIndex=-1}},Object.defineProperty(t.prototype,"animationPropertiesOverride",{get:function(){return this._animationPropertiesOverride?this._animationPropertiesOverride:this._scene.animationPropertiesOverride},set:function(t){this._animationPropertiesOverride=t},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return"Node"},Object.defineProperty(t.prototype,"onDispose",{set:function(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)},enumerable:!1,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype.getEngine=function(){return this._scene.getEngine()},t.prototype.addBehavior=function(t,e){var i=this;return void 0===e&&(e=!1),-1!==this._behaviors.indexOf(t)||(t.init(),this._scene.isLoading&&!e?this._scene.onDataLoadedObservable.addOnce((function(){t.attach(i)})):t.attach(this),this._behaviors.push(t)),this},t.prototype.removeBehavior=function(t){var e=this._behaviors.indexOf(t);return-1===e||(this._behaviors[e].detach(),this._behaviors.splice(e,1)),this},Object.defineProperty(t.prototype,"behaviors",{get:function(){return this._behaviors},enumerable:!1,configurable:!0}),t.prototype.getBehaviorByName=function(t){for(var e=0,i=this._behaviors;e<i.length;e++){var r=i[e];if(r.name===t)return r}return null},t.prototype.getWorldMatrix=function(){return this._currentRenderId!==this._scene.getRenderId()&&this.computeWorldMatrix(),this._worldMatrix},t.prototype._getWorldMatrixDeterminant=function(){return this._worldMatrixDeterminantIsDirty&&(this._worldMatrixDeterminantIsDirty=!1,this._worldMatrixDeterminant=this._worldMatrix.determinant()),this._worldMatrixDeterminant},Object.defineProperty(t.prototype,"worldMatrixFromCache",{get:function(){return this._worldMatrix},enumerable:!1,configurable:!0}),t.prototype._initCache=function(){this._cache={},this._cache.parent=void 0},t.prototype.updateCache=function(t){!t&&this.isSynchronized()||(this._cache.parent=this.parent,this._updateCache())},t.prototype._getActionManagerForTrigger=function(t,e){return void 0===e&&(e=!0),this.parent?this.parent._getActionManagerForTrigger(t,!1):null},t.prototype._updateCache=function(t){},t.prototype._isSynchronized=function(){return!0},t.prototype._markSyncedWithParent=function(){this._parentNode&&(this._parentUpdateId=this._parentNode._childUpdateId)},t.prototype.isSynchronizedWithParent=function(){return!this._parentNode||this._parentUpdateId===this._parentNode._childUpdateId&&this._parentNode.isSynchronized()},t.prototype.isSynchronized=function(){return this._cache.parent!=this._parentNode?(this._cache.parent=this._parentNode,!1):!(this._parentNode&&!this.isSynchronizedWithParent())&&this._isSynchronized()},t.prototype.isReady=function(t){return void 0===t&&(t=!1),this._isReady},t.prototype.isEnabled=function(t){return void 0===t&&(t=!0),!1===t?this._isEnabled:!!this._isEnabled&&this._isParentEnabled},t.prototype._syncParentEnabledState=function(){this._isParentEnabled=!this._parentNode||this._parentNode.isEnabled(),this._children&&this._children.forEach((function(t){t._syncParentEnabledState()}))},t.prototype.setEnabled=function(t){this._isEnabled=t,this._syncParentEnabledState()},t.prototype.isDescendantOf=function(t){return!!this.parent&&(this.parent===t||this.parent.isDescendantOf(t))},t.prototype._getDescendants=function(t,e,i){if(void 0===e&&(e=!1),this._children)for(var r=0;r<this._children.length;r++){var n=this._children[r];i&&!i(n)||t.push(n),e||n._getDescendants(t,!1,i)}},t.prototype.getDescendants=function(t,e){var i=new Array;return this._getDescendants(i,t,e),i},t.prototype.getChildMeshes=function(t,e){var i=[];return this._getDescendants(i,t,(function(t){return(!e||e(t))&&void 0!==t.cullingStrategy})),i},t.prototype.getChildren=function(t,e){return void 0===e&&(e=!0),this.getDescendants(e,t)},t.prototype._setReady=function(t){t!==this._isReady&&(t?(this.onReady&&this.onReady(this),this._isReady=!0):this._isReady=!1)},t.prototype.getAnimationByName=function(t){for(var e=0;e<this.animations.length;e++){var i=this.animations[e];if(i.name===t)return i}return null},t.prototype.createAnimationRange=function(e,i,r){if(!this._ranges[e]){this._ranges[e]=t._AnimationRangeFactory(e,i,r);for(var n=0,o=this.animations.length;n<o;n++)this.animations[n]&&this.animations[n].createRange(e,i,r)}},t.prototype.deleteAnimationRange=function(t,e){void 0===e&&(e=!0);for(var i=0,r=this.animations.length;i<r;i++)this.animations[i]&&this.animations[i].deleteRange(t,e);this._ranges[t]=null},t.prototype.getAnimationRange=function(t){return this._ranges[t]||null},t.prototype.getAnimationRanges=function(){var t,e=[];for(t in this._ranges)e.push(this._ranges[t]);return e},t.prototype.beginAnimation=function(t,e,i,r){var n=this.getAnimationRange(t);return n?this._scene.beginAnimation(this,n.from,n.to,e,i,r):null},t.prototype.serializeAnimationRanges=function(){var t=[];for(var e in this._ranges){var i=this._ranges[e];if(i){var r={};r.name=e,r.from=i.from,r.to=i.to,t.push(r)}}return t},t.prototype.computeWorldMatrix=function(t){return this._worldMatrix||(this._worldMatrix=yt.Identity()),this._worldMatrix},t.prototype.dispose=function(t,e){if(void 0===e&&(e=!1),this._isDisposed=!0,!t)for(var i=0,r=this.getDescendants(!0);i<r.length;i++){r[i].dispose(t,e)}this.parent?this.parent=null:this._removeFromSceneRootNodes(),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear();for(var n=0,o=this._behaviors;n<o.length;n++){o[n].detach()}this._behaviors=[]},t.ParseAnimationRanges=function(t,e,i){if(e.ranges)for(var r=0;r<e.ranges.length;r++){var n=e.ranges[r];t.createAnimationRange(n.name,n.from,n.to)}},t.prototype.getHierarchyBoundingVectors=function(t,e){var i,r;void 0===t&&(t=!0),void 0===e&&(e=null),this.getScene().incrementRenderId(),this.computeWorldMatrix(!0);if(this.getBoundingInfo&&this.subMeshes){var n=this.getBoundingInfo();i=n.boundingBox.minimumWorld.clone(),r=n.boundingBox.maximumWorld.clone()}else i=new _t(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),r=new _t(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);if(t)for(var o=0,s=this.getDescendants(!1);o<s.length;o++){var a=s[o];if(a.computeWorldMatrix(!0),(!e||e(a))&&a.getBoundingInfo&&0!==a.getTotalVertices()){var u=a.getBoundingInfo().boundingBox,h=u.minimumWorld,l=u.maximumWorld;_t.CheckExtends(h,i,r),_t.CheckExtends(l,i,r)}}return{min:i,max:r}},t._AnimationRangeFactory=function(t,e,i){throw m.WarnImport("AnimationRange")},t._NodeConstructors={},s([Ft()],t.prototype,"name",void 0),s([Ft()],t.prototype,"id",void 0),s([Ft()],t.prototype,"uniqueId",void 0),s([Ft()],t.prototype,"state",void 0),s([Ft()],t.prototype,"metadata",void 0),t}(),Ct=function(){function t(t,e,i,r,n,o,s,a){void 0===r&&(r=0),void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===s&&(s=!1),this._isAlreadyOwned=!1,t.getScene?this._engine=t.getScene().getEngine():this._engine=t,this._updatable=i,this._instanced=o,this._divisor=a||1,this._data=e,this.byteStride=s?r:r*Float32Array.BYTES_PER_ELEMENT,n||this.create()}return t.prototype.createVertexBuffer=function(t,e,i,r,n,o,s){void 0===o&&(o=!1);var a=o?e:e*Float32Array.BYTES_PER_ELEMENT,u=r?o?r:r*Float32Array.BYTES_PER_ELEMENT:this.byteStride;return new Bt(this._engine,this,t,this._updatable,!0,u,void 0===n?this._instanced:n,a,i,void 0,void 0,!0,this._divisor||s)},t.prototype.isUpdatable=function(){return this._updatable},t.prototype.getData=function(){return this._data},t.prototype.getBuffer=function(){return this._buffer},t.prototype.getStrideSize=function(){return this.byteStride/Float32Array.BYTES_PER_ELEMENT},t.prototype.create=function(t){void 0===t&&(t=null),!t&&this._buffer||(t=t||this._data)&&(this._buffer?this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,t),this._data=t):this._updatable?(this._buffer=this._engine.createDynamicVertexBuffer(t),this._data=t):this._buffer=this._engine.createVertexBuffer(t))},t.prototype._rebuild=function(){this._buffer=null,this.create(this._data)},t.prototype.update=function(t){this.create(t)},t.prototype.updateDirectly=function(t,e,i,r){void 0===r&&(r=!1),this._buffer&&this._updatable&&(this._engine.updateDynamicVertexBuffer(this._buffer,t,r?e:e*Float32Array.BYTES_PER_ELEMENT,i?i*this.byteStride:void 0),this._data=null)},t.prototype._increaseReferences=function(){this._buffer&&(this._isAlreadyOwned?this._buffer.references++:this._isAlreadyOwned=!0)},t.prototype.dispose=function(){this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)},t}(),Bt=function(){function t(e,i,r,n,o,s,a,u,h,l,c,f,d,p){if(void 0===c&&(c=!1),void 0===f&&(f=!1),void 0===d&&(d=1),void 0===p&&(p=!1),i instanceof Ct?(this._buffer=i,this._ownsBuffer=p,p&&this._buffer._increaseReferences()):(this._buffer=new Ct(e,i,n,s,o,a,f),this._ownsBuffer=!0),this._kind=r,null==l){var _=this.getData();this.type=t.FLOAT,_ instanceof Int8Array?this.type=t.BYTE:_ instanceof Uint8Array?this.type=t.UNSIGNED_BYTE:_ instanceof Int16Array?this.type=t.SHORT:_ instanceof Uint16Array?this.type=t.UNSIGNED_SHORT:_ instanceof Int32Array?this.type=t.INT:_ instanceof Uint32Array&&(this.type=t.UNSIGNED_INT)}else this.type=l;var g=t.GetTypeByteLength(this.type);f?(this._size=h||(s?s/g:t.DeduceStride(r)),this.byteStride=s||this._buffer.byteStride||this._size*g,this.byteOffset=u||0):(this._size=h||s||t.DeduceStride(r),this.byteStride=s?s*g:this._buffer.byteStride||this._size*g,this.byteOffset=(u||0)*g),this.normalized=c,this._instanced=void 0!==a&&a,this._instanceDivisor=a?d:0}return Object.defineProperty(t.prototype,"instanceDivisor",{get:function(){return this._instanceDivisor},set:function(t){this._instanceDivisor=t,this._instanced=0!=t},enumerable:!1,configurable:!0}),t.prototype._rebuild=function(){this._buffer&&this._buffer._rebuild()},t.prototype.getKind=function(){return this._kind},t.prototype.isUpdatable=function(){return this._buffer.isUpdatable()},t.prototype.getData=function(){return this._buffer.getData()},t.prototype.getBuffer=function(){return this._buffer.getBuffer()},t.prototype.getStrideSize=function(){return this.byteStride/t.GetTypeByteLength(this.type)},t.prototype.getOffset=function(){return this.byteOffset/t.GetTypeByteLength(this.type)},t.prototype.getSize=function(){return this._size},t.prototype.getIsInstanced=function(){return this._instanced},t.prototype.getInstanceDivisor=function(){return this._instanceDivisor},t.prototype.create=function(t){this._buffer.create(t)},t.prototype.update=function(t){this._buffer.update(t)},t.prototype.updateDirectly=function(t,e,i){void 0===i&&(i=!1),this._buffer.updateDirectly(t,e,void 0,i)},t.prototype.dispose=function(){this._ownsBuffer&&this._buffer.dispose()},t.prototype.forEach=function(e,i){t.ForEach(this._buffer.getData(),this.byteOffset,this.byteStride,this._size,this.type,e,this.normalized,i)},t.DeduceStride=function(e){switch(e){case t.UVKind:case t.UV2Kind:case t.UV3Kind:case t.UV4Kind:case t.UV5Kind:case t.UV6Kind:return 2;case t.NormalKind:case t.PositionKind:return 3;case t.ColorKind:case t.MatricesIndicesKind:case t.MatricesIndicesExtraKind:case t.MatricesWeightsKind:case t.MatricesWeightsExtraKind:case t.TangentKind:return 4;default:throw new Error("Invalid kind '"+e+"'")}},t.GetTypeByteLength=function(e){switch(e){case t.BYTE:case t.UNSIGNED_BYTE:return 1;case t.SHORT:case t.UNSIGNED_SHORT:return 2;case t.INT:case t.UNSIGNED_INT:case t.FLOAT:return 4;default:throw new Error("Invalid type '"+e+"'")}},t.ForEach=function(e,i,r,n,o,s,a,u){if(e instanceof Array)for(var h=i/4,l=r/4,c=0;c<s;c+=n){for(var f=0;f<n;f++)u(e[h+f],c+f);h+=l}else{var d=e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),p=t.GetTypeByteLength(o);for(c=0;c<s;c+=n){var _=i;for(f=0;f<n;f++){u(t._GetFloatValue(d,o,_,a),c+f),_+=p}i+=r}}},t._GetFloatValue=function(e,i,r,n){switch(i){case t.BYTE:var o=e.getInt8(r);return n&&(o=Math.max(o/127,-1)),o;case t.UNSIGNED_BYTE:o=e.getUint8(r);return n&&(o/=255),o;case t.SHORT:o=e.getInt16(r,!0);return n&&(o=Math.max(o/32767,-1)),o;case t.UNSIGNED_SHORT:o=e.getUint16(r,!0);return n&&(o/=65535),o;case t.INT:return e.getInt32(r,!0);case t.UNSIGNED_INT:return e.getUint32(r,!0);case t.FLOAT:return e.getFloat32(r,!0);default:throw new Error("Invalid component type "+i)}},t.BYTE=5120,t.UNSIGNED_BYTE=5121,t.SHORT=5122,t.UNSIGNED_SHORT=5123,t.INT=5124,t.UNSIGNED_INT=5125,t.FLOAT=5126,t.PositionKind="position",t.NormalKind="normal",t.TangentKind="tangent",t.UVKind="uv",t.UV2Kind="uv2",t.UV3Kind="uv3",t.UV4Kind="uv4",t.UV5Kind="uv5",t.UV6Kind="uv6",t.ColorKind="color",t.MatricesIndicesKind="matricesIndices",t.MatricesWeightsKind="matricesWeights",t.MatricesIndicesExtraKind="matricesIndicesExtra",t.MatricesWeightsExtraKind="matricesWeightsExtra",t}(),wt=function(){function t(){}return t.prototype.set=function(t,e){switch(t.length||f.Warn("Setting vertex data kind '"+e+"' with an empty array"),e){case Bt.PositionKind:this.positions=t;break;case Bt.NormalKind:this.normals=t;break;case Bt.TangentKind:this.tangents=t;break;case Bt.UVKind:this.uvs=t;break;case Bt.UV2Kind:this.uvs2=t;break;case Bt.UV3Kind:this.uvs3=t;break;case Bt.UV4Kind:this.uvs4=t;break;case Bt.UV5Kind:this.uvs5=t;break;case Bt.UV6Kind:this.uvs6=t;break;case Bt.ColorKind:this.colors=t;break;case Bt.MatricesIndicesKind:this.matricesIndices=t;break;case Bt.MatricesWeightsKind:this.matricesWeights=t;break;case Bt.MatricesIndicesExtraKind:this.matricesIndicesExtra=t;break;case Bt.MatricesWeightsExtraKind:this.matricesWeightsExtra=t}},t.prototype.applyToMesh=function(t,e){return this._applyTo(t,e),this},t.prototype.applyToGeometry=function(t,e){return this._applyTo(t,e),this},t.prototype.updateMesh=function(t){return this._update(t),this},t.prototype.updateGeometry=function(t){return this._update(t),this},t.prototype._applyTo=function(t,e){return void 0===e&&(e=!1),this.positions&&t.setVerticesData(Bt.PositionKind,this.positions,e),this.normals&&t.setVerticesData(Bt.NormalKind,this.normals,e),this.tangents&&t.setVerticesData(Bt.TangentKind,this.tangents,e),this.uvs&&t.setVerticesData(Bt.UVKind,this.uvs,e),this.uvs2&&t.setVerticesData(Bt.UV2Kind,this.uvs2,e),this.uvs3&&t.setVerticesData(Bt.UV3Kind,this.uvs3,e),this.uvs4&&t.setVerticesData(Bt.UV4Kind,this.uvs4,e),this.uvs5&&t.setVerticesData(Bt.UV5Kind,this.uvs5,e),this.uvs6&&t.setVerticesData(Bt.UV6Kind,this.uvs6,e),this.colors&&t.setVerticesData(Bt.ColorKind,this.colors,e),this.matricesIndices&&t.setVerticesData(Bt.MatricesIndicesKind,this.matricesIndices,e),this.matricesWeights&&t.setVerticesData(Bt.MatricesWeightsKind,this.matricesWeights,e),this.matricesIndicesExtra&&t.setVerticesData(Bt.MatricesIndicesExtraKind,this.matricesIndicesExtra,e),this.matricesWeightsExtra&&t.setVerticesData(Bt.MatricesWeightsExtraKind,this.matricesWeightsExtra,e),this.indices?t.setIndices(this.indices,null,e):t.setIndices([],null),this},t.prototype._update=function(t,e,i){return this.positions&&t.updateVerticesData(Bt.PositionKind,this.positions,e,i),this.normals&&t.updateVerticesData(Bt.NormalKind,this.normals,e,i),this.tangents&&t.updateVerticesData(Bt.TangentKind,this.tangents,e,i),this.uvs&&t.updateVerticesData(Bt.UVKind,this.uvs,e,i),this.uvs2&&t.updateVerticesData(Bt.UV2Kind,this.uvs2,e,i),this.uvs3&&t.updateVerticesData(Bt.UV3Kind,this.uvs3,e,i),this.uvs4&&t.updateVerticesData(Bt.UV4Kind,this.uvs4,e,i),this.uvs5&&t.updateVerticesData(Bt.UV5Kind,this.uvs5,e,i),this.uvs6&&t.updateVerticesData(Bt.UV6Kind,this.uvs6,e,i),this.colors&&t.updateVerticesData(Bt.ColorKind,this.colors,e,i),this.matricesIndices&&t.updateVerticesData(Bt.MatricesIndicesKind,this.matricesIndices,e,i),this.matricesWeights&&t.updateVerticesData(Bt.MatricesWeightsKind,this.matricesWeights,e,i),this.matricesIndicesExtra&&t.updateVerticesData(Bt.MatricesIndicesExtraKind,this.matricesIndicesExtra,e,i),this.matricesWeightsExtra&&t.updateVerticesData(Bt.MatricesWeightsExtraKind,this.matricesWeightsExtra,e,i),this.indices&&t.setIndices(this.indices,null),this},t.prototype.transform=function(t){var e,i=t.determinant()<0,r=_t.Zero();if(this.positions){var n=_t.Zero();for(e=0;e<this.positions.length;e+=3)_t.FromArrayToRef(this.positions,e,n),_t.TransformCoordinatesToRef(n,t,r),this.positions[e]=r.x,this.positions[e+1]=r.y,this.positions[e+2]=r.z}if(this.normals){var o=_t.Zero();for(e=0;e<this.normals.length;e+=3)_t.FromArrayToRef(this.normals,e,o),_t.TransformNormalToRef(o,t,r),this.normals[e]=r.x,this.normals[e+1]=r.y,this.normals[e+2]=r.z}if(this.tangents){var s=gt.Zero(),a=gt.Zero();for(e=0;e<this.tangents.length;e+=4)gt.FromArrayToRef(this.tangents,e,s),gt.TransformNormalToRef(s,t,a),this.tangents[e]=a.x,this.tangents[e+1]=a.y,this.tangents[e+2]=a.z,this.tangents[e+3]=a.w}if(i&&this.indices)for(e=0;e<this.indices.length;e+=3){var u=this.indices[e+1];this.indices[e+1]=this.indices[e+2],this.indices[e+2]=u}return this},t.prototype.merge=function(t,e){if(void 0===e&&(e=!1),this._validate(),t._validate(),!this.normals!=!t.normals||!this.tangents!=!t.tangents||!this.uvs!=!t.uvs||!this.uvs2!=!t.uvs2||!this.uvs3!=!t.uvs3||!this.uvs4!=!t.uvs4||!this.uvs5!=!t.uvs5||!this.uvs6!=!t.uvs6||!this.colors!=!t.colors||!this.matricesIndices!=!t.matricesIndices||!this.matricesWeights!=!t.matricesWeights||!this.matricesIndicesExtra!=!t.matricesIndicesExtra||!this.matricesWeightsExtra!=!t.matricesWeightsExtra)throw new Error("Cannot merge vertex data that do not have the same set of attributes");if(t.indices){this.indices||(this.indices=[]);var i=this.positions?this.positions.length/3:0;if(void 0!==this.indices.BYTES_PER_ELEMENT){var r=this.indices.length+t.indices.length,n=e||this.indices instanceof Uint32Array?new Uint32Array(r):new Uint16Array(r);n.set(this.indices);for(var o=this.indices.length,s=0;s<t.indices.length;s++)n[o+s]=t.indices[s]+i;this.indices=n}else for(s=0;s<t.indices.length;s++)this.indices.push(t.indices[s]+i)}return this.positions=this._mergeElement(this.positions,t.positions),this.normals=this._mergeElement(this.normals,t.normals),this.tangents=this._mergeElement(this.tangents,t.tangents),this.uvs=this._mergeElement(this.uvs,t.uvs),this.uvs2=this._mergeElement(this.uvs2,t.uvs2),this.uvs3=this._mergeElement(this.uvs3,t.uvs3),this.uvs4=this._mergeElement(this.uvs4,t.uvs4),this.uvs5=this._mergeElement(this.uvs5,t.uvs5),this.uvs6=this._mergeElement(this.uvs6,t.uvs6),this.colors=this._mergeElement(this.colors,t.colors),this.matricesIndices=this._mergeElement(this.matricesIndices,t.matricesIndices),this.matricesWeights=this._mergeElement(this.matricesWeights,t.matricesWeights),this.matricesIndicesExtra=this._mergeElement(this.matricesIndicesExtra,t.matricesIndicesExtra),this.matricesWeightsExtra=this._mergeElement(this.matricesWeightsExtra,t.matricesWeightsExtra),this},t.prototype._mergeElement=function(t,e){if(!t)return e;if(!e)return t;var i=e.length+t.length,r=t instanceof Float32Array,n=e instanceof Float32Array;if(r){var o=new Float32Array(i);return o.set(t),o.set(e,t.length),o}if(n){var s=t.slice(0),a=0;for(i=e.length;a<i;a++)s.push(e[a]);return s}return t.concat(e)},t.prototype._validate=function(){if(!this.positions)throw new Error("Positions are required");var t=function(t,e){var i=Bt.DeduceStride(t);if(e.length%i!=0)throw new Error("The "+t+"s array count must be a multiple of "+i);return e.length/i},e=t(Bt.PositionKind,this.positions),i=function(i,r){var n=t(i,r);if(n!==e)throw new Error("The "+i+"s element count ("+n+") does not match the positions count ("+e+")")};this.normals&&i(Bt.NormalKind,this.normals),this.tangents&&i(Bt.TangentKind,this.tangents),this.uvs&&i(Bt.UVKind,this.uvs),this.uvs2&&i(Bt.UV2Kind,this.uvs2),this.uvs3&&i(Bt.UV3Kind,this.uvs3),this.uvs4&&i(Bt.UV4Kind,this.uvs4),this.uvs5&&i(Bt.UV5Kind,this.uvs5),this.uvs6&&i(Bt.UV6Kind,this.uvs6),this.colors&&i(Bt.ColorKind,this.colors),this.matricesIndices&&i(Bt.MatricesIndicesKind,this.matricesIndices),this.matricesWeights&&i(Bt.MatricesWeightsKind,this.matricesWeights),this.matricesIndicesExtra&&i(Bt.MatricesIndicesExtraKind,this.matricesIndicesExtra),this.matricesWeightsExtra&&i(Bt.MatricesWeightsExtraKind,this.matricesWeightsExtra)},t.prototype.serialize=function(){var t=this.serialize();return this.positions&&(t.positions=this.positions),this.normals&&(t.normals=this.normals),this.tangents&&(t.tangents=this.tangents),this.uvs&&(t.uvs=this.uvs),this.uvs2&&(t.uvs2=this.uvs2),this.uvs3&&(t.uvs3=this.uvs3),this.uvs4&&(t.uvs4=this.uvs4),this.uvs5&&(t.uvs5=this.uvs5),this.uvs6&&(t.uvs6=this.uvs6),this.colors&&(t.colors=this.colors),this.matricesIndices&&(t.matricesIndices=this.matricesIndices,t.matricesIndices._isExpanded=!0),this.matricesWeights&&(t.matricesWeights=this.matricesWeights),this.matricesIndicesExtra&&(t.matricesIndicesExtra=this.matricesIndicesExtra,t.matricesIndicesExtra._isExpanded=!0),this.matricesWeightsExtra&&(t.matricesWeightsExtra=this.matricesWeightsExtra),t.indices=this.indices,t},t.ExtractFromMesh=function(e,i,r){return t._ExtractFrom(e,i,r)},t.ExtractFromGeometry=function(e,i,r){return t._ExtractFrom(e,i,r)},t._ExtractFrom=function(e,i,r){var n=new t;return e.isVerticesDataPresent(Bt.PositionKind)&&(n.positions=e.getVerticesData(Bt.PositionKind,i,r)),e.isVerticesDataPresent(Bt.NormalKind)&&(n.normals=e.getVerticesData(Bt.NormalKind,i,r)),e.isVerticesDataPresent(Bt.TangentKind)&&(n.tangents=e.getVerticesData(Bt.TangentKind,i,r)),e.isVerticesDataPresent(Bt.UVKind)&&(n.uvs=e.getVerticesData(Bt.UVKind,i,r)),e.isVerticesDataPresent(Bt.UV2Kind)&&(n.uvs2=e.getVerticesData(Bt.UV2Kind,i,r)),e.isVerticesDataPresent(Bt.UV3Kind)&&(n.uvs3=e.getVerticesData(Bt.UV3Kind,i,r)),e.isVerticesDataPresent(Bt.UV4Kind)&&(n.uvs4=e.getVerticesData(Bt.UV4Kind,i,r)),e.isVerticesDataPresent(Bt.UV5Kind)&&(n.uvs5=e.getVerticesData(Bt.UV5Kind,i,r)),e.isVerticesDataPresent(Bt.UV6Kind)&&(n.uvs6=e.getVerticesData(Bt.UV6Kind,i,r)),e.isVerticesDataPresent(Bt.ColorKind)&&(n.colors=e.getVerticesData(Bt.ColorKind,i,r)),e.isVerticesDataPresent(Bt.MatricesIndicesKind)&&(n.matricesIndices=e.getVerticesData(Bt.MatricesIndicesKind,i,r)),e.isVerticesDataPresent(Bt.MatricesWeightsKind)&&(n.matricesWeights=e.getVerticesData(Bt.MatricesWeightsKind,i,r)),e.isVerticesDataPresent(Bt.MatricesIndicesExtraKind)&&(n.matricesIndicesExtra=e.getVerticesData(Bt.MatricesIndicesExtraKind,i,r)),e.isVerticesDataPresent(Bt.MatricesWeightsExtraKind)&&(n.matricesWeightsExtra=e.getVerticesData(Bt.MatricesWeightsExtraKind,i,r)),n.indices=e.getIndices(i,r),n},t.CreateRibbon=function(t){throw m.WarnImport("ribbonBuilder")},t.CreateBox=function(t){throw m.WarnImport("boxBuilder")},t.CreateTiledBox=function(t){throw m.WarnImport("tiledBoxBuilder")},t.CreateTiledPlane=function(t){throw m.WarnImport("tiledPlaneBuilder")},t.CreateSphere=function(t){throw m.WarnImport("sphereBuilder")},t.CreateCylinder=function(t){throw m.WarnImport("cylinderBuilder")},t.CreateTorus=function(t){throw m.WarnImport("torusBuilder")},t.CreateLineSystem=function(t){throw m.WarnImport("linesBuilder")},t.CreateDashedLines=function(t){throw m.WarnImport("linesBuilder")},t.CreateGround=function(t){throw m.WarnImport("groundBuilder")},t.CreateTiledGround=function(t){throw m.WarnImport("groundBuilder")},t.CreateGroundFromHeightMap=function(t){throw m.WarnImport("groundBuilder")},t.CreatePlane=function(t){throw m.WarnImport("planeBuilder")},t.CreateDisc=function(t){throw m.WarnImport("discBuilder")},t.CreatePolygon=function(t,e,i,r,n,o,s){throw m.WarnImport("polygonBuilder")},t.CreateIcoSphere=function(t){throw m.WarnImport("icoSphereBuilder")},t.CreatePolyhedron=function(t){throw m.WarnImport("polyhedronBuilder")},t.CreateCapsule=function(t){throw void 0===t&&(t={orientation:_t.Up(),subdivisions:2,tessellation:16,height:1,radius:.25,capSubdivisions:6}),m.WarnImport("capsuleBuilder")},t.CreateTorusKnot=function(t){throw m.WarnImport("torusKnotBuilder")},t.ComputeNormals=function(t,e,i,r){var n=0,o=0,s=0,a=0,u=0,h=0,l=0,c=0,f=0,d=0,p=0,_=0,g=0,m=0,y=0,v=0,b=0,x=0,A=0,E=0,T=!1,M=!1,R=!1,I=!1,F=1,S=0,D=null;if(r&&(T=!!r.facetNormals,M=!!r.facetPositions,R=!!r.facetPartitioning,F=!0===r.useRightHandedSystem?-1:1,S=r.ratio||0,I=!!r.depthSort,D=r.distanceTo,I)){void 0===D&&(D=_t.Zero());var P=r.depthSortedFacets}var C=0,B=0,w=0,O=0;if(R&&r&&r.bbSize){var L=0,U=0,N=0,V=0,k=0,z=0,W=0,K=0,j=0,G=0,X=0,H=0,q=0,Y=0,Q=0,Z=0,J=r.bbSize.x>r.bbSize.y?r.bbSize.x:r.bbSize.y;J=J>r.bbSize.z?J:r.bbSize.z,C=r.subDiv.X*S/r.bbSize.x,B=r.subDiv.Y*S/r.bbSize.y,w=r.subDiv.Z*S/r.bbSize.z,O=r.subDiv.max*r.subDiv.max,r.facetPartitioning.length=0}for(n=0;n<t.length;n++)i[n]=0;var $=e.length/3|0;for(n=0;n<$;n++){if(g=(_=3*e[3*n])+1,m=_+2,v=(y=3*e[3*n+1])+1,b=y+2,A=(x=3*e[3*n+2])+1,E=x+2,o=t[_]-t[y],s=t[g]-t[v],a=t[m]-t[b],u=t[x]-t[y],h=t[A]-t[v],c=F*(s*(l=t[E]-t[b])-a*h),f=F*(a*u-o*l),d=F*(o*h-s*u),c/=p=0===(p=Math.sqrt(c*c+f*f+d*d))?1:p,f/=p,d/=p,T&&r&&(r.facetNormals[n].x=c,r.facetNormals[n].y=f,r.facetNormals[n].z=d),M&&r&&(r.facetPositions[n].x=(t[_]+t[y]+t[x])/3,r.facetPositions[n].y=(t[g]+t[v]+t[A])/3,r.facetPositions[n].z=(t[m]+t[b]+t[E])/3),R&&r&&(L=Math.floor((r.facetPositions[n].x-r.bInfo.minimum.x*S)*C),U=Math.floor((r.facetPositions[n].y-r.bInfo.minimum.y*S)*B),N=Math.floor((r.facetPositions[n].z-r.bInfo.minimum.z*S)*w),V=Math.floor((t[_]-r.bInfo.minimum.x*S)*C),k=Math.floor((t[g]-r.bInfo.minimum.y*S)*B),z=Math.floor((t[m]-r.bInfo.minimum.z*S)*w),W=Math.floor((t[y]-r.bInfo.minimum.x*S)*C),K=Math.floor((t[v]-r.bInfo.minimum.y*S)*B),j=Math.floor((t[b]-r.bInfo.minimum.z*S)*w),G=Math.floor((t[x]-r.bInfo.minimum.x*S)*C),X=Math.floor((t[A]-r.bInfo.minimum.y*S)*B),H=Math.floor((t[E]-r.bInfo.minimum.z*S)*w),Y=V+r.subDiv.max*k+O*z,Q=W+r.subDiv.max*K+O*j,Z=G+r.subDiv.max*X+O*H,q=L+r.subDiv.max*U+O*N,r.facetPartitioning[q]=r.facetPartitioning[q]?r.facetPartitioning[q]:new Array,r.facetPartitioning[Y]=r.facetPartitioning[Y]?r.facetPartitioning[Y]:new Array,r.facetPartitioning[Q]=r.facetPartitioning[Q]?r.facetPartitioning[Q]:new Array,r.facetPartitioning[Z]=r.facetPartitioning[Z]?r.facetPartitioning[Z]:new Array,r.facetPartitioning[Y].push(n),Q!=Y&&r.facetPartitioning[Q].push(n),Z!=Q&&Z!=Y&&r.facetPartitioning[Z].push(n),q!=Y&&q!=Q&&q!=Z&&r.facetPartitioning[q].push(n)),I&&r&&r.facetPositions){var tt=P[n];tt.ind=3*n,tt.sqDistance=_t.DistanceSquared(r.facetPositions[n],D)}i[_]+=c,i[g]+=f,i[m]+=d,i[y]+=c,i[v]+=f,i[b]+=d,i[x]+=c,i[A]+=f,i[E]+=d}for(n=0;n<i.length/3;n++)c=i[3*n],f=i[3*n+1],d=i[3*n+2],c/=p=0===(p=Math.sqrt(c*c+f*f+d*d))?1:p,f/=p,d/=p,i[3*n]=c,i[3*n+1]=f,i[3*n+2]=d},t._ComputeSides=function(e,i,r,n,o,s,a){var u,h,l=r.length,c=n.length;switch(e=e||t.DEFAULTSIDE){case t.FRONTSIDE:break;case t.BACKSIDE:var f;for(u=0;u<l;u+=3)f=r[u],r[u]=r[u+2],r[u+2]=f;for(h=0;h<c;h++)n[h]=-n[h];break;case t.DOUBLESIDE:for(var d=i.length,p=d/3,_=0;_<d;_++)i[d+_]=i[_];for(u=0;u<l;u+=3)r[u+l]=r[u+2]+p,r[u+1+l]=r[u+1]+p,r[u+2+l]=r[u]+p;for(h=0;h<c;h++)n[c+h]=-n[h];var g=o.length,m=0;for(m=0;m<g;m++)o[m+g]=o[m];for(s=s||new gt(0,0,1,1),a=a||new gt(0,0,1,1),m=0,u=0;u<g/2;u++)o[m]=s.x+(s.z-s.x)*o[m],o[m+1]=s.y+(s.w-s.y)*o[m+1],o[m+g]=a.x+(a.z-a.x)*o[m+g],o[m+g+1]=a.y+(a.w-a.y)*o[m+g+1],m+=2}},t.ImportVertexData=function(e,i){var r=new t,n=e.positions;n&&r.set(n,Bt.PositionKind);var o=e.normals;o&&r.set(o,Bt.NormalKind);var s=e.tangents;s&&r.set(s,Bt.TangentKind);var a=e.uvs;a&&r.set(a,Bt.UVKind);var u=e.uv2s;u&&r.set(u,Bt.UV2Kind);var h=e.uv3s;h&&r.set(h,Bt.UV3Kind);var l=e.uv4s;l&&r.set(l,Bt.UV4Kind);var c=e.uv5s;c&&r.set(c,Bt.UV5Kind);var f=e.uv6s;f&&r.set(f,Bt.UV6Kind);var d=e.colors;d&&r.set(At.CheckColors4(d,n.length/3),Bt.ColorKind);var p=e.matricesIndices;p&&r.set(p,Bt.MatricesIndicesKind);var _=e.matricesWeights;_&&r.set(_,Bt.MatricesWeightsKind);var g=e.indices;g&&(r.indices=g),i.setAllVerticesData(r,e.updatable)},t.FRONTSIDE=0,t.BACKSIDE=1,t.DOUBLESIDE=2,t.DEFAULTSIDE=0,t}(),Ot=function(t,e,i){this.bu=t,this.bv=e,this.distance=i,this.faceId=0,this.subMeshId=0},Lt=function(){function t(t,e,i){this.vectors=dt.BuildArray(8,_t.Zero),this.center=_t.Zero(),this.centerWorld=_t.Zero(),this.extendSize=_t.Zero(),this.extendSizeWorld=_t.Zero(),this.directions=dt.BuildArray(3,_t.Zero),this.vectorsWorld=dt.BuildArray(8,_t.Zero),this.minimumWorld=_t.Zero(),this.maximumWorld=_t.Zero(),this.minimum=_t.Zero(),this.maximum=_t.Zero(),this.reConstruct(t,e,i)}return t.prototype.reConstruct=function(t,e,i){var r=t.x,n=t.y,o=t.z,s=e.x,a=e.y,u=e.z,h=this.vectors;this.minimum.copyFromFloats(r,n,o),this.maximum.copyFromFloats(s,a,u),h[0].copyFromFloats(r,n,o),h[1].copyFromFloats(s,a,u),h[2].copyFromFloats(s,n,o),h[3].copyFromFloats(r,a,o),h[4].copyFromFloats(r,n,u),h[5].copyFromFloats(s,a,o),h[6].copyFromFloats(r,a,u),h[7].copyFromFloats(s,n,u),e.addToRef(t,this.center).scaleInPlace(.5),e.subtractToRef(t,this.extendSize).scaleInPlace(.5),this._worldMatrix=i||yt.IdentityReadOnly,this._update(this._worldMatrix)},t.prototype.scale=function(e){var i=t.TmpVector3,r=this.maximum.subtractToRef(this.minimum,i[0]),n=r.length();r.normalizeFromLength(n);var o=n*e,s=r.scaleInPlace(.5*o),a=this.center.subtractToRef(s,i[1]),u=this.center.addToRef(s,i[2]);return this.reConstruct(a,u,this._worldMatrix),this},t.prototype.getWorldMatrix=function(){return this._worldMatrix},t.prototype._update=function(t){var e=this.minimumWorld,i=this.maximumWorld,r=this.directions,n=this.vectorsWorld,o=this.vectors;if(t.isIdentity()){e.copyFrom(this.minimum),i.copyFrom(this.maximum);for(s=0;s<8;++s)n[s].copyFrom(o[s]);this.extendSizeWorld.copyFrom(this.extendSize),this.centerWorld.copyFrom(this.center)}else{e.setAll(Number.MAX_VALUE),i.setAll(-Number.MAX_VALUE);for(var s=0;s<8;++s){var a=n[s];_t.TransformCoordinatesToRef(o[s],t,a),e.minimizeInPlace(a),i.maximizeInPlace(a)}i.subtractToRef(e,this.extendSizeWorld).scaleInPlace(.5),i.addToRef(e,this.centerWorld).scaleInPlace(.5)}_t.FromArrayToRef(t.m,0,r[0]),_t.FromArrayToRef(t.m,4,r[1]),_t.FromArrayToRef(t.m,8,r[2]),this._worldMatrix=t},t.prototype.isInFrustum=function(e){return t.IsInFrustum(this.vectorsWorld,e)},t.prototype.isCompletelyInFrustum=function(e){return t.IsCompletelyInFrustum(this.vectorsWorld,e)},t.prototype.intersectsPoint=function(t){var e=this.minimumWorld,i=this.maximumWorld,r=e.x,n=e.y,o=e.z,s=i.x,a=i.y,u=i.z,h=t.x,l=t.y,c=t.z;return!(s-h<-.001||-.001>h-r)&&(!(a-l<-.001||-.001>l-n)&&!(u-c<-.001||-.001>c-o))},t.prototype.intersectsSphere=function(e){return t.IntersectsSphere(this.minimumWorld,this.maximumWorld,e.centerWorld,e.radiusWorld)},t.prototype.intersectsMinMax=function(t,e){var i=this.minimumWorld,r=this.maximumWorld,n=i.x,o=i.y,s=i.z,a=r.x,u=r.y,h=r.z,l=t.x,c=t.y,f=t.z,d=e.x,p=e.y,_=e.z;return!(a<l||n>d)&&(!(u<c||o>p)&&!(h<f||s>_))},t.Intersects=function(t,e){return t.intersectsMinMax(e.minimumWorld,e.maximumWorld)},t.IntersectsSphere=function(e,i,r,n){var o=t.TmpVector3[0];return _t.ClampToRef(r,e,i,o),_t.DistanceSquared(r,o)<=n*n},t.IsCompletelyInFrustum=function(t,e){for(var i=0;i<6;++i)for(var r=e[i],n=0;n<8;++n)if(r.dotCoordinate(t[n])<0)return!1;return!0},t.IsInFrustum=function(t,e){for(var i=0;i<6;++i){for(var r=!0,n=e[i],o=0;o<8;++o)if(n.dotCoordinate(t[o])>=0){r=!1;break}if(r)return!1}return!0},t.TmpVector3=dt.BuildArray(3,_t.Zero),t}(),Ut=function(){function t(t,e,i){this.center=_t.Zero(),this.centerWorld=_t.Zero(),this.minimum=_t.Zero(),this.maximum=_t.Zero(),this.reConstruct(t,e,i)}return t.prototype.reConstruct=function(t,e,i){this.minimum.copyFrom(t),this.maximum.copyFrom(e);var r=_t.Distance(t,e);e.addToRef(t,this.center).scaleInPlace(.5),this.radius=.5*r,this._update(i||yt.IdentityReadOnly)},t.prototype.scale=function(e){var i=this.radius*e,r=t.TmpVector3,n=r[0].setAll(i),o=this.center.subtractToRef(n,r[1]),s=this.center.addToRef(n,r[2]);return this.reConstruct(o,s,this._worldMatrix),this},t.prototype.getWorldMatrix=function(){return this._worldMatrix},t.prototype._update=function(e){if(e.isIdentity())this.centerWorld.copyFrom(this.center),this.radiusWorld=this.radius;else{_t.TransformCoordinatesToRef(this.center,e,this.centerWorld);var i=t.TmpVector3[0];_t.TransformNormalFromFloatsToRef(1,1,1,e,i),this.radiusWorld=Math.max(Math.abs(i.x),Math.abs(i.y),Math.abs(i.z))*this.radius}},t.prototype.isInFrustum=function(t){for(var e=this.centerWorld,i=this.radiusWorld,r=0;r<6;r++)if(t[r].dotCoordinate(e)<=-i)return!1;return!0},t.prototype.isCenterInFrustum=function(t){for(var e=this.centerWorld,i=0;i<6;i++)if(t[i].dotCoordinate(e)<0)return!1;return!0},t.prototype.intersectsPoint=function(t){var e=_t.DistanceSquared(this.centerWorld,t);return!(this.radiusWorld*this.radiusWorld<e)},t.Intersects=function(t,e){var i=_t.DistanceSquared(t.centerWorld,e.centerWorld),r=t.radiusWorld+e.radiusWorld;return!(r*r<i)},t.TmpVector3=dt.BuildArray(3,_t.Zero),t}(),Nt={min:0,max:0},Vt={min:0,max:0},kt=function(t,e,i){var r=_t.Dot(e.centerWorld,t),n=Math.abs(_t.Dot(e.directions[0],t))*e.extendSize.x+Math.abs(_t.Dot(e.directions[1],t))*e.extendSize.y+Math.abs(_t.Dot(e.directions[2],t))*e.extendSize.z;i.min=r-n,i.max=r+n},zt=function(t,e,i){return kt(t,e,Nt),kt(t,i,Vt),!(Nt.min>Vt.max||Vt.min>Nt.max)},Wt=function(){function t(t,e,i){this._isLocked=!1,this.boundingBox=new Lt(t,e,i),this.boundingSphere=new Ut(t,e,i)}return t.prototype.reConstruct=function(t,e,i){this.boundingBox.reConstruct(t,e,i),this.boundingSphere.reConstruct(t,e,i)},Object.defineProperty(t.prototype,"minimum",{get:function(){return this.boundingBox.minimum},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maximum",{get:function(){return this.boundingBox.maximum},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLocked",{get:function(){return this._isLocked},set:function(t){this._isLocked=t},enumerable:!1,configurable:!0}),t.prototype.update=function(t){this._isLocked||(this.boundingBox._update(t),this.boundingSphere._update(t))},t.prototype.centerOn=function(e,i){var r=t.TmpVector3[0].copyFrom(e).subtractInPlace(i),n=t.TmpVector3[1].copyFrom(e).addInPlace(i);return this.boundingBox.reConstruct(r,n,this.boundingBox.getWorldMatrix()),this.boundingSphere.reConstruct(r,n,this.boundingBox.getWorldMatrix()),this},t.prototype.scale=function(t){return this.boundingBox.scale(t),this.boundingSphere.scale(t),this},t.prototype.isInFrustum=function(t,e){return void 0===e&&(e=0),!(2!==e&&3!==e||!this.boundingSphere.isCenterInFrustum(t))||!!this.boundingSphere.isInFrustum(t)&&(!(1!==e&&3!==e)||this.boundingBox.isInFrustum(t))},Object.defineProperty(t.prototype,"diagonalLength",{get:function(){var e=this.boundingBox;return e.maximumWorld.subtractToRef(e.minimumWorld,t.TmpVector3[0]).length()},enumerable:!1,configurable:!0}),t.prototype.isCompletelyInFrustum=function(t){return this.boundingBox.isCompletelyInFrustum(t)},t.prototype._checkCollision=function(t){return t._canDoCollision(this.boundingSphere.centerWorld,this.boundingSphere.radiusWorld,this.boundingBox.minimumWorld,this.boundingBox.maximumWorld)},t.prototype.intersectsPoint=function(t){return!!this.boundingSphere.centerWorld&&(!!this.boundingSphere.intersectsPoint(t)&&!!this.boundingBox.intersectsPoint(t))},t.prototype.intersects=function(t,e){if(!Ut.Intersects(this.boundingSphere,t.boundingSphere))return!1;if(!Lt.Intersects(this.boundingBox,t.boundingBox))return!1;if(!e)return!0;var i=this.boundingBox,r=t.boundingBox;return!!zt(i.directions[0],i,r)&&(!!zt(i.directions[1],i,r)&&(!!zt(i.directions[2],i,r)&&(!!zt(r.directions[0],i,r)&&(!!zt(r.directions[1],i,r)&&(!!zt(r.directions[2],i,r)&&(!!zt(_t.Cross(i.directions[0],r.directions[0]),i,r)&&(!!zt(_t.Cross(i.directions[0],r.directions[1]),i,r)&&(!!zt(_t.Cross(i.directions[0],r.directions[2]),i,r)&&(!!zt(_t.Cross(i.directions[1],r.directions[0]),i,r)&&(!!zt(_t.Cross(i.directions[1],r.directions[1]),i,r)&&(!!zt(_t.Cross(i.directions[1],r.directions[2]),i,r)&&(!!zt(_t.Cross(i.directions[2],r.directions[0]),i,r)&&(!!zt(_t.Cross(i.directions[2],r.directions[1]),i,r)&&!!zt(_t.Cross(i.directions[2],r.directions[2]),i,r))))))))))))))},t.TmpVector3=dt.BuildArray(2,_t.Zero),t}();function Kt(t,e,i,r,n){void 0===r&&(r=null);var o=new _t(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),s=new _t(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);n||(n=3);for(var a=e,u=e*n;a<e+i;a++,u+=n){var h=t[u],l=t[u+1],c=t[u+2];o.minimizeInPlaceFromFloats(h,l,c),s.maximizeInPlaceFromFloats(h,l,c)}return r&&(o.x-=o.x*r.x+r.y,o.y-=o.y*r.x+r.y,o.z-=o.z*r.x+r.y,s.x+=s.x*r.x+r.y,s.y+=s.y*r.x+r.y,s.z+=s.z*r.x+r.y),{minimum:o,maximum:s}}var jt=function(){function t(t,e,i,r,n,o,s,a,u){void 0===a&&(a=!0),void 0===u&&(u=!0),this.materialIndex=t,this.verticesStart=e,this.verticesCount=i,this.indexStart=r,this.indexCount=n,this._materialDefines=null,this._materialEffect=null,this._effectOverride=null,this._linesIndexCount=0,this._linesIndexBuffer=null,this._lastColliderWorldVertices=null,this._lastColliderTransformMatrix=null,this._renderId=0,this._alphaIndex=0,this._distanceToCamera=0,this._currentMaterial=null,this._mesh=o,this._renderingMesh=s||o,u&&o.subMeshes.push(this),this._trianglePlanes=[],this._id=o.subMeshes.length-1,a&&(this.refreshBoundingInfo(),o.computeWorldMatrix(!0))}return Object.defineProperty(t.prototype,"materialDefines",{get:function(){return this._materialDefines},set:function(t){this._materialDefines=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"effect",{get:function(){var t;return null!==(t=this._effectOverride)&&void 0!==t?t:this._materialEffect},enumerable:!1,configurable:!0}),t.prototype.setEffect=function(t,e){void 0===e&&(e=null),this._materialEffect!==t?(this._materialDefines=e,this._materialEffect=t):t||(this._materialDefines=null)},t.AddToMesh=function(e,i,r,n,o,s,a,u){return void 0===u&&(u=!0),new t(e,i,r,n,o,s,a,u)},Object.defineProperty(t.prototype,"IsGlobal",{get:function(){return 0===this.verticesStart&&this.verticesCount===this._mesh.getTotalVertices()},enumerable:!1,configurable:!0}),t.prototype.getBoundingInfo=function(){return this.IsGlobal?this._mesh.getBoundingInfo():this._boundingInfo},t.prototype.setBoundingInfo=function(t){return this._boundingInfo=t,this},t.prototype.getMesh=function(){return this._mesh},t.prototype.getRenderingMesh=function(){return this._renderingMesh},t.prototype.getReplacementMesh=function(){return this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null},t.prototype.getEffectiveMesh=function(){var t=this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:null;return t||this._renderingMesh},t.prototype.getMaterial=function(){var t=this._renderingMesh.material;if(null==t)return this._mesh.getScene().defaultMaterial;if(this._IsMultiMaterial(t)){var e=t.getSubMaterial(this.materialIndex);return this._currentMaterial!==e&&(this._currentMaterial=e,this._materialDefines=null),e}return t},t.prototype._IsMultiMaterial=function(t){return void 0!==t.getSubMaterial},t.prototype.refreshBoundingInfo=function(t){if(void 0===t&&(t=null),this._lastColliderWorldVertices=null,this.IsGlobal||!this._renderingMesh||!this._renderingMesh.geometry)return this;if(t||(t=this._renderingMesh.getVerticesData(Bt.PositionKind)),!t)return this._boundingInfo=this._mesh.getBoundingInfo(),this;var e,i=this._renderingMesh.getIndices();if(0===this.indexStart&&this.indexCount===i.length){var r=this._renderingMesh.getBoundingInfo();e={minimum:r.minimum.clone(),maximum:r.maximum.clone()}}else e=function(t,e,i,r,n){void 0===n&&(n=null);for(var o=new _t(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),s=new _t(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),a=i;a<i+r;a++){var u=3*e[a],h=t[u],l=t[u+1],c=t[u+2];o.minimizeInPlaceFromFloats(h,l,c),s.maximizeInPlaceFromFloats(h,l,c)}return n&&(o.x-=o.x*n.x+n.y,o.y-=o.y*n.x+n.y,o.z-=o.z*n.x+n.y,s.x+=s.x*n.x+n.y,s.y+=s.y*n.x+n.y,s.z+=s.z*n.x+n.y),{minimum:o,maximum:s}}(t,i,this.indexStart,this.indexCount,this._renderingMesh.geometry.boundingBias);return this._boundingInfo?this._boundingInfo.reConstruct(e.minimum,e.maximum):this._boundingInfo=new Wt(e.minimum,e.maximum),this},t.prototype._checkCollision=function(t){return this.getBoundingInfo()._checkCollision(t)},t.prototype.updateBoundingInfo=function(t){var e=this.getBoundingInfo();return e||(this.refreshBoundingInfo(),e=this.getBoundingInfo()),e&&e.update(t),this},t.prototype.isInFrustum=function(t){var e=this.getBoundingInfo();return!!e&&e.isInFrustum(t,this._mesh.cullingStrategy)},t.prototype.isCompletelyInFrustum=function(t){var e=this.getBoundingInfo();return!!e&&e.isCompletelyInFrustum(t)},t.prototype.render=function(t){return this._renderingMesh.render(this,t,this._mesh._internalAbstractMeshDataInfo._actAsRegularMesh?this._mesh:void 0),this},t.prototype._getLinesIndexBuffer=function(t,e){if(!this._linesIndexBuffer){for(var i=[],r=this.indexStart;r<this.indexStart+this.indexCount;r+=3)i.push(t[r],t[r+1],t[r+1],t[r+2],t[r+2],t[r]);this._linesIndexBuffer=e.createIndexBuffer(i),this._linesIndexCount=i.length}return this._linesIndexBuffer},t.prototype.canIntersects=function(t){var e=this.getBoundingInfo();return!!e&&t.intersectsBox(e.boundingBox)},t.prototype.intersects=function(t,e,i,r,n){var o=this.getMaterial();if(!o)return null;var s=3,a=!1;switch(o.fillMode){case 3:case 4:case 5:case 6:case 8:return null;case 7:s=1,a=!0}return"InstancedLinesMesh"===this._mesh.getClassName()||"LinesMesh"===this._mesh.getClassName()?i.length?this._intersectLines(t,e,i,this._mesh.intersectionThreshold,r):this._intersectUnIndexedLines(t,e,i,this._mesh.intersectionThreshold,r):!i.length&&this._mesh._unIndexed?this._intersectUnIndexedTriangles(t,e,i,r,n):this._intersectTriangles(t,e,i,s,a,r,n)},t.prototype._intersectLines=function(t,e,i,r,n){for(var o=null,s=this.indexStart;s<this.indexStart+this.indexCount;s+=2){var a=e[i[s]],u=e[i[s+1]],h=t.intersectionSegment(a,u,r);if(!(h<0)&&((n||!o||h<o.distance)&&((o=new Ot(null,null,h)).faceId=s/2,n)))break}return o},t.prototype._intersectUnIndexedLines=function(t,e,i,r,n){for(var o=null,s=this.verticesStart;s<this.verticesStart+this.verticesCount;s+=2){var a=e[s],u=e[s+1],h=t.intersectionSegment(a,u,r);if(!(h<0)&&((n||!o||h<o.distance)&&((o=new Ot(null,null,h)).faceId=s/2,n)))break}return o},t.prototype._intersectTriangles=function(t,e,i,r,n,o,s){for(var a=null,u=-1,h=this.indexStart;h<this.indexStart+this.indexCount;h+=r){u++;var l=i[h],c=i[h+1],f=i[h+2];if(n&&4294967295===f)h+=2;else{var d=e[l],p=e[c],_=e[f];if(!s||s(d,p,_,t)){var g=t.intersectsTriangle(d,p,_);if(g){if(g.distance<0)continue;if((o||!a||g.distance<a.distance)&&((a=g).faceId=u,o))break}}}}return a},t.prototype._intersectUnIndexedTriangles=function(t,e,i,r,n){for(var o=null,s=this.verticesStart;s<this.verticesStart+this.verticesCount;s+=3){var a=e[s],u=e[s+1],h=e[s+2];if(!n||n(a,u,h,t)){var l=t.intersectsTriangle(a,u,h);if(l){if(l.distance<0)continue;if((r||!o||l.distance<o.distance)&&((o=l).faceId=s/3,r))break}}}return o},t.prototype._rebuild=function(){this._linesIndexBuffer&&(this._linesIndexBuffer=null)},t.prototype.clone=function(e,i){var r=new t(this.materialIndex,this.verticesStart,this.verticesCount,this.indexStart,this.indexCount,e,i,!1);if(!this.IsGlobal){var n=this.getBoundingInfo();if(!n)return r;r._boundingInfo=new Wt(n.minimum,n.maximum)}return r},t.prototype.dispose=function(){this._linesIndexBuffer&&(this._mesh.getScene().getEngine()._releaseBuffer(this._linesIndexBuffer),this._linesIndexBuffer=null);var t=this._mesh.subMeshes.indexOf(this);this._mesh.subMeshes.splice(t,1)},t.prototype.getClassName=function(){return"SubMesh"},t.CreateFromIndices=function(e,i,r,n,o){for(var s=Number.MAX_VALUE,a=-Number.MAX_VALUE,u=(o||n).getIndices(),h=i;h<i+r;h++){var l=u[h];l<s&&(s=l),l>a&&(a=l)}return new t(e,s,a-s+1,i,r,n,o)},t}(),Gt=function(){function t(){}return Object.defineProperty(t,"ForceFullSceneLoadingForIncremental",{get:function(){return t._ForceFullSceneLoadingForIncremental},set:function(e){t._ForceFullSceneLoadingForIncremental=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"ShowLoadingScreen",{get:function(){return t._ShowLoadingScreen},set:function(e){t._ShowLoadingScreen=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"loggingLevel",{get:function(){return t._loggingLevel},set:function(e){t._loggingLevel=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CleanBoneMatrixWeights",{get:function(){return t._CleanBoneMatrixWeights},set:function(e){t._CleanBoneMatrixWeights=e},enumerable:!1,configurable:!0}),t._ForceFullSceneLoadingForIncremental=!1,t._ShowLoadingScreen=!0,t._CleanBoneMatrixWeights=!1,t._loggingLevel=0,t}(),Xt=function(){function t(t,e,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=null),this.delayLoadState=0,this._totalVertices=0,this._isDisposed=!1,this._indexBufferIsUpdatable=!1,this._positionsCache=[],this.useBoundingInfoFromGeometry=!1,this.id=t,this.uniqueId=e.getUniqueId(),this._engine=e.getEngine(),this._meshes=[],this._scene=e,this._vertexBuffers={},this._indices=[],this._updatable=r,i?this.setAllVerticesData(i,r):(this._totalVertices=0,this._indices=[]),this._engine.getCaps().vertexArrayObject&&(this._vertexArrayObjects={}),n&&(this.applyToMesh(n),n.computeWorldMatrix(!0))}return Object.defineProperty(t.prototype,"boundingBias",{get:function(){return this._boundingBias},set:function(t){this._boundingBias?this._boundingBias.copyFrom(t):this._boundingBias=t.clone(),this._updateBoundingInfo(!0,null)},enumerable:!1,configurable:!0}),t.CreateGeometryForMesh=function(e){var i=new t(t.RandomId(),e.getScene());return i.applyToMesh(e),i},Object.defineProperty(t.prototype,"meshes",{get:function(){return this._meshes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extend",{get:function(){return this._extend},enumerable:!1,configurable:!0}),t.prototype.getScene=function(){return this._scene},t.prototype.getEngine=function(){return this._engine},t.prototype.isReady=function(){return 1===this.delayLoadState||0===this.delayLoadState},Object.defineProperty(t.prototype,"doNotSerialize",{get:function(){for(var t=0;t<this._meshes.length;t++)if(!this._meshes[t].doNotSerialize)return!1;return!0},enumerable:!1,configurable:!0}),t.prototype._rebuild=function(){for(var t in this._vertexArrayObjects&&(this._vertexArrayObjects={}),0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices)),this._vertexBuffers){this._vertexBuffers[t]._rebuild()}},t.prototype.setAllVerticesData=function(t,e){t.applyToGeometry(this,e),this.notifyUpdate()},t.prototype.setVerticesData=function(t,e,i,r){void 0===i&&(i=!1),i&&Array.isArray(e)&&(e=new Float32Array(e));var n=new Bt(this._engine,e,t,i,0===this._meshes.length,r);this.setVerticesBuffer(n)},t.prototype.removeVerticesData=function(t){this._vertexBuffers[t]&&(this._vertexBuffers[t].dispose(),delete this._vertexBuffers[t])},t.prototype.setVerticesBuffer=function(t,e){void 0===e&&(e=null);var i=t.getKind();if(this._vertexBuffers[i]&&this._vertexBuffers[i].dispose(),this._vertexBuffers[i]=t,i===Bt.PositionKind){var r=t.getData();null!=e?this._totalVertices=e:null!=r&&(this._totalVertices=r.length/(t.byteStride/4)),this._updateExtend(r),this._resetPointsArrayCache();for(var n=this._meshes,o=n.length,s=0;s<o;s++){var a=n[s];a._boundingInfo=new Wt(this._extend.minimum,this._extend.maximum),a._createGlobalSubMesh(!1),a.computeWorldMatrix(!0)}}this.notifyUpdate(i),this._vertexArrayObjects&&(this._disposeVertexArrayObjects(),this._vertexArrayObjects={})},t.prototype.updateVerticesDataDirectly=function(t,e,i,r){void 0===r&&(r=!1);var n=this.getVertexBuffer(t);n&&(n.updateDirectly(e,i,r),this.notifyUpdate(t))},t.prototype.updateVerticesData=function(t,e,i){void 0===i&&(i=!1);var r=this.getVertexBuffer(t);r&&(r.update(e),t===Bt.PositionKind&&this._updateBoundingInfo(i,e),this.notifyUpdate(t))},t.prototype._updateBoundingInfo=function(t,e){if(t&&this._updateExtend(e),this._resetPointsArrayCache(),t)for(var i=0,r=this._meshes;i<r.length;i++){var n=r[i];n._boundingInfo?n._boundingInfo.reConstruct(this._extend.minimum,this._extend.maximum):n._boundingInfo=new Wt(this._extend.minimum,this._extend.maximum);for(var o=0,s=n.subMeshes;o<s.length;o++){s[o].refreshBoundingInfo()}}},t.prototype._bind=function(t,e){if(t){void 0===e&&(e=this._indexBuffer);var i=this.getVertexBuffers();i&&(e==this._indexBuffer&&this._vertexArrayObjects?(this._vertexArrayObjects[t.key]||(this._vertexArrayObjects[t.key]=this._engine.recordVertexArrayObject(i,e,t)),this._engine.bindVertexArrayObject(this._vertexArrayObjects[t.key],e)):this._engine.bindBuffers(i,e,t))}},t.prototype.getTotalVertices=function(){return this.isReady()?this._totalVertices:0},t.prototype.getVerticesData=function(t,e,i){var r=this.getVertexBuffer(t);if(!r)return null;var n=r.getData();if(!n)return null;var o=r.getSize()*Bt.GetTypeByteLength(r.type),s=this._totalVertices*r.getSize();if(r.type!==Bt.FLOAT||r.byteStride!==o){var a=[];return r.forEach(s,(function(t){return a.push(t)})),a}if(!(n instanceof Array||n instanceof Float32Array)||0!==r.byteOffset||n.length!==s){if(n instanceof Array){var u=r.byteOffset/4;return ut.Slice(n,u,u+s)}if(n instanceof ArrayBuffer)return new Float32Array(n,r.byteOffset,s);u=n.byteOffset+r.byteOffset;if(i||e&&1!==this._meshes.length){var h=new Float32Array(s),l=new Float32Array(n.buffer,u,s);return h.set(l),h}var c=u%4;return c&&(u=Math.max(0,u-c)),new Float32Array(n.buffer,u,s)}return i||e&&1!==this._meshes.length?ut.Slice(n):n},t.prototype.isVertexBufferUpdatable=function(t){var e=this._vertexBuffers[t];return!!e&&e.isUpdatable()},t.prototype.getVertexBuffer=function(t){return this.isReady()?this._vertexBuffers[t]:null},t.prototype.getVertexBuffers=function(){return this.isReady()?this._vertexBuffers:null},t.prototype.isVerticesDataPresent=function(t){return this._vertexBuffers?void 0!==this._vertexBuffers[t]:!!this._delayInfo&&-1!==this._delayInfo.indexOf(t)},t.prototype.getVerticesDataKinds=function(){var t,e=[];if(!this._vertexBuffers&&this._delayInfo)for(t in this._delayInfo)e.push(t);else for(t in this._vertexBuffers)e.push(t);return e},t.prototype.updateIndices=function(t,e,i){if(void 0===i&&(i=!1),this._indexBuffer)if(this._indexBufferIsUpdatable){var r=t.length!==this._indices.length;if(i||(this._indices=t.slice()),this._engine.updateDynamicIndexBuffer(this._indexBuffer,t,e),r)for(var n=0,o=this._meshes;n<o.length;n++){o[n]._createGlobalSubMesh(!0)}}else this.setIndices(t,null,!0)},t.prototype.setIndices=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=!1),this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._disposeVertexArrayObjects(),this._indices=t,this._indexBufferIsUpdatable=i,0!==this._meshes.length&&this._indices&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices,i)),null!=e&&(this._totalVertices=e);for(var r=0,n=this._meshes;r<n.length;r++){n[r]._createGlobalSubMesh(!0)}this.notifyUpdate()},t.prototype.getTotalIndices=function(){return this.isReady()?this._indices.length:0},t.prototype.getIndices=function(t,e){if(!this.isReady())return null;var i=this._indices;if(e||t&&1!==this._meshes.length){for(var r=i.length,n=[],o=0;o<r;o++)n.push(i[o]);return n}return i},t.prototype.getIndexBuffer=function(){return this.isReady()?this._indexBuffer:null},t.prototype._releaseVertexArrayObject=function(t){void 0===t&&(t=null),t&&this._vertexArrayObjects&&this._vertexArrayObjects[t.key]&&(this._engine.releaseVertexArrayObject(this._vertexArrayObjects[t.key]),delete this._vertexArrayObjects[t.key])},t.prototype.releaseForMesh=function(t,e){var i=this._meshes,r=i.indexOf(t);-1!==r&&(i.splice(r,1),t._geometry=null,0===i.length&&e&&this.dispose())},t.prototype.applyToMesh=function(t){if(t._geometry!==this){var e=t._geometry;e&&e.releaseForMesh(t);var i=this._meshes;t._geometry=this,this._scene.pushGeometry(this),i.push(t),this.isReady()?this._applyToMesh(t):t._boundingInfo=this._boundingInfo}},t.prototype._updateExtend=function(t){void 0===t&&(t=null),this.useBoundingInfoFromGeometry&&this._boundingInfo?this._extend={minimum:this._boundingInfo.minimum.clone(),maximum:this._boundingInfo.maximum.clone()}:(t||(t=this.getVerticesData(Bt.PositionKind)),this._extend=Kt(t,0,this._totalVertices,this.boundingBias,3))},t.prototype._applyToMesh=function(t){var e=this._meshes.length;for(var i in this._vertexBuffers){1===e&&this._vertexBuffers[i].create();var r=this._vertexBuffers[i].getBuffer();r&&(r.references=e),i===Bt.PositionKind&&(this._extend||this._updateExtend(),t._boundingInfo=new Wt(this._extend.minimum,this._extend.maximum),t._createGlobalSubMesh(!1),t._updateBoundingInfo())}1===e&&this._indices&&this._indices.length>0&&(this._indexBuffer=this._engine.createIndexBuffer(this._indices)),this._indexBuffer&&(this._indexBuffer.references=e),t._syncGeometryWithMorphTargetManager(),t.synchronizeInstances()},t.prototype.notifyUpdate=function(t){this.onGeometryUpdated&&this.onGeometryUpdated(this,t);for(var e=0,i=this._meshes;e<i.length;e++){i[e]._markSubMeshesAsAttributesDirty()}},t.prototype.load=function(t,e){2!==this.delayLoadState&&(this.isReady()?e&&e():(this.delayLoadState=2,this._queueLoad(t,e)))},t.prototype._queueLoad=function(t,e){var i=this;this.delayLoadingFile&&(t._addPendingData(this),t._loadFile(this.delayLoadingFile,(function(r){if(i._delayLoadingFunction){i._delayLoadingFunction(JSON.parse(r),i),i.delayLoadState=1,i._delayInfo=[],t._removePendingData(i);for(var n=i._meshes,o=n.length,s=0;s<o;s++)i._applyToMesh(n[s]);e&&e()}}),void 0,!0))},t.prototype.toLeftHanded=function(){var t=this.getIndices(!1);if(null!=t&&t.length>0){for(var e=0;e<t.length;e+=3){var i=t[e+0];t[e+0]=t[e+2],t[e+2]=i}this.setIndices(t)}var r=this.getVerticesData(Bt.PositionKind,!1);if(null!=r&&r.length>0){for(e=0;e<r.length;e+=3)r[e+2]=-r[e+2];this.setVerticesData(Bt.PositionKind,r,!1)}var n=this.getVerticesData(Bt.NormalKind,!1);if(null!=n&&n.length>0){for(e=0;e<n.length;e+=3)n[e+2]=-n[e+2];this.setVerticesData(Bt.NormalKind,n,!1)}},t.prototype._resetPointsArrayCache=function(){this._positions=null},t.prototype._generatePointsArray=function(){if(this._positions)return!0;var t=this.getVerticesData(Bt.PositionKind);if(!t||0===t.length)return!1;for(var e=3*this._positionsCache.length,i=this._positionsCache.length;e<t.length;e+=3,++i)this._positionsCache[i]=_t.FromArray(t,e);for(e=0,i=0;e<t.length;e+=3,++i)this._positionsCache[i].set(t[0+e],t[1+e],t[2+e]);return this._positionsCache.length=t.length/3,this._positions=this._positionsCache,!0},t.prototype.isDisposed=function(){return this._isDisposed},t.prototype._disposeVertexArrayObjects=function(){if(this._vertexArrayObjects){for(var t in this._vertexArrayObjects)this._engine.releaseVertexArrayObject(this._vertexArrayObjects[t]);this._vertexArrayObjects={}}},t.prototype.dispose=function(){var t,e=this._meshes,i=e.length;for(t=0;t<i;t++)this.releaseForMesh(e[t]);for(var r in this._meshes=[],this._disposeVertexArrayObjects(),this._vertexBuffers)this._vertexBuffers[r].dispose();this._vertexBuffers={},this._totalVertices=0,this._indexBuffer&&this._engine._releaseBuffer(this._indexBuffer),this._indexBuffer=null,this._indices=[],this.delayLoadState=0,this.delayLoadingFile=null,this._delayLoadingFunction=null,this._delayInfo=[],this._boundingInfo=null,this._scene.removeGeometry(this),this._isDisposed=!0},t.prototype.copy=function(e){var i=new wt;i.indices=[];var r=this.getIndices();if(r)for(var n=0;n<r.length;n++)i.indices.push(r[n]);var o,s=!1,a=!1;for(o in this._vertexBuffers){var u=this.getVerticesData(o);if(u&&(u instanceof Float32Array?i.set(new Float32Array(u),o):i.set(u.slice(0),o),!a)){var h=this.getVertexBuffer(o);h&&(a=!(s=h.isUpdatable()))}}var l=new t(e,this._scene,i,s);for(o in l.delayLoadState=this.delayLoadState,l.delayLoadingFile=this.delayLoadingFile,l._delayLoadingFunction=this._delayLoadingFunction,this._delayInfo)l._delayInfo=l._delayInfo||[],l._delayInfo.push(o);return l._boundingInfo=new Wt(this._extend.minimum,this._extend.maximum),l},t.prototype.serialize=function(){var t={};return t.id=this.id,t.updatable=this._updatable,ct&&ct.HasTags(this)&&(t.tags=ct.GetTags(this)),t},t.prototype.toNumberArray=function(t){return Array.isArray(t)?t:Array.prototype.slice.call(t)},t.prototype.serializeVerticeData=function(){var t=this.serialize();return this.isVerticesDataPresent(Bt.PositionKind)&&(t.positions=this.toNumberArray(this.getVerticesData(Bt.PositionKind)),this.isVertexBufferUpdatable(Bt.PositionKind)&&(t.positions._updatable=!0)),this.isVerticesDataPresent(Bt.NormalKind)&&(t.normals=this.toNumberArray(this.getVerticesData(Bt.NormalKind)),this.isVertexBufferUpdatable(Bt.NormalKind)&&(t.normals._updatable=!0)),this.isVerticesDataPresent(Bt.TangentKind)&&(t.tangets=this.toNumberArray(this.getVerticesData(Bt.TangentKind)),this.isVertexBufferUpdatable(Bt.TangentKind)&&(t.tangets._updatable=!0)),this.isVerticesDataPresent(Bt.UVKind)&&(t.uvs=this.toNumberArray(this.getVerticesData(Bt.UVKind)),this.isVertexBufferUpdatable(Bt.UVKind)&&(t.uvs._updatable=!0)),this.isVerticesDataPresent(Bt.UV2Kind)&&(t.uv2s=this.toNumberArray(this.getVerticesData(Bt.UV2Kind)),this.isVertexBufferUpdatable(Bt.UV2Kind)&&(t.uv2s._updatable=!0)),this.isVerticesDataPresent(Bt.UV3Kind)&&(t.uv3s=this.toNumberArray(this.getVerticesData(Bt.UV3Kind)),this.isVertexBufferUpdatable(Bt.UV3Kind)&&(t.uv3s._updatable=!0)),this.isVerticesDataPresent(Bt.UV4Kind)&&(t.uv4s=this.toNumberArray(this.getVerticesData(Bt.UV4Kind)),this.isVertexBufferUpdatable(Bt.UV4Kind)&&(t.uv4s._updatable=!0)),this.isVerticesDataPresent(Bt.UV5Kind)&&(t.uv5s=this.toNumberArray(this.getVerticesData(Bt.UV5Kind)),this.isVertexBufferUpdatable(Bt.UV5Kind)&&(t.uv5s._updatable=!0)),this.isVerticesDataPresent(Bt.UV6Kind)&&(t.uv6s=this.toNumberArray(this.getVerticesData(Bt.UV6Kind)),this.isVertexBufferUpdatable(Bt.UV6Kind)&&(t.uv6s._updatable=!0)),this.isVerticesDataPresent(Bt.ColorKind)&&(t.colors=this.toNumberArray(this.getVerticesData(Bt.ColorKind)),this.isVertexBufferUpdatable(Bt.ColorKind)&&(t.colors._updatable=!0)),this.isVerticesDataPresent(Bt.MatricesIndicesKind)&&(t.matricesIndices=this.toNumberArray(this.getVerticesData(Bt.MatricesIndicesKind)),t.matricesIndices._isExpanded=!0,this.isVertexBufferUpdatable(Bt.MatricesIndicesKind)&&(t.matricesIndices._updatable=!0)),this.isVerticesDataPresent(Bt.MatricesWeightsKind)&&(t.matricesWeights=this.toNumberArray(this.getVerticesData(Bt.MatricesWeightsKind)),this.isVertexBufferUpdatable(Bt.MatricesWeightsKind)&&(t.matricesWeights._updatable=!0)),t.indices=this.toNumberArray(this.getIndices()),t},t.ExtractFromMesh=function(t,e){var i=t._geometry;return i?i.copy(e):null},t.RandomId=function(){return ut.RandomId()},t._ImportGeometry=function(e,i){var r=i.getScene(),n=e.geometryId;if(n){var o=r.getGeometryByID(n);o&&o.applyToMesh(i)}else if(e instanceof ArrayBuffer){var s=i._binaryInfo;if(s.positionsAttrDesc&&s.positionsAttrDesc.count>0){var a=new Float32Array(e,s.positionsAttrDesc.offset,s.positionsAttrDesc.count);i.setVerticesData(Bt.PositionKind,a,!1)}if(s.normalsAttrDesc&&s.normalsAttrDesc.count>0){var u=new Float32Array(e,s.normalsAttrDesc.offset,s.normalsAttrDesc.count);i.setVerticesData(Bt.NormalKind,u,!1)}if(s.tangetsAttrDesc&&s.tangetsAttrDesc.count>0){var h=new Float32Array(e,s.tangetsAttrDesc.offset,s.tangetsAttrDesc.count);i.setVerticesData(Bt.TangentKind,h,!1)}if(s.uvsAttrDesc&&s.uvsAttrDesc.count>0){var l=new Float32Array(e,s.uvsAttrDesc.offset,s.uvsAttrDesc.count);i.setVerticesData(Bt.UVKind,l,!1)}if(s.uvs2AttrDesc&&s.uvs2AttrDesc.count>0){var c=new Float32Array(e,s.uvs2AttrDesc.offset,s.uvs2AttrDesc.count);i.setVerticesData(Bt.UV2Kind,c,!1)}if(s.uvs3AttrDesc&&s.uvs3AttrDesc.count>0){var f=new Float32Array(e,s.uvs3AttrDesc.offset,s.uvs3AttrDesc.count);i.setVerticesData(Bt.UV3Kind,f,!1)}if(s.uvs4AttrDesc&&s.uvs4AttrDesc.count>0){var d=new Float32Array(e,s.uvs4AttrDesc.offset,s.uvs4AttrDesc.count);i.setVerticesData(Bt.UV4Kind,d,!1)}if(s.uvs5AttrDesc&&s.uvs5AttrDesc.count>0){var p=new Float32Array(e,s.uvs5AttrDesc.offset,s.uvs5AttrDesc.count);i.setVerticesData(Bt.UV5Kind,p,!1)}if(s.uvs6AttrDesc&&s.uvs6AttrDesc.count>0){var _=new Float32Array(e,s.uvs6AttrDesc.offset,s.uvs6AttrDesc.count);i.setVerticesData(Bt.UV6Kind,_,!1)}if(s.colorsAttrDesc&&s.colorsAttrDesc.count>0){var g=new Float32Array(e,s.colorsAttrDesc.offset,s.colorsAttrDesc.count);i.setVerticesData(Bt.ColorKind,g,!1,s.colorsAttrDesc.stride)}if(s.matricesIndicesAttrDesc&&s.matricesIndicesAttrDesc.count>0){for(var m=new Int32Array(e,s.matricesIndicesAttrDesc.offset,s.matricesIndicesAttrDesc.count),y=[],v=0;v<m.length;v++){var b=m[v];y.push(255&b),y.push((65280&b)>>8),y.push((16711680&b)>>16),y.push(b>>24&255)}i.setVerticesData(Bt.MatricesIndicesKind,y,!1)}if(s.matricesIndicesExtraAttrDesc&&s.matricesIndicesExtraAttrDesc.count>0){for(m=new Int32Array(e,s.matricesIndicesExtraAttrDesc.offset,s.matricesIndicesExtraAttrDesc.count),y=[],v=0;v<m.length;v++){b=m[v];y.push(255&b),y.push((65280&b)>>8),y.push((16711680&b)>>16),y.push(b>>24&255)}i.setVerticesData(Bt.MatricesIndicesExtraKind,y,!1)}if(s.matricesWeightsAttrDesc&&s.matricesWeightsAttrDesc.count>0){var x=new Float32Array(e,s.matricesWeightsAttrDesc.offset,s.matricesWeightsAttrDesc.count);i.setVerticesData(Bt.MatricesWeightsKind,x,!1)}if(s.indicesAttrDesc&&s.indicesAttrDesc.count>0){var A=new Int32Array(e,s.indicesAttrDesc.offset,s.indicesAttrDesc.count);i.setIndices(A,null)}if(s.subMeshesAttrDesc&&s.subMeshesAttrDesc.count>0){var E=new Int32Array(e,s.subMeshesAttrDesc.offset,5*s.subMeshesAttrDesc.count);i.subMeshes=[];for(v=0;v<s.subMeshesAttrDesc.count;v++){var T=E[5*v+0],M=E[5*v+1],R=E[5*v+2],I=E[5*v+3],F=E[5*v+4];jt.AddToMesh(T,M,R,I,F,i)}}}else if(e.positions&&e.normals&&e.indices){if(i.setVerticesData(Bt.PositionKind,e.positions,e.positions._updatable),i.setVerticesData(Bt.NormalKind,e.normals,e.normals._updatable),e.tangents&&i.setVerticesData(Bt.TangentKind,e.tangents,e.tangents._updatable),e.uvs&&i.setVerticesData(Bt.UVKind,e.uvs,e.uvs._updatable),e.uvs2&&i.setVerticesData(Bt.UV2Kind,e.uvs2,e.uvs2._updatable),e.uvs3&&i.setVerticesData(Bt.UV3Kind,e.uvs3,e.uvs3._updatable),e.uvs4&&i.setVerticesData(Bt.UV4Kind,e.uvs4,e.uvs4._updatable),e.uvs5&&i.setVerticesData(Bt.UV5Kind,e.uvs5,e.uvs5._updatable),e.uvs6&&i.setVerticesData(Bt.UV6Kind,e.uvs6,e.uvs6._updatable),e.colors&&i.setVerticesData(Bt.ColorKind,At.CheckColors4(e.colors,e.positions.length/3),e.colors._updatable),e.matricesIndices)if(e.matricesIndices._isExpanded)delete e.matricesIndices._isExpanded,i.setVerticesData(Bt.MatricesIndicesKind,e.matricesIndices,e.matricesIndices._updatable);else{for(y=[],v=0;v<e.matricesIndices.length;v++){var S=e.matricesIndices[v];y.push(255&S),y.push((65280&S)>>8),y.push((16711680&S)>>16),y.push(S>>24&255)}i.setVerticesData(Bt.MatricesIndicesKind,y,e.matricesIndices._updatable)}if(e.matricesIndicesExtra)if(e.matricesIndicesExtra._isExpanded)delete e.matricesIndices._isExpanded,i.setVerticesData(Bt.MatricesIndicesExtraKind,e.matricesIndicesExtra,e.matricesIndicesExtra._updatable);else{for(y=[],v=0;v<e.matricesIndicesExtra.length;v++){S=e.matricesIndicesExtra[v];y.push(255&S),y.push((65280&S)>>8),y.push((16711680&S)>>16),y.push(S>>24&255)}i.setVerticesData(Bt.MatricesIndicesExtraKind,y,e.matricesIndicesExtra._updatable)}e.matricesWeights&&(t._CleanMatricesWeights(e,i),i.setVerticesData(Bt.MatricesWeightsKind,e.matricesWeights,e.matricesWeights._updatable)),e.matricesWeightsExtra&&i.setVerticesData(Bt.MatricesWeightsExtraKind,e.matricesWeightsExtra,e.matricesWeights._updatable),i.setIndices(e.indices,null)}if(e.subMeshes){i.subMeshes=[];for(var D=0;D<e.subMeshes.length;D++){var P=e.subMeshes[D];jt.AddToMesh(P.materialIndex,P.verticesStart,P.verticesCount,P.indexStart,P.indexCount,i)}}i._shouldGenerateFlatShading&&(i.convertToFlatShadedMesh(),i._shouldGenerateFlatShading=!1),i.computeWorldMatrix(!0),r.onMeshImportedObservable.notifyObservers(i)},t._CleanMatricesWeights=function(t,e){if(Gt.CleanBoneMatrixWeights){var i=0;if(t.skeletonId>-1){var r=e.getScene().getLastSkeletonByID(t.skeletonId);if(r){i=r.bones.length;for(var n=e.getVerticesData(Bt.MatricesIndicesKind),o=e.getVerticesData(Bt.MatricesIndicesExtraKind),s=t.matricesWeights,a=t.matricesWeightsExtra,u=t.numBoneInfluencer,h=s.length,l=0;l<h;l+=4){for(var c=0,f=-1,d=0;d<4;d++){c+=p=s[l+d],p<.001&&f<0&&(f=d)}if(a)for(d=0;d<4;d++){var p;c+=p=a[l+d],p<.001&&f<0&&(f=d+4)}if((f<0||f>u-1)&&(f=u-1),c>.001){var _=1/c;for(d=0;d<4;d++)s[l+d]*=_;if(a)for(d=0;d<4;d++)a[l+d]*=_}else f>=4?(a[l+f-4]=1-c,o[l+f-4]=i):(s[l+f]=1-c,n[l+f]=i)}e.setVerticesData(Bt.MatricesIndicesKind,n),t.matricesWeightsExtra&&e.setVerticesData(Bt.MatricesIndicesExtraKind,o)}}}},t.Parse=function(e,i,r){if(i.getGeometryByID(e.id))return null;var n=new t(e.id,i,void 0,e.updatable);return ct&&ct.AddTagsTo(n,e.tags),e.delayLoadingFile?(n.delayLoadState=4,n.delayLoadingFile=r+e.delayLoadingFile,n._boundingInfo=new Wt(_t.FromArray(e.boundingBoxMinimum),_t.FromArray(e.boundingBoxMaximum)),n._delayInfo=[],e.hasUVs&&n._delayInfo.push(Bt.UVKind),e.hasUVs2&&n._delayInfo.push(Bt.UV2Kind),e.hasUVs3&&n._delayInfo.push(Bt.UV3Kind),e.hasUVs4&&n._delayInfo.push(Bt.UV4Kind),e.hasUVs5&&n._delayInfo.push(Bt.UV5Kind),e.hasUVs6&&n._delayInfo.push(Bt.UV6Kind),e.hasColors&&n._delayInfo.push(Bt.ColorKind),e.hasMatricesIndices&&n._delayInfo.push(Bt.MatricesIndicesKind),e.hasMatricesWeights&&n._delayInfo.push(Bt.MatricesWeightsKind),n._delayLoadingFunction=wt.ImportVertexData):wt.ImportVertexData(e,n),i.pushGeometry(n,!0),n},t}(),Ht=function(){function t(t){void 0===t&&(t=30),this._enabled=!0,this._rollingFrameTime=new qt(t)}return t.prototype.sampleFrame=function(t){if(void 0===t&&(t=g.Now),this._enabled){if(null!=this._lastFrameTimeMs){var e=t-this._lastFrameTimeMs;this._rollingFrameTime.add(e)}this._lastFrameTimeMs=t}},Object.defineProperty(t.prototype,"averageFrameTime",{get:function(){return this._rollingFrameTime.average},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"averageFrameTimeVariance",{get:function(){return this._rollingFrameTime.variance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"instantaneousFrameTime",{get:function(){return this._rollingFrameTime.history(0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"averageFPS",{get:function(){return 1e3/this._rollingFrameTime.average},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"instantaneousFPS",{get:function(){var t=this._rollingFrameTime.history(0);return 0===t?0:1e3/t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSaturated",{get:function(){return this._rollingFrameTime.isSaturated()},enumerable:!1,configurable:!0}),t.prototype.enable=function(){this._enabled=!0},t.prototype.disable=function(){this._enabled=!1,this._lastFrameTimeMs=null},Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this._enabled},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()},t}(),qt=function(){function t(t){this._samples=new Array(t),this.reset()}return t.prototype.add=function(t){var e;if(this.isSaturated()){var i=this._samples[this._pos];e=i-this.average,this.average-=e/(this._sampleCount-1),this._m2-=e*(i-this.average)}else this._sampleCount++;e=t-this.average,this.average+=e/this._sampleCount,this._m2+=e*(t-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=t,this._pos++,this._pos%=this._samples.length},t.prototype.history=function(t){if(t>=this._sampleCount||t>=this._samples.length)return 0;var e=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(e-t)]},t.prototype.isSaturated=function(){return this._sampleCount>=this._samples.length},t.prototype.reset=function(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0},t.prototype._wrapPosition=function(t){var e=this._samples.length;return(t%e+e)%e},t}(),Yt=function(){function t(){this._startMonitoringTime=0,this._min=0,this._max=0,this._average=0,this._lastSecAverage=0,this._current=0,this._totalValueCount=0,this._totalAccumulated=0,this._lastSecAccumulated=0,this._lastSecTime=0,this._lastSecValueCount=0}return Object.defineProperty(t.prototype,"min",{get:function(){return this._min},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this._max},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"average",{get:function(){return this._average},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastSecAverage",{get:function(){return this._lastSecAverage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"current",{get:function(){return this._current},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"total",{get:function(){return this._totalAccumulated},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this._totalValueCount},enumerable:!1,configurable:!0}),t.prototype.fetchNewFrame=function(){this._totalValueCount++,this._current=0,this._lastSecValueCount++},t.prototype.addCount=function(e,i){t.Enabled&&(this._current+=e,i&&this._fetchResult())},t.prototype.beginMonitoring=function(){t.Enabled&&(this._startMonitoringTime=g.Now)},t.prototype.endMonitoring=function(e){if(void 0===e&&(e=!0),t.Enabled){e&&this.fetchNewFrame();var i=g.Now;this._current=i-this._startMonitoringTime,e&&this._fetchResult()}},t.prototype._fetchResult=function(){this._totalAccumulated+=this._current,this._lastSecAccumulated+=this._current,this._min=Math.min(this._min,this._current),this._max=Math.max(this._max,this._current),this._average=this._totalAccumulated/this._totalValueCount;var t=g.Now;t-this._lastSecTime>1e3&&(this._lastSecAverage=this._lastSecAccumulated/this._lastSecValueCount,this._lastSecTime=t,this._lastSecAccumulated=0,this._lastSecValueCount=0)},t.Enabled=!0,t}();Q.prototype.setAlphaConstants=function(t,e,i,r){this._alphaState.setAlphaBlendConstants(t,e,i,r)},Q.prototype.setAlphaMode=function(t,e){if(void 0===e&&(e=!1),this._alphaMode!==t){switch(t){case 0:this._alphaState.alphaBlend=!1;break;case 7:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 8:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 2:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 6:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 1:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 3:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ZERO,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 4:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_COLOR,this._gl.ZERO,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 5:this._alphaState.setAlphaBlendFunctionParameters(this._gl.SRC_ALPHA,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 9:this._alphaState.setAlphaBlendFunctionParameters(this._gl.CONSTANT_COLOR,this._gl.ONE_MINUS_CONSTANT_COLOR,this._gl.CONSTANT_ALPHA,this._gl.ONE_MINUS_CONSTANT_ALPHA),this._alphaState.alphaBlend=!0;break;case 10:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 11:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ONE),this._alphaState.alphaBlend=!0;break;case 12:this._alphaState.setAlphaBlendFunctionParameters(this._gl.DST_ALPHA,this._gl.ONE,this._gl.ZERO,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 13:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ONE_MINUS_DST_ALPHA,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 14:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA,this._gl.ONE,this._gl.ONE_MINUS_SRC_ALPHA),this._alphaState.alphaBlend=!0;break;case 15:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE,this._gl.ONE,this._gl.ONE,this._gl.ZERO),this._alphaState.alphaBlend=!0;break;case 16:this._alphaState.setAlphaBlendFunctionParameters(this._gl.ONE_MINUS_DST_COLOR,this._gl.ONE_MINUS_SRC_COLOR,this._gl.ZERO,this._gl.ONE),this._alphaState.alphaBlend=!0}e||(this.depthCullingState.depthMask=0===t),this._alphaMode=t}},Q.prototype.getAlphaMode=function(){return this._alphaMode},Q.prototype.setAlphaEquation=function(t){if(this._alphaEquation!==t){switch(t){case 0:this._alphaState.setAlphaEquationParameters(this._gl.FUNC_ADD,this._gl.FUNC_ADD);break;case 1:this._alphaState.setAlphaEquationParameters(this._gl.FUNC_SUBTRACT,this._gl.FUNC_SUBTRACT);break;case 2:this._alphaState.setAlphaEquationParameters(this._gl.FUNC_REVERSE_SUBTRACT,this._gl.FUNC_REVERSE_SUBTRACT);break;case 3:this._alphaState.setAlphaEquationParameters(this._gl.MAX,this._gl.MAX);break;case 4:this._alphaState.setAlphaEquationParameters(this._gl.MIN,this._gl.MIN);break;case 5:this._alphaState.setAlphaEquationParameters(this._gl.MIN,this._gl.FUNC_ADD)}this._alphaEquation=t}},Q.prototype.getAlphaEquation=function(){return this._alphaEquation},Q.prototype._readTexturePixels=function(t,e,i,r,n,o){void 0===r&&(r=-1),void 0===n&&(n=0),void 0===o&&(o=null);var s=this._gl;if(!s)throw new Error("Engine does not have gl rendering context.");if(!this._dummyFramebuffer){var a=s.createFramebuffer();if(!a)throw new Error("Unable to create dummy framebuffer");this._dummyFramebuffer=a}s.bindFramebuffer(s.FRAMEBUFFER,this._dummyFramebuffer),r>-1?s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+r,t._webGLTexture,n):s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,t._webGLTexture,n);var u=void 0!==t.type?this._getWebGLTextureType(t.type):s.UNSIGNED_BYTE;switch(u){case s.UNSIGNED_BYTE:o||(o=new Uint8Array(4*e*i)),u=s.UNSIGNED_BYTE;break;default:o||(o=new Float32Array(4*e*i)),u=s.FLOAT}return s.readPixels(0,0,e,i,s.RGBA,u,o),s.bindFramebuffer(s.FRAMEBUFFER,this._currentFramebuffer),o},Q.prototype.updateDynamicIndexBuffer=function(t,e,i){var r;void 0===i&&(i=0),this._currentBoundBuffer[this._gl.ELEMENT_ARRAY_BUFFER]=null,this.bindIndexBuffer(t),r=e instanceof Uint16Array||e instanceof Uint32Array?e:t.is32Bits?new Uint32Array(e):new Uint16Array(e),this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER,r,this._gl.DYNAMIC_DRAW),this._resetIndexBufferBinding()},Q.prototype.updateDynamicVertexBuffer=function(t,e,i,r){this.bindArrayBuffer(t),void 0===i&&(i=0);var n=e.length||e.byteLength;void 0===r||r>=n&&0===i?e instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,new Float32Array(e)):this._gl.bufferSubData(this._gl.ARRAY_BUFFER,i,e):e instanceof Array?this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,new Float32Array(e).subarray(i,i+r)):(e=e instanceof ArrayBuffer?new Uint8Array(e,i,r):new Uint8Array(e.buffer,e.byteOffset+i,r),this._gl.bufferSubData(this._gl.ARRAY_BUFFER,0,e)),this._resetVertexBufferBinding()};var Qt,Zt=function(t){function e(i,r,n,o){void 0===o&&(o=!1);var s=t.call(this,i,r,n,o)||this;if(s.enableOfflineSupport=!1,s.disableManifestCheck=!1,s.scenes=new Array,s.onNewSceneAddedObservable=new l,s.postProcesses=new Array,s.isPointerLock=!1,s.onResizeObservable=new l,s.onCanvasBlurObservable=new l,s.onCanvasFocusObservable=new l,s.onCanvasPointerOutObservable=new l,s.onBeginFrameObservable=new l,s.customAnimationFrameRequester=null,s.onEndFrameObservable=new l,s.onBeforeShaderCompilationObservable=new l,s.onAfterShaderCompilationObservable=new l,s._deterministicLockstep=!1,s._lockstepMaxSteps=4,s._timeStep=1/60,s._fps=60,s._deltaTime=0,s._drawCalls=new Yt,s.canvasTabIndex=1,s.disablePerformanceMonitorInBackground=!1,s._performanceMonitor=new Ht,e.Instances.push(s),!i)return s;if(n=s._creationOptions,i.getContext){var a=i;if(s._onCanvasFocus=function(){s.onCanvasFocusObservable.notifyObservers(s)},s._onCanvasBlur=function(){s.onCanvasBlurObservable.notifyObservers(s)},a.addEventListener("focus",s._onCanvasFocus),a.addEventListener("blur",s._onCanvasBlur),s._onBlur=function(){s.disablePerformanceMonitorInBackground&&s._performanceMonitor.disable(),s._windowIsBackground=!0},s._onFocus=function(){s.disablePerformanceMonitorInBackground&&s._performanceMonitor.enable(),s._windowIsBackground=!1},s._onCanvasPointerOut=function(t){s.onCanvasPointerOutObservable.notifyObservers(t)},a.addEventListener("pointerout",s._onCanvasPointerOut),c.IsWindowObjectExist()){var u=s.getHostWindow();u.addEventListener("blur",s._onBlur),u.addEventListener("focus",s._onFocus);var h=document;s._onFullscreenChange=function(){void 0!==h.fullscreen?s.isFullscreen=h.fullscreen:void 0!==h.mozFullScreen?s.isFullscreen=h.mozFullScreen:void 0!==h.webkitIsFullScreen?s.isFullscreen=h.webkitIsFullScreen:void 0!==h.msIsFullScreen&&(s.isFullscreen=h.msIsFullScreen),s.isFullscreen&&s._pointerLockRequested&&a&&e._RequestPointerlock(a)},document.addEventListener("fullscreenchange",s._onFullscreenChange,!1),document.addEventListener("mozfullscreenchange",s._onFullscreenChange,!1),document.addEventListener("webkitfullscreenchange",s._onFullscreenChange,!1),document.addEventListener("msfullscreenchange",s._onFullscreenChange,!1),s._onPointerLockChange=function(){s.isPointerLock=h.mozPointerLockElement===a||h.webkitPointerLockElement===a||h.msPointerLockElement===a||h.pointerLockElement===a},document.addEventListener("pointerlockchange",s._onPointerLockChange,!1),document.addEventListener("mspointerlockchange",s._onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",s._onPointerLockChange,!1),document.addEventListener("webkitpointerlockchange",s._onPointerLockChange,!1),!e.audioEngine&&n.audioEngine&&e.AudioEngineFactory&&(e.audioEngine=e.AudioEngineFactory(s.getRenderingCanvas()))}s._connectVREvents(),s.enableOfflineSupport=void 0!==e.OfflineProviderFactory,n.doNotHandleTouchAction||s._disableTouchAction(),s._deterministicLockstep=!!n.deterministicLockstep,s._lockstepMaxSteps=n.lockstepMaxSteps||0,s._timeStep=n.timeStep||1/60}return s._prepareVRComponent(),n.autoEnableWebVR&&s.initWebVR(),s}return n(e,t),Object.defineProperty(e,"NpmPackage",{get:function(){return Q.NpmPackage},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Version",{get:function(){return Q.Version},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Instances",{get:function(){return b.Instances},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastCreatedEngine",{get:function(){return b.LastCreatedEngine},enumerable:!1,configurable:!0}),Object.defineProperty(e,"LastCreatedScene",{get:function(){return b.LastCreatedScene},enumerable:!1,configurable:!0}),e.MarkAllMaterialsAsDirty=function(t,i){for(var r=0;r<e.Instances.length;r++)for(var n=e.Instances[r],o=0;o<n.scenes.length;o++)n.scenes[o].markAllMaterialsAsDirty(t,i)},e.DefaultLoadingScreenFactory=function(t){throw m.WarnImport("LoadingScreen")},Object.defineProperty(e.prototype,"_supportsHardwareTextureRescaling",{get:function(){return!!e._RescalePostProcessFactory},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"performanceMonitor",{get:function(){return this._performanceMonitor},enumerable:!1,configurable:!0}),e.prototype.getInputElement=function(){return this._renderingCanvas},e.prototype.getAspectRatio=function(t,e){void 0===e&&(e=!1);var i=t.viewport;return this.getRenderWidth(e)*i.width/(this.getRenderHeight(e)*i.height)},e.prototype.getScreenAspectRatio=function(){return this.getRenderWidth(!0)/this.getRenderHeight(!0)},e.prototype.getRenderingCanvasClientRect=function(){return this._renderingCanvas?this._renderingCanvas.getBoundingClientRect():null},e.prototype.getInputElementClientRect=function(){return this._renderingCanvas?this.getInputElement().getBoundingClientRect():null},e.prototype.isDeterministicLockStep=function(){return this._deterministicLockstep},e.prototype.getLockstepMaxSteps=function(){return this._lockstepMaxSteps},e.prototype.getTimeStep=function(){return 1e3*this._timeStep},e.prototype.generateMipMapsForCubemap=function(t,e){if(void 0===e&&(e=!0),t.generateMipMaps){var i=this._gl;this._bindTextureDirectly(i.TEXTURE_CUBE_MAP,t,!0),i.generateMipmap(i.TEXTURE_CUBE_MAP),e&&this._bindTextureDirectly(i.TEXTURE_CUBE_MAP,null)}},e.prototype.setState=function(t,e,i,r){void 0===e&&(e=0),void 0===r&&(r=!1),(this._depthCullingState.cull!==t||i)&&(this._depthCullingState.cull=t);var n=this.cullBackFaces?this._gl.BACK:this._gl.FRONT;(this._depthCullingState.cullFace!==n||i)&&(this._depthCullingState.cullFace=n),this.setZOffset(e);var o=r?this._gl.CW:this._gl.CCW;(this._depthCullingState.frontFace!==o||i)&&(this._depthCullingState.frontFace=o)},e.prototype.setZOffset=function(t){this._depthCullingState.zOffset=t},e.prototype.getZOffset=function(){return this._depthCullingState.zOffset},e.prototype.setDepthBuffer=function(t){this._depthCullingState.depthTest=t},e.prototype.getDepthWrite=function(){return this._depthCullingState.depthMask},e.prototype.setDepthWrite=function(t){this._depthCullingState.depthMask=t},e.prototype.getStencilBuffer=function(){return this._stencilState.stencilTest},e.prototype.setStencilBuffer=function(t){this._stencilState.stencilTest=t},e.prototype.getStencilMask=function(){return this._stencilState.stencilMask},e.prototype.setStencilMask=function(t){this._stencilState.stencilMask=t},e.prototype.getStencilFunction=function(){return this._stencilState.stencilFunc},e.prototype.getStencilFunctionReference=function(){return this._stencilState.stencilFuncRef},e.prototype.getStencilFunctionMask=function(){return this._stencilState.stencilFuncMask},e.prototype.setStencilFunction=function(t){this._stencilState.stencilFunc=t},e.prototype.setStencilFunctionReference=function(t){this._stencilState.stencilFuncRef=t},e.prototype.setStencilFunctionMask=function(t){this._stencilState.stencilFuncMask=t},e.prototype.getStencilOperationFail=function(){return this._stencilState.stencilOpStencilFail},e.prototype.getStencilOperationDepthFail=function(){return this._stencilState.stencilOpDepthFail},e.prototype.getStencilOperationPass=function(){return this._stencilState.stencilOpStencilDepthPass},e.prototype.setStencilOperationFail=function(t){this._stencilState.stencilOpStencilFail=t},e.prototype.setStencilOperationDepthFail=function(t){this._stencilState.stencilOpDepthFail=t},e.prototype.setStencilOperationPass=function(t){this._stencilState.stencilOpStencilDepthPass=t},e.prototype.setDitheringState=function(t){t?this._gl.enable(this._gl.DITHER):this._gl.disable(this._gl.DITHER)},e.prototype.setRasterizerState=function(t){t?this._gl.disable(this._gl.RASTERIZER_DISCARD):this._gl.enable(this._gl.RASTERIZER_DISCARD)},e.prototype.getDepthFunction=function(){return this._depthCullingState.depthFunc},e.prototype.setDepthFunction=function(t){this._depthCullingState.depthFunc=t},e.prototype.setDepthFunctionToGreater=function(){this._depthCullingState.depthFunc=this._gl.GREATER},e.prototype.setDepthFunctionToGreaterOrEqual=function(){this._depthCullingState.depthFunc=this._gl.GEQUAL},e.prototype.setDepthFunctionToLess=function(){this._depthCullingState.depthFunc=this._gl.LESS},e.prototype.setDepthFunctionToLessOrEqual=function(){this._depthCullingState.depthFunc=this._gl.LEQUAL},e.prototype.cacheStencilState=function(){this._cachedStencilBuffer=this.getStencilBuffer(),this._cachedStencilFunction=this.getStencilFunction(),this._cachedStencilMask=this.getStencilMask(),this._cachedStencilOperationPass=this.getStencilOperationPass(),this._cachedStencilOperationFail=this.getStencilOperationFail(),this._cachedStencilOperationDepthFail=this.getStencilOperationDepthFail(),this._cachedStencilReference=this.getStencilFunctionReference()},e.prototype.restoreStencilState=function(){this.setStencilFunction(this._cachedStencilFunction),this.setStencilMask(this._cachedStencilMask),this.setStencilBuffer(this._cachedStencilBuffer),this.setStencilOperationPass(this._cachedStencilOperationPass),this.setStencilOperationFail(this._cachedStencilOperationFail),this.setStencilOperationDepthFail(this._cachedStencilOperationDepthFail),this.setStencilFunctionReference(this._cachedStencilReference)},e.prototype.setDirectViewport=function(t,e,i,r){var n=this._cachedViewport;return this._cachedViewport=null,this._viewport(t,e,i,r),n},e.prototype.scissorClear=function(t,e,i,r,n){this.enableScissor(t,e,i,r),this.clear(n,!0,!0,!0),this.disableScissor()},e.prototype.enableScissor=function(t,e,i,r){var n=this._gl;n.enable(n.SCISSOR_TEST),n.scissor(t,e,i,r)},e.prototype.disableScissor=function(){var t=this._gl;t.disable(t.SCISSOR_TEST)},e.prototype._reportDrawCall=function(){this._drawCalls.addCount(1,!1)},e.prototype.initWebVR=function(){throw m.WarnImport("WebVRCamera")},e.prototype._prepareVRComponent=function(){},e.prototype._connectVREvents=function(t,e){},e.prototype._submitVRFrame=function(){},e.prototype.disableVR=function(){},e.prototype.isVRPresenting=function(){return!1},e.prototype._requestVRFrame=function(){},e.prototype._loadFileAsync=function(t,e,i){var r=this;return new Promise((function(n,o){r._loadFile(t,(function(t){n(t)}),void 0,e,i,(function(t,e){o(e)}))}))},e.prototype.getVertexShaderSource=function(t){var e=this._gl.getAttachedShaders(t);return e?this._gl.getShaderSource(e[0]):null},e.prototype.getFragmentShaderSource=function(t){var e=this._gl.getAttachedShaders(t);return e?this._gl.getShaderSource(e[1]):null},e.prototype.setDepthStencilTexture=function(t,e,i){void 0!==t&&(e&&(this._boundUniforms[t]=e),i&&i.depthStencilTexture?this._setTexture(t,i,!1,!0):this._setTexture(t,null))},e.prototype.setTextureFromPostProcess=function(t,e){this._bindTexture(t,e?e._textures.data[e._currentRenderTextureInd]:null)},e.prototype.setTextureFromPostProcessOutput=function(t,e){this._bindTexture(t,e?e._outputTexture:null)},e.prototype._rebuildBuffers=function(){for(var e=0,i=this.scenes;e<i.length;e++){var r=i[e];r.resetCachedMaterial(),r._rebuildGeometries(),r._rebuildTextures()}t.prototype._rebuildBuffers.call(this)},e.prototype._renderFrame=function(){for(var t=0;t<this._activeRenderLoops.length;t++){(0,this._activeRenderLoops[t])()}},e.prototype._renderLoop=function(){if(!this._contextWasLost){var t=!0;!this.renderEvenInBackground&&this._windowIsBackground&&(t=!1),t&&(this.beginFrame(),this._renderViews()||this._renderFrame(),this.endFrame())}this._activeRenderLoops.length>0?this.customAnimationFrameRequester?(this.customAnimationFrameRequester.requestID=this._queueNewFrame(this.customAnimationFrameRequester.renderFunction||this._boundRenderFunction,this.customAnimationFrameRequester),this._frameHandler=this.customAnimationFrameRequester.requestID):this.isVRPresenting()?this._requestVRFrame():this._frameHandler=this._queueNewFrame(this._boundRenderFunction,this.getHostWindow()):this._renderingQueueLaunched=!1},e.prototype._renderViews=function(){return!1},e.prototype.switchFullscreen=function(t){this.isFullscreen?this.exitFullscreen():this.enterFullscreen(t)},e.prototype.enterFullscreen=function(t){this.isFullscreen||(this._pointerLockRequested=t,this._renderingCanvas&&e._RequestFullscreen(this._renderingCanvas))},e.prototype.exitFullscreen=function(){this.isFullscreen&&e._ExitFullscreen()},e.prototype.enterPointerlock=function(){this._renderingCanvas&&e._RequestPointerlock(this._renderingCanvas)},e.prototype.exitPointerlock=function(){e._ExitPointerlock()},e.prototype.beginFrame=function(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this),t.prototype.beginFrame.call(this)},e.prototype.endFrame=function(){t.prototype.endFrame.call(this),this._submitVRFrame(),this.onEndFrameObservable.notifyObservers(this)},e.prototype.resize=function(){this.isVRPresenting()||t.prototype.resize.call(this)},e.prototype.setSize=function(e,i){if(!this._renderingCanvas)return!1;if(!t.prototype.setSize.call(this,e,i))return!1;if(this.scenes){for(var r=0;r<this.scenes.length;r++)for(var n=this.scenes[r],o=0;o<n.cameras.length;o++){n.cameras[o]._currentRenderId=0}this.onResizeObservable.hasObservers()&&this.onResizeObservable.notifyObservers(this)}return!0},e.prototype._deletePipelineContext=function(e){var i=e;i&&i.program&&i.transformFeedback&&(this.deleteTransformFeedback(i.transformFeedback),i.transformFeedback=null),t.prototype._deletePipelineContext.call(this,e)},e.prototype.createShaderProgram=function(e,i,r,n,o,s){void 0===s&&(s=null),o=o||this._gl,this.onBeforeShaderCompilationObservable.notifyObservers(this);var a=t.prototype.createShaderProgram.call(this,e,i,r,n,o,s);return this.onAfterShaderCompilationObservable.notifyObservers(this),a},e.prototype._createShaderProgram=function(t,e,i,r,n){void 0===n&&(n=null);var o=r.createProgram();if(t.program=o,!o)throw new Error("Unable to create program");if(r.attachShader(o,e),r.attachShader(o,i),this.webGLVersion>1&&n){var s=this.createTransformFeedback();this.bindTransformFeedback(s),this.setTranformFeedbackVaryings(o,n),t.transformFeedback=s}return r.linkProgram(o),this.webGLVersion>1&&n&&this.bindTransformFeedback(null),t.context=r,t.vertexShader=e,t.fragmentShader=i,t.isParallelCompiled||this._finalizePipelineContext(t),o},e.prototype._releaseTexture=function(e){t.prototype._releaseTexture.call(this,e),this.scenes.forEach((function(t){t.postProcesses.forEach((function(t){t._outputTexture==e&&(t._outputTexture=null)})),t.cameras.forEach((function(t){t._postProcesses.forEach((function(t){t&&t._outputTexture==e&&(t._outputTexture=null)}))}))}))},e.prototype._rescaleTexture=function(t,i,r,n,o){var s=this;this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MAG_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_MIN_FILTER,this._gl.LINEAR),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_S,this._gl.CLAMP_TO_EDGE),this._gl.texParameteri(this._gl.TEXTURE_2D,this._gl.TEXTURE_WRAP_T,this._gl.CLAMP_TO_EDGE);var a=this.createRenderTargetTexture({width:i.width,height:i.height},{generateMipMaps:!1,type:0,samplingMode:2,generateDepthBuffer:!1,generateStencilBuffer:!1});!this._rescalePostProcess&&e._RescalePostProcessFactory&&(this._rescalePostProcess=e._RescalePostProcessFactory(this)),this._rescalePostProcess.getEffect().executeWhenCompiled((function(){s._rescalePostProcess.onApply=function(e){e._bindTexture("textureSampler",t)};var e=r;e||(e=s.scenes[s.scenes.length-1]),e.postProcessManager.directRender([s._rescalePostProcess],a,!0),s._bindTextureDirectly(s._gl.TEXTURE_2D,i,!0),s._gl.copyTexImage2D(s._gl.TEXTURE_2D,0,n,0,0,i.width,i.height,0),s.unBindFramebuffer(a),s._releaseTexture(a),o&&o()}))},e.prototype.getFps=function(){return this._fps},e.prototype.getDeltaTime=function(){return this._deltaTime},e.prototype._measureFps=function(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0},e.prototype._uploadImageToTexture=function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var n=this._gl,o=this._getWebGLTextureType(t.type),s=this._getInternalFormat(t.format),a=this._getRGBABufferInternalSizedFormat(t.type,s),u=t.isCube?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D;this._bindTextureDirectly(u,t,!0),this._unpackFlipY(t.invertY);var h=n.TEXTURE_2D;t.isCube&&(h=n.TEXTURE_CUBE_MAP_POSITIVE_X+i),n.texImage2D(h,r,a,s,o,e),this._bindTextureDirectly(u,null,!0)},e.prototype.updateRenderTargetTextureSampleCount=function(t,e){if(this.webGLVersion<2||!t)return 1;if(t.samples===e)return e;var i=this._gl;if(e=Math.min(e,this.getCaps().maxMSAASamples),t._depthStencilBuffer&&(i.deleteRenderbuffer(t._depthStencilBuffer),t._depthStencilBuffer=null),t._MSAAFramebuffer&&(i.deleteFramebuffer(t._MSAAFramebuffer),t._MSAAFramebuffer=null),t._MSAARenderBuffer&&(i.deleteRenderbuffer(t._MSAARenderBuffer),t._MSAARenderBuffer=null),e>1&&i.renderbufferStorageMultisample){var r=i.createFramebuffer();if(!r)throw new Error("Unable to create multi sampled framebuffer");t._MSAAFramebuffer=r,this._bindUnboundFramebuffer(t._MSAAFramebuffer);var n=i.createRenderbuffer();if(!n)throw new Error("Unable to create multi sampled framebuffer");i.bindRenderbuffer(i.RENDERBUFFER,n),i.renderbufferStorageMultisample(i.RENDERBUFFER,e,this._getRGBAMultiSampleBufferFormat(t.type),t.width,t.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,n),t._MSAARenderBuffer=n}else this._bindUnboundFramebuffer(t._framebuffer);return t.samples=e,t._depthStencilBuffer=this._setupFramebufferDepthAttachments(t._generateStencilBuffer,t._generateDepthBuffer,t.width,t.height,e),this._bindUnboundFramebuffer(null),e},e.prototype.updateTextureComparisonFunction=function(t,e){if(1!==this.webGLVersion){var i=this._gl;t.isCube?(this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,t,!0),0===e?(i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_FUNC,515),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_MODE,i.NONE)):(i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_FUNC,e),i.texParameteri(i.TEXTURE_CUBE_MAP,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_CUBE_MAP,null)):(this._bindTextureDirectly(this._gl.TEXTURE_2D,t,!0),0===e?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_FUNC,515),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_MODE,i.NONE)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_FUNC,e),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE)),this._bindTextureDirectly(this._gl.TEXTURE_2D,null)),t._comparisonFunction=e}else f.Error("WebGL 1 does not support texture comparison.")},e.prototype.createInstancesBuffer=function(t){var e=this._gl.createBuffer();if(!e)throw new Error("Unable to create instance buffer");var i=new G(e);return i.capacity=t,this.bindArrayBuffer(i),this._gl.bufferData(this._gl.ARRAY_BUFFER,t,this._gl.DYNAMIC_DRAW),i},e.prototype.deleteInstancesBuffer=function(t){this._gl.deleteBuffer(t)},e.prototype._clientWaitAsync=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=10);var r=this._gl;return new Promise((function(n,o){var s=function(){var a=r.clientWaitSync(t,e,0);a!=r.WAIT_FAILED?a!=r.TIMEOUT_EXPIRED?n():setTimeout(s,i):o()};s()}))},e.prototype._readPixelsAsync=function(t,e,i,r,n,o,s){if(this._webGLVersion<2)throw new Error("_readPixelsAsync only work on WebGL2+");var a=this._gl,u=a.createBuffer();a.bindBuffer(a.PIXEL_PACK_BUFFER,u),a.bufferData(a.PIXEL_PACK_BUFFER,s.byteLength,a.STREAM_READ),a.readPixels(t,e,i,r,n,o,0),a.bindBuffer(a.PIXEL_PACK_BUFFER,null);var h=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);return h?(a.flush(),this._clientWaitAsync(h,0,10).then((function(){return a.deleteSync(h),a.bindBuffer(a.PIXEL_PACK_BUFFER,u),a.getBufferSubData(a.PIXEL_PACK_BUFFER,0,s),a.bindBuffer(a.PIXEL_PACK_BUFFER,null),a.deleteBuffer(u),s}))):null},e.prototype.dispose=function(){for(this.hideLoadingUI(),this.onNewSceneAddedObservable.clear();this.postProcesses.length;)this.postProcesses[0].dispose();for(this._rescalePostProcess&&this._rescalePostProcess.dispose();this.scenes.length;)this.scenes[0].dispose();1===e.Instances.length&&e.audioEngine&&e.audioEngine.dispose(),this.disableVR(),c.IsWindowObjectExist()&&(window.removeEventListener("blur",this._onBlur),window.removeEventListener("focus",this._onFocus),this._renderingCanvas&&(this._renderingCanvas.removeEventListener("focus",this._onCanvasFocus),this._renderingCanvas.removeEventListener("blur",this._onCanvasBlur),this._renderingCanvas.removeEventListener("pointerout",this._onCanvasPointerOut)),c.IsDocumentAvailable()&&(document.removeEventListener("fullscreenchange",this._onFullscreenChange),document.removeEventListener("mozfullscreenchange",this._onFullscreenChange),document.removeEventListener("webkitfullscreenchange",this._onFullscreenChange),document.removeEventListener("msfullscreenchange",this._onFullscreenChange),document.removeEventListener("pointerlockchange",this._onPointerLockChange),document.removeEventListener("mspointerlockchange",this._onPointerLockChange),document.removeEventListener("mozpointerlockchange",this._onPointerLockChange),document.removeEventListener("webkitpointerlockchange",this._onPointerLockChange))),t.prototype.dispose.call(this);var i=e.Instances.indexOf(this);i>=0&&e.Instances.splice(i,1),this.onResizeObservable.clear(),this.onCanvasBlurObservable.clear(),this.onCanvasFocusObservable.clear(),this.onCanvasPointerOutObservable.clear(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear()},e.prototype._disableTouchAction=function(){this._renderingCanvas&&this._renderingCanvas.setAttribute&&(this._renderingCanvas.setAttribute("touch-action","none"),this._renderingCanvas.style.touchAction="none",this._renderingCanvas.style.msTouchAction="none")},e.prototype.displayLoadingUI=function(){if(c.IsWindowObjectExist()){var t=this.loadingScreen;t&&t.displayLoadingUI()}},e.prototype.hideLoadingUI=function(){if(c.IsWindowObjectExist()){var t=this._loadingScreen;t&&t.hideLoadingUI()}},Object.defineProperty(e.prototype,"loadingScreen",{get:function(){return!this._loadingScreen&&this._renderingCanvas&&(this._loadingScreen=e.DefaultLoadingScreenFactory(this._renderingCanvas)),this._loadingScreen},set:function(t){this._loadingScreen=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loadingUIText",{set:function(t){this.loadingScreen.loadingUIText=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loadingUIBackgroundColor",{set:function(t){this.loadingScreen.loadingUIBackgroundColor=t},enumerable:!1,configurable:!0}),e._RequestPointerlock=function(t){t.requestPointerLock=t.requestPointerLock||t.msRequestPointerLock||t.mozRequestPointerLock||t.webkitRequestPointerLock,t.requestPointerLock&&t.requestPointerLock()},e._ExitPointerlock=function(){var t=document;document.exitPointerLock=document.exitPointerLock||t.msExitPointerLock||t.mozExitPointerLock||t.webkitExitPointerLock,document.exitPointerLock&&document.exitPointerLock()},e._RequestFullscreen=function(t){var e=t.requestFullscreen||t.msRequestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullScreen;e&&e.call(t)},e._ExitFullscreen=function(){var t=document;document.exitFullscreen?document.exitFullscreen():t.mozCancelFullScreen?t.mozCancelFullScreen():t.webkitCancelFullScreen?t.webkitCancelFullScreen():t.msCancelFullScreen&&t.msCancelFullScreen()},e.ALPHA_DISABLE=0,e.ALPHA_ADD=1,e.ALPHA_COMBINE=2,e.ALPHA_SUBTRACT=3,e.ALPHA_MULTIPLY=4,e.ALPHA_MAXIMIZED=5,e.ALPHA_ONEONE=6,e.ALPHA_PREMULTIPLIED=7,e.ALPHA_PREMULTIPLIED_PORTERDUFF=8,e.ALPHA_INTERPOLATE=9,e.ALPHA_SCREENMODE=10,e.DELAYLOADSTATE_NONE=0,e.DELAYLOADSTATE_LOADED=1,e.DELAYLOADSTATE_LOADING=2,e.DELAYLOADSTATE_NOTLOADED=4,e.NEVER=512,e.ALWAYS=519,e.LESS=513,e.EQUAL=514,e.LEQUAL=515,e.GREATER=516,e.GEQUAL=518,e.NOTEQUAL=517,e.KEEP=7680,e.REPLACE=7681,e.INCR=7682,e.DECR=7683,e.INVERT=5386,e.INCR_WRAP=34055,e.DECR_WRAP=34056,e.TEXTURE_CLAMP_ADDRESSMODE=0,e.TEXTURE_WRAP_ADDRESSMODE=1,e.TEXTURE_MIRROR_ADDRESSMODE=2,e.TEXTUREFORMAT_ALPHA=0,e.TEXTUREFORMAT_LUMINANCE=1,e.TEXTUREFORMAT_LUMINANCE_ALPHA=2,e.TEXTUREFORMAT_RGB=4,e.TEXTUREFORMAT_RGBA=5,e.TEXTUREFORMAT_RED=6,e.TEXTUREFORMAT_R=6,e.TEXTUREFORMAT_RG=7,e.TEXTUREFORMAT_RED_INTEGER=8,e.TEXTUREFORMAT_R_INTEGER=8,e.TEXTUREFORMAT_RG_INTEGER=9,e.TEXTUREFORMAT_RGB_INTEGER=10,e.TEXTUREFORMAT_RGBA_INTEGER=11,e.TEXTURETYPE_UNSIGNED_BYTE=0,e.TEXTURETYPE_UNSIGNED_INT=0,e.TEXTURETYPE_FLOAT=1,e.TEXTURETYPE_HALF_FLOAT=2,e.TEXTURETYPE_BYTE=3,e.TEXTURETYPE_SHORT=4,e.TEXTURETYPE_UNSIGNED_SHORT=5,e.TEXTURETYPE_INT=6,e.TEXTURETYPE_UNSIGNED_INTEGER=7,e.TEXTURETYPE_UNSIGNED_SHORT_4_4_4_4=8,e.TEXTURETYPE_UNSIGNED_SHORT_5_5_5_1=9,e.TEXTURETYPE_UNSIGNED_SHORT_5_6_5=10,e.TEXTURETYPE_UNSIGNED_INT_2_10_10_10_REV=11,e.TEXTURETYPE_UNSIGNED_INT_24_8=12,e.TEXTURETYPE_UNSIGNED_INT_10F_11F_11F_REV=13,e.TEXTURETYPE_UNSIGNED_INT_5_9_9_9_REV=14,e.TEXTURETYPE_FLOAT_32_UNSIGNED_INT_24_8_REV=15,e.TEXTURE_NEAREST_SAMPLINGMODE=1,e.TEXTURE_BILINEAR_SAMPLINGMODE=2,e.TEXTURE_TRILINEAR_SAMPLINGMODE=3,e.TEXTURE_NEAREST_NEAREST_MIPLINEAR=8,e.TEXTURE_LINEAR_LINEAR_MIPNEAREST=11,e.TEXTURE_LINEAR_LINEAR_MIPLINEAR=3,e.TEXTURE_NEAREST_NEAREST_MIPNEAREST=4,e.TEXTURE_NEAREST_LINEAR_MIPNEAREST=5,e.TEXTURE_NEAREST_LINEAR_MIPLINEAR=6,e.TEXTURE_NEAREST_LINEAR=7,e.TEXTURE_NEAREST_NEAREST=1,e.TEXTURE_LINEAR_NEAREST_MIPNEAREST=9,e.TEXTURE_LINEAR_NEAREST_MIPLINEAR=10,e.TEXTURE_LINEAR_LINEAR=2,e.TEXTURE_LINEAR_NEAREST=12,e.TEXTURE_EXPLICIT_MODE=0,e.TEXTURE_SPHERICAL_MODE=1,e.TEXTURE_PLANAR_MODE=2,e.TEXTURE_CUBIC_MODE=3,e.TEXTURE_PROJECTION_MODE=4,e.TEXTURE_SKYBOX_MODE=5,e.TEXTURE_INVCUBIC_MODE=6,e.TEXTURE_EQUIRECTANGULAR_MODE=7,e.TEXTURE_FIXED_EQUIRECTANGULAR_MODE=8,e.TEXTURE_FIXED_EQUIRECTANGULAR_MIRRORED_MODE=9,e.SCALEMODE_FLOOR=1,e.SCALEMODE_NEAREST=2,e.SCALEMODE_CEILING=3,e._RescalePostProcessFactory=null,e}(Q);!function(t){t[t.LOCAL=0]="LOCAL",t[t.WORLD=1]="WORLD",t[t.BONE=2]="BONE"}(Qt||(Qt={}));var Jt,$t=function(){function t(){}return t.X=new _t(1,0,0),t.Y=new _t(0,1,0),t.Z=new _t(0,0,1),t}();!function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.Z=2]="Z"}(Jt||(Jt={}));var te=function(t){function e(i,r,n){void 0===r&&(r=null),void 0===n&&(n=!0);var o=t.call(this,i,r)||this;return o._forward=new _t(0,0,1),o._forwardInverted=new _t(0,0,-1),o._up=new _t(0,1,0),o._right=new _t(1,0,0),o._rightInverted=new _t(-1,0,0),o._position=_t.Zero(),o._rotation=_t.Zero(),o._rotationQuaternion=null,o._scaling=_t.One(),o._isDirty=!1,o._transformToBoneReferal=null,o._isAbsoluteSynced=!1,o._billboardMode=e.BILLBOARDMODE_NONE,o._preserveParentRotationForBillboard=!1,o.scalingDeterminant=1,o._infiniteDistance=!1,o.ignoreNonUniformScaling=!1,o.reIntegrateRotationIntoRotationQuaternion=!1,o._poseMatrix=null,o._localMatrix=yt.Zero(),o._usePivotMatrix=!1,o._absolutePosition=_t.Zero(),o._absoluteScaling=_t.Zero(),o._absoluteRotationQuaternion=mt.Identity(),o._pivotMatrix=yt.Identity(),o._postMultiplyPivotMatrix=!1,o._isWorldMatrixFrozen=!1,o._indexInSceneTransformNodesArray=-1,o.onAfterWorldMatrixUpdateObservable=new l,o._nonUniformScaling=!1,n&&o.getScene().addTransformNode(o),o}var i;return n(e,t),Object.defineProperty(e.prototype,"billboardMode",{get:function(){return this._billboardMode},set:function(t){this._billboardMode!==t&&(this._billboardMode=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"preserveParentRotationForBillboard",{get:function(){return this._preserveParentRotationForBillboard},set:function(t){t!==this._preserveParentRotationForBillboard&&(this._preserveParentRotationForBillboard=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"infiniteDistance",{get:function(){return this._infiniteDistance},set:function(t){this._infiniteDistance!==t&&(this._infiniteDistance=t)},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return"TransformNode"},Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation=t,this._rotationQuaternion=null,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scaling",{get:function(){return this._scaling},set:function(t){this._scaling=t,this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotationQuaternion",{get:function(){return this._rotationQuaternion},set:function(t){this._rotationQuaternion=t,t&&this._rotation.setAll(0),this._isDirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"forward",{get:function(){return _t.Normalize(_t.TransformNormal(this.getScene().useRightHandedSystem?this._forwardInverted:this._forward,this.getWorldMatrix()))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"up",{get:function(){return _t.Normalize(_t.TransformNormal(this._up,this.getWorldMatrix()))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return _t.Normalize(_t.TransformNormal(this.getScene().useRightHandedSystem?this._rightInverted:this._right,this.getWorldMatrix()))},enumerable:!1,configurable:!0}),e.prototype.updatePoseMatrix=function(t){return this._poseMatrix?(this._poseMatrix.copyFrom(t),this):(this._poseMatrix=t.clone(),this)},e.prototype.getPoseMatrix=function(){return this._poseMatrix||(this._poseMatrix=yt.Identity()),this._poseMatrix},e.prototype._isSynchronized=function(){var t=this._cache;return this.billboardMode===t.billboardMode&&this.billboardMode===e.BILLBOARDMODE_NONE&&(!t.pivotMatrixUpdated&&(!this.infiniteDistance&&(!this.position._isDirty&&(!this.scaling._isDirty&&!(this._rotationQuaternion&&this._rotationQuaternion._isDirty||this.rotation._isDirty)))))},e.prototype._initCache=function(){t.prototype._initCache.call(this);var e=this._cache;e.localMatrixUpdated=!1,e.billboardMode=-1,e.infiniteDistance=!1},e.prototype.markAsDirty=function(t){return this._currentRenderId=Number.MAX_VALUE,this._isDirty=!0,this},Object.defineProperty(e.prototype,"absolutePosition",{get:function(){return this._absolutePosition},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"absoluteScaling",{get:function(){return this._syncAbsoluteScalingAndRotation(),this._absoluteScaling},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"absoluteRotationQuaternion",{get:function(){return this._syncAbsoluteScalingAndRotation(),this._absoluteRotationQuaternion},enumerable:!1,configurable:!0}),e.prototype.setPreTransformMatrix=function(t){return this.setPivotMatrix(t,!1)},e.prototype.setPivotMatrix=function(t,e){return void 0===e&&(e=!0),this._pivotMatrix.copyFrom(t),this._usePivotMatrix=!this._pivotMatrix.isIdentity(),this._cache.pivotMatrixUpdated=!0,this._postMultiplyPivotMatrix=e,this._postMultiplyPivotMatrix&&(this._pivotMatrixInverse?this._pivotMatrix.invertToRef(this._pivotMatrixInverse):this._pivotMatrixInverse=yt.Invert(this._pivotMatrix)),this},e.prototype.getPivotMatrix=function(){return this._pivotMatrix},e.prototype.instantiateHierarchy=function(t,e,i){void 0===t&&(t=null);var r=this.clone("Clone of "+(this.name||this.id),t||this.parent,!0);r&&i&&i(this,r);for(var n=0,o=this.getChildTransformNodes(!0);n<o.length;n++){o[n].instantiateHierarchy(r,e,i)}return r},e.prototype.freezeWorldMatrix=function(t){return void 0===t&&(t=null),t?this._worldMatrix=t:(this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0)),this._isDirty=!1,this._isWorldMatrixFrozen=!0,this},e.prototype.unfreezeWorldMatrix=function(){return this._isWorldMatrixFrozen=!1,this.computeWorldMatrix(!0),this},Object.defineProperty(e.prototype,"isWorldMatrixFrozen",{get:function(){return this._isWorldMatrixFrozen},enumerable:!1,configurable:!0}),e.prototype.getAbsolutePosition=function(){return this.computeWorldMatrix(),this._absolutePosition},e.prototype.setAbsolutePosition=function(t){if(!t)return this;var e,i,r;if(void 0===t.x){if(arguments.length<3)return this;e=arguments[0],i=arguments[1],r=arguments[2]}else e=t.x,i=t.y,r=t.z;if(this.parent){var n=bt.Matrix[0];this.parent.getWorldMatrix().invertToRef(n),_t.TransformCoordinatesFromFloatsToRef(e,i,r,n,this.position)}else this.position.x=e,this.position.y=i,this.position.z=r;return this._absolutePosition.copyFrom(t),this},e.prototype.setPositionWithLocalVector=function(t){return this.computeWorldMatrix(),this.position=_t.TransformNormal(t,this._localMatrix),this},e.prototype.getPositionExpressedInLocalSpace=function(){this.computeWorldMatrix();var t=bt.Matrix[0];return this._localMatrix.invertToRef(t),_t.TransformNormal(this.position,t)},e.prototype.locallyTranslate=function(t){return this.computeWorldMatrix(!0),this.position=_t.TransformCoordinates(t,this._localMatrix),this},e.prototype.lookAt=function(t,i,r,n,o){void 0===i&&(i=0),void 0===r&&(r=0),void 0===n&&(n=0),void 0===o&&(o=Qt.LOCAL);var s=e._lookAtVectorCache,a=o===Qt.LOCAL?this.position:this.getAbsolutePosition();if(t.subtractToRef(a,s),this.setDirection(s,i,r,n),o===Qt.WORLD&&this.parent)if(this.rotationQuaternion){var u=bt.Matrix[0];this.rotationQuaternion.toRotationMatrix(u);var h=bt.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(h),h.invert(),u.multiplyToRef(h,u),this.rotationQuaternion.fromRotationMatrix(u)}else{var l=bt.Quaternion[0];mt.FromEulerVectorToRef(this.rotation,l);u=bt.Matrix[0];l.toRotationMatrix(u);h=bt.Matrix[1];this.parent.getWorldMatrix().getRotationMatrixToRef(h),h.invert(),u.multiplyToRef(h,u),l.fromRotationMatrix(u),l.toEulerAnglesToRef(this.rotation)}return this},e.prototype.getDirection=function(t){var e=_t.Zero();return this.getDirectionToRef(t,e),e},e.prototype.getDirectionToRef=function(t,e){return _t.TransformNormalToRef(t,this.getWorldMatrix(),e),this},e.prototype.setDirection=function(t,e,i,r){void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0);var n=-Math.atan2(t.z,t.x)+Math.PI/2,o=Math.sqrt(t.x*t.x+t.z*t.z),s=-Math.atan2(t.y,o);return this.rotationQuaternion?mt.RotationYawPitchRollToRef(n+e,s+i,r,this.rotationQuaternion):(this.rotation.x=s+i,this.rotation.y=n+e,this.rotation.z=r),this},e.prototype.setPivotPoint=function(t,e){void 0===e&&(e=Qt.LOCAL),0==this.getScene().getRenderId()&&this.computeWorldMatrix(!0);var i=this.getWorldMatrix();if(e==Qt.WORLD){var r=bt.Matrix[0];i.invertToRef(r),t=_t.TransformCoordinates(t,r)}return this.setPivotMatrix(yt.Translation(-t.x,-t.y,-t.z),!0)},e.prototype.getPivotPoint=function(){var t=_t.Zero();return this.getPivotPointToRef(t),t},e.prototype.getPivotPointToRef=function(t){return t.x=-this._pivotMatrix.m[12],t.y=-this._pivotMatrix.m[13],t.z=-this._pivotMatrix.m[14],this},e.prototype.getAbsolutePivotPoint=function(){var t=_t.Zero();return this.getAbsolutePivotPointToRef(t),t},e.prototype.getAbsolutePivotPointToRef=function(t){return this.getPivotPointToRef(t),_t.TransformCoordinatesToRef(t,this.getWorldMatrix(),t),this},e.prototype.setParent=function(t){if(!t&&!this.parent)return this;var e=bt.Quaternion[0],i=bt.Vector3[0],r=bt.Vector3[1];if(t){var n=bt.Matrix[0],o=bt.Matrix[1];this.computeWorldMatrix(!0),t.computeWorldMatrix(!0),t.getWorldMatrix().invertToRef(o),this.getWorldMatrix().multiplyToRef(o,n),n.decompose(r,e,i)}else this.computeWorldMatrix(!0),this.getWorldMatrix().decompose(r,e,i);return this.rotationQuaternion?this.rotationQuaternion.copyFrom(e):e.toEulerAnglesToRef(this.rotation),this.scaling.copyFrom(r),this.position.copyFrom(i),this.parent=t,this},Object.defineProperty(e.prototype,"nonUniformScaling",{get:function(){return this._nonUniformScaling},enumerable:!1,configurable:!0}),e.prototype._updateNonUniformScalingState=function(t){return this._nonUniformScaling!==t&&(this._nonUniformScaling=t,!0)},e.prototype.attachToBone=function(t,e){return this._transformToBoneReferal=e,this.parent=t,t.getSkeleton().prepare(),t.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this},e.prototype.detachFromBone=function(){return this.parent?(this.parent.getWorldMatrix().determinant()<0&&(this.scalingDeterminant*=-1),this._transformToBoneReferal=null,this.parent=null,this):this},e.prototype.rotate=function(t,i,r){var n;if(t.normalize(),this.rotationQuaternion||(this.rotationQuaternion=this.rotation.toQuaternion(),this.rotation.setAll(0)),r&&r!==Qt.LOCAL){if(this.parent){var o=bt.Matrix[0];this.parent.getWorldMatrix().invertToRef(o),t=_t.TransformNormal(t,o)}(n=mt.RotationAxisToRef(t,i,e._rotationAxisCache)).multiplyToRef(this.rotationQuaternion,this.rotationQuaternion)}else n=mt.RotationAxisToRef(t,i,e._rotationAxisCache),this.rotationQuaternion.multiplyToRef(n,this.rotationQuaternion);return this},e.prototype.rotateAround=function(t,e,i){e.normalize(),this.rotationQuaternion||(this.rotationQuaternion=mt.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z),this.rotation.setAll(0));var r=bt.Vector3[0],n=bt.Vector3[1],o=bt.Vector3[2],s=bt.Quaternion[0],a=bt.Matrix[0],u=bt.Matrix[1],h=bt.Matrix[2],l=bt.Matrix[3];return t.subtractToRef(this.position,r),yt.TranslationToRef(r.x,r.y,r.z,a),yt.TranslationToRef(-r.x,-r.y,-r.z,u),yt.RotationAxisToRef(e,i,h),u.multiplyToRef(h,l),l.multiplyToRef(a,l),l.decompose(n,s,o),this.position.addInPlace(o),s.multiplyToRef(this.rotationQuaternion,this.rotationQuaternion),this},e.prototype.translate=function(t,e,i){var r=t.scale(e);if(i&&i!==Qt.LOCAL)this.setAbsolutePosition(this.getAbsolutePosition().add(r));else{var n=this.getPositionExpressedInLocalSpace().add(r);this.setPositionWithLocalVector(n)}return this},e.prototype.addRotation=function(t,e,i){var r;this.rotationQuaternion?r=this.rotationQuaternion:(r=bt.Quaternion[1],mt.RotationYawPitchRollToRef(this.rotation.y,this.rotation.x,this.rotation.z,r));var n=bt.Quaternion[0];return mt.RotationYawPitchRollToRef(e,t,i,n),r.multiplyInPlace(n),this.rotationQuaternion||r.toEulerAnglesToRef(this.rotation),this},e.prototype._getEffectiveParent=function(){return this.parent},e.prototype.computeWorldMatrix=function(t){if(this._isWorldMatrixFrozen&&!this._isDirty)return this._worldMatrix;var i=this.getScene().getRenderId();if(!this._isDirty&&!t&&this.isSynchronized())return this._currentRenderId=i,this._worldMatrix;var r=this.getScene().activeCamera,n=0!=(this._billboardMode&e.BILLBOARDMODE_USE_POSITION),o=this._billboardMode!==e.BILLBOARDMODE_NONE&&!this.preserveParentRotationForBillboard;o&&r&&n&&(this.lookAt(r.position),(this.billboardMode&e.BILLBOARDMODE_X)!==e.BILLBOARDMODE_X&&(this.rotation.x=0),(this.billboardMode&e.BILLBOARDMODE_Y)!==e.BILLBOARDMODE_Y&&(this.rotation.y=0),(this.billboardMode&e.BILLBOARDMODE_Z)!==e.BILLBOARDMODE_Z&&(this.rotation.z=0)),this._updateCache();var s=this._cache;s.pivotMatrixUpdated=!1,s.billboardMode=this.billboardMode,s.infiniteDistance=this.infiniteDistance,this._currentRenderId=i,this._childUpdateId++,this._isDirty=!1,this._position._isDirty=!1,this._rotation._isDirty=!1,this._scaling._isDirty=!1;var a,u=this._getEffectiveParent(),h=e._TmpScaling,l=this._position;if(this._infiniteDistance&&!this.parent&&r){var c=r.getWorldMatrix(),f=new _t(c.m[12],c.m[13],c.m[14]);(l=e._TmpTranslation).copyFromFloats(this._position.x+f.x,this._position.y+f.y,this._position.z+f.z)}(h.copyFromFloats(this._scaling.x*this.scalingDeterminant,this._scaling.y*this.scalingDeterminant,this._scaling.z*this.scalingDeterminant),this._rotationQuaternion)?(this._rotationQuaternion._isDirty=!1,a=this._rotationQuaternion,this.reIntegrateRotationIntoRotationQuaternion&&this.rotation.lengthSquared()&&(this._rotationQuaternion.multiplyInPlace(mt.RotationYawPitchRoll(this._rotation.y,this._rotation.x,this._rotation.z)),this._rotation.copyFromFloats(0,0,0))):(a=e._TmpRotation,mt.RotationYawPitchRollToRef(this._rotation.y,this._rotation.x,this._rotation.z,a));if(this._usePivotMatrix){var d=bt.Matrix[1];yt.ScalingToRef(h.x,h.y,h.z,d);var p=bt.Matrix[0];a.toRotationMatrix(p),this._pivotMatrix.multiplyToRef(d,bt.Matrix[4]),bt.Matrix[4].multiplyToRef(p,this._localMatrix),this._postMultiplyPivotMatrix&&this._localMatrix.multiplyToRef(this._pivotMatrixInverse,this._localMatrix),this._localMatrix.addTranslationFromFloats(l.x,l.y,l.z)}else yt.ComposeToRef(h,a,l,this._localMatrix);if(u&&u.getWorldMatrix){if(t&&u.computeWorldMatrix(),o){this._transformToBoneReferal?u.getWorldMatrix().multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),bt.Matrix[7]):bt.Matrix[7].copyFrom(u.getWorldMatrix());var _=bt.Vector3[5],g=bt.Vector3[6];bt.Matrix[7].decompose(g,void 0,_),yt.ScalingToRef(g.x,g.y,g.z,bt.Matrix[7]),bt.Matrix[7].setTranslation(_),this._localMatrix.multiplyToRef(bt.Matrix[7],this._worldMatrix)}else this._transformToBoneReferal?(this._localMatrix.multiplyToRef(u.getWorldMatrix(),bt.Matrix[6]),bt.Matrix[6].multiplyToRef(this._transformToBoneReferal.getWorldMatrix(),this._worldMatrix)):this._localMatrix.multiplyToRef(u.getWorldMatrix(),this._worldMatrix);this._markSyncedWithParent()}else this._worldMatrix.copyFrom(this._localMatrix);if(o&&r&&this.billboardMode&&!n){var m=bt.Vector3[0];if(this._worldMatrix.getTranslationToRef(m),bt.Matrix[1].copyFrom(r.getViewMatrix()),bt.Matrix[1].setTranslationFromFloats(0,0,0),bt.Matrix[1].invertToRef(bt.Matrix[0]),(this.billboardMode&e.BILLBOARDMODE_ALL)!==e.BILLBOARDMODE_ALL){bt.Matrix[0].decompose(void 0,bt.Quaternion[0],void 0);var y=bt.Vector3[1];bt.Quaternion[0].toEulerAnglesToRef(y),(this.billboardMode&e.BILLBOARDMODE_X)!==e.BILLBOARDMODE_X&&(y.x=0),(this.billboardMode&e.BILLBOARDMODE_Y)!==e.BILLBOARDMODE_Y&&(y.y=0),(this.billboardMode&e.BILLBOARDMODE_Z)!==e.BILLBOARDMODE_Z&&(y.z=0),yt.RotationYawPitchRollToRef(y.y,y.x,y.z,bt.Matrix[0])}this._worldMatrix.setTranslationFromFloats(0,0,0),this._worldMatrix.multiplyToRef(bt.Matrix[0],this._worldMatrix),this._worldMatrix.setTranslation(bt.Vector3[0])}return this.ignoreNonUniformScaling?this._updateNonUniformScalingState(!1):this._scaling.isNonUniformWithinEpsilon(1e-6)?this._updateNonUniformScalingState(!0):u&&u._nonUniformScaling?this._updateNonUniformScalingState(u._nonUniformScaling):this._updateNonUniformScalingState(!1),this._afterComputeWorldMatrix(),this._absolutePosition.copyFromFloats(this._worldMatrix.m[12],this._worldMatrix.m[13],this._worldMatrix.m[14]),this._isAbsoluteSynced=!1,this.onAfterWorldMatrixUpdateObservable.notifyObservers(this),this._poseMatrix||(this._poseMatrix=yt.Invert(this._worldMatrix)),this._worldMatrixDeterminantIsDirty=!0,this._worldMatrix},e.prototype.resetLocalMatrix=function(t){if(void 0===t&&(t=!0),this.computeWorldMatrix(),t)for(var e=this.getChildren(),i=0;i<e.length;++i){var r=e[i];if(r){r.computeWorldMatrix();var n=bt.Matrix[0];r._localMatrix.multiplyToRef(this._localMatrix,n);var o=bt.Quaternion[0];n.decompose(r.scaling,o,r.position),r.rotationQuaternion?r.rotationQuaternion=o:o.toEulerAnglesToRef(r.rotation)}}this.scaling.copyFromFloats(1,1,1),this.position.copyFromFloats(0,0,0),this.rotation.copyFromFloats(0,0,0),this.rotationQuaternion&&(this.rotationQuaternion=mt.Identity()),this._worldMatrix=yt.Identity()},e.prototype._afterComputeWorldMatrix=function(){},e.prototype.registerAfterWorldMatrixUpdate=function(t){return this.onAfterWorldMatrixUpdateObservable.add(t),this},e.prototype.unregisterAfterWorldMatrixUpdate=function(t){return this.onAfterWorldMatrixUpdateObservable.removeCallback(t),this},e.prototype.getPositionInCameraSpace=function(t){return void 0===t&&(t=null),t||(t=this.getScene().activeCamera),_t.TransformCoordinates(this.getAbsolutePosition(),t.getViewMatrix())},e.prototype.getDistanceToCamera=function(t){return void 0===t&&(t=null),t||(t=this.getScene().activeCamera),this.getAbsolutePosition().subtract(t.globalPosition).length()},e.prototype.clone=function(t,i,r){var n=this,o=Dt.Clone((function(){return new e(t,n.getScene())}),this);if(o.name=t,o.id=t,i&&(o.parent=i),!r)for(var s=this.getDescendants(!0),a=0;a<s.length;a++){var u=s[a];u.clone&&u.clone(t+"."+u.name,o)}return o},e.prototype.serialize=function(t){var e=Dt.Serialize(this,t);return e.type=this.getClassName(),this.parent&&(e.parentId=this.parent.id),e.localMatrix=this.getPivotMatrix().asArray(),e.isEnabled=this.isEnabled(),this.parent&&(e.parentId=this.parent.id),e},e.Parse=function(t,i,r){var n=Dt.Parse((function(){return new e(t.name,i)}),t,i,r);return t.localMatrix?n.setPreTransformMatrix(yt.FromArray(t.localMatrix)):t.pivotMatrix&&n.setPivotMatrix(yt.FromArray(t.pivotMatrix)),n.setEnabled(t.isEnabled),t.parentId&&(n._waitingParentId=t.parentId),n},e.prototype.getChildTransformNodes=function(t,i){var r=[];return this._getDescendants(r,t,(function(t){return(!i||i(t))&&t instanceof e})),r},e.prototype.dispose=function(e,i){if(void 0===i&&(i=!1),this.getScene().stopAnimation(this),this.getScene().removeTransformNode(this),this.onAfterWorldMatrixUpdateObservable.clear(),e)for(var r=0,n=this.getChildTransformNodes(!0);r<n.length;r++){var o=n[r];o.parent=null,o.computeWorldMatrix(!0)}t.prototype.dispose.call(this,e,i)},e.prototype.normalizeToUnitCube=function(t,e,i){void 0===t&&(t=!0),void 0===e&&(e=!1);var r=null,n=null;e&&(this.rotationQuaternion?(n=this.rotationQuaternion.clone(),this.rotationQuaternion.copyFromFloats(0,0,0,1)):this.rotation&&(r=this.rotation.clone(),this.rotation.copyFromFloats(0,0,0)));var o=this.getHierarchyBoundingVectors(t,i),s=o.max.subtract(o.min),a=Math.max(s.x,s.y,s.z);if(0===a)return this;var u=1/a;return this.scaling.scaleInPlace(u),e&&(this.rotationQuaternion&&n?this.rotationQuaternion.copyFrom(n):this.rotation&&r&&this.rotation.copyFrom(r)),this},e.prototype._syncAbsoluteScalingAndRotation=function(){this._isAbsoluteSynced||(this._worldMatrix.decompose(this._absoluteScaling,this._absoluteRotationQuaternion),this._isAbsoluteSynced=!0)},e.BILLBOARDMODE_NONE=0,e.BILLBOARDMODE_X=1,e.BILLBOARDMODE_Y=2,e.BILLBOARDMODE_Z=4,e.BILLBOARDMODE_ALL=7,e.BILLBOARDMODE_USE_POSITION=128,e._TmpRotation=mt.Zero(),e._TmpScaling=_t.Zero(),e._TmpTranslation=_t.Zero(),e._lookAtVectorCache=new _t(0,0,0),e._rotationAxisCache=new mt,s([St("position")],e.prototype,"_position",void 0),s([St("rotation")],e.prototype,"_rotation",void 0),s([(i="rotationQuaternion",It(10,i))],e.prototype,"_rotationQuaternion",void 0),s([St("scaling")],e.prototype,"_scaling",void 0),s([Ft("billboardMode")],e.prototype,"_billboardMode",void 0),s([Ft()],e.prototype,"scalingDeterminant",void 0),s([Ft("infiniteDistance")],e.prototype,"_infiniteDistance",void 0),s([Ft()],e.prototype,"ignoreNonUniformScaling",void 0),s([Ft()],e.prototype,"reIntegrateRotationIntoRotationQuaternion",void 0),e}(Pt),ee=function(){function t(){this._pickingUnavailable=!1,this.hit=!1,this.distance=0,this.pickedPoint=null,this.pickedMesh=null,this.bu=0,this.bv=0,this.faceId=-1,this.subMeshFaceId=-1,this.subMeshId=0,this.pickedSprite=null,this.thinInstanceIndex=-1,this.originMesh=null,this.ray=null}return t.prototype.getNormal=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!0),!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(Bt.NormalKind))return null;var i,r=this.pickedMesh.getIndices();if(!r)return null;if(e){var n=this.pickedMesh.getVerticesData(Bt.NormalKind),o=_t.FromArray(n,3*r[3*this.faceId]),s=_t.FromArray(n,3*r[3*this.faceId+1]),a=_t.FromArray(n,3*r[3*this.faceId+2]);o=o.scale(this.bu),s=s.scale(this.bv),a=a.scale(1-this.bu-this.bv),i=new _t(o.x+s.x+a.x,o.y+s.y+a.y,o.z+s.z+a.z)}else{var u=this.pickedMesh.getVerticesData(Bt.PositionKind),h=_t.FromArray(u,3*r[3*this.faceId]),l=_t.FromArray(u,3*r[3*this.faceId+1]),c=_t.FromArray(u,3*r[3*this.faceId+2]),f=h.subtract(l),d=c.subtract(l);i=_t.Cross(f,d)}if(t){var p=this.pickedMesh.getWorldMatrix();this.pickedMesh.nonUniformScaling&&(bt.Matrix[0].copyFrom(p),(p=bt.Matrix[0]).setTranslationFromFloats(0,0,0),p.invert(),p.transposeToRef(bt.Matrix[1]),p=bt.Matrix[1]),i=_t.TransformNormal(i,p)}return i.normalize(),i},t.prototype.getTextureCoordinates=function(){if(!this.pickedMesh||!this.pickedMesh.isVerticesDataPresent(Bt.UVKind))return null;var t=this.pickedMesh.getIndices();if(!t)return null;var e=this.pickedMesh.getVerticesData(Bt.UVKind);if(!e)return null;var i=pt.FromArray(e,2*t[3*this.faceId]),r=pt.FromArray(e,2*t[3*this.faceId+1]),n=pt.FromArray(e,2*t[3*this.faceId+2]);return i=i.scale(this.bu),r=r.scale(this.bv),n=n.scale(1-this.bu-this.bv),new pt(i.x+r.x+n.x,i.y+r.y+n.y)},t}(),ie=function(){this._checkCollisions=!1,this._collisionMask=-1,this._collisionGroup=-1,this._surroundingMeshes=null,this._collider=null,this._oldPositionForCollisions=new _t(0,0,0),this._diffPositionForCollisions=new _t(0,0,0),this._collisionResponse=!0},re=function(){this.facetNb=0,this.partitioningSubdivisions=10,this.partitioningBBoxRatio=1.01,this.facetDataEnabled=!1,this.facetParameters={},this.bbSize=_t.Zero(),this.subDiv={max:1,X:1,Y:1,Z:1},this.facetDepthSort=!1,this.facetDepthSortEnabled=!1},ne=function(){this._hasVertexAlpha=!1,this._useVertexColors=!0,this._numBoneInfluencers=4,this._applyFog=!0,this._receiveShadows=!1,this._facetData=new re,this._visibility=1,this._skeleton=null,this._layerMask=268435455,this._computeBonesUsingShaders=!0,this._isActive=!1,this._onlyForInstances=!1,this._isActiveIntermediate=!1,this._onlyForInstancesIntermediate=!1,this._actAsRegularMesh=!1,this._currentLOD=null,this._currentLODIsUpToDate=!1},oe=function(t){function e(i,r){void 0===r&&(r=null);var n=t.call(this,i,r,!1)||this;return n._internalAbstractMeshDataInfo=new ne,n.cullingStrategy=e.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY,n.onCollideObservable=new l,n.onCollisionPositionChangeObservable=new l,n.onMaterialChangedObservable=new l,n.definedFacingForward=!0,n._occlusionQuery=null,n._renderingGroup=null,n.alphaIndex=Number.MAX_VALUE,n.isVisible=!0,n.isPickable=!0,n.showSubMeshesBoundingBox=!1,n.isBlocker=!1,n.enablePointerMoveEvents=!1,n._renderingGroupId=0,n._material=null,n.outlineColor=xt.Red(),n.outlineWidth=.02,n.overlayColor=xt.Red(),n.overlayAlpha=.5,n.useOctreeForRenderingSelection=!0,n.useOctreeForPicking=!0,n.useOctreeForCollisions=!0,n.alwaysSelectAsActiveMesh=!1,n.doNotSyncBoundingInfo=!1,n.actionManager=null,n._meshCollisionData=new ie,n.ellipsoid=new _t(.5,1,.5),n.ellipsoidOffset=new _t(0,0,0),n.edgesWidth=1,n.edgesColor=new At(1,0,0,1),n._edgesRenderer=null,n._masterMesh=null,n._boundingInfo=null,n._renderId=0,n._intersectionsInProgress=new Array,n._unIndexed=!1,n._lightSources=new Array,n._waitingData={lods:null,actions:null,freezeWorldMatrix:null},n._bonesTransformMatrices=null,n._transformMatrixTexture=null,n.onRebuildObservable=new l,n._onCollisionPositionChange=function(t,e,i){void 0===i&&(i=null),e.subtractToRef(n._meshCollisionData._oldPositionForCollisions,n._meshCollisionData._diffPositionForCollisions),n._meshCollisionData._diffPositionForCollisions.length()>Zt.CollisionsEpsilon&&n.position.addInPlace(n._meshCollisionData._diffPositionForCollisions),i&&n.onCollideObservable.notifyObservers(i),n.onCollisionPositionChangeObservable.notifyObservers(n.position)},n.getScene().addMesh(n),n._resyncLightSources(),n}return n(e,t),Object.defineProperty(e,"BILLBOARDMODE_NONE",{get:function(){return te.BILLBOARDMODE_NONE},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BILLBOARDMODE_X",{get:function(){return te.BILLBOARDMODE_X},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BILLBOARDMODE_Y",{get:function(){return te.BILLBOARDMODE_Y},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BILLBOARDMODE_Z",{get:function(){return te.BILLBOARDMODE_Z},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BILLBOARDMODE_ALL",{get:function(){return te.BILLBOARDMODE_ALL},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BILLBOARDMODE_USE_POSITION",{get:function(){return te.BILLBOARDMODE_USE_POSITION},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"facetNb",{get:function(){return this._internalAbstractMeshDataInfo._facetData.facetNb},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"partitioningSubdivisions",{get:function(){return this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions},set:function(t){this._internalAbstractMeshDataInfo._facetData.partitioningSubdivisions=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"partitioningBBoxRatio",{get:function(){return this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio},set:function(t){this._internalAbstractMeshDataInfo._facetData.partitioningBBoxRatio=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mustDepthSortFacets",{get:function(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSort},set:function(t){this._internalAbstractMeshDataInfo._facetData.facetDepthSort=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"facetDepthSortFrom",{get:function(){return this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom},set:function(t){this._internalAbstractMeshDataInfo._facetData.facetDepthSortFrom=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFacetDataEnabled",{get:function(){return this._internalAbstractMeshDataInfo._facetData.facetDataEnabled},enumerable:!1,configurable:!0}),e.prototype._updateNonUniformScalingState=function(e){return!!t.prototype._updateNonUniformScalingState.call(this,e)&&(this._markSubMeshesAsMiscDirty(),!0)},Object.defineProperty(e.prototype,"onCollide",{set:function(t){this._meshCollisionData._onCollideObserver&&this.onCollideObservable.remove(this._meshCollisionData._onCollideObserver),this._meshCollisionData._onCollideObserver=this.onCollideObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onCollisionPositionChange",{set:function(t){this._meshCollisionData._onCollisionPositionChangeObserver&&this.onCollisionPositionChangeObservable.remove(this._meshCollisionData._onCollisionPositionChangeObserver),this._meshCollisionData._onCollisionPositionChangeObserver=this.onCollisionPositionChangeObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visibility",{get:function(){return this._internalAbstractMeshDataInfo._visibility},set:function(t){this._internalAbstractMeshDataInfo._visibility!==t&&(this._internalAbstractMeshDataInfo._visibility=t,this._markSubMeshesAsMiscDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"renderingGroupId",{get:function(){return this._renderingGroupId},set:function(t){this._renderingGroupId=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"material",{get:function(){return this._material},set:function(t){this._material!==t&&(this._material&&this._material.meshMap&&(this._material.meshMap[this.uniqueId]=void 0),this._material=t,t&&t.meshMap&&(t.meshMap[this.uniqueId]=this),this.onMaterialChangedObservable.hasObservers()&&this.onMaterialChangedObservable.notifyObservers(this),this.subMeshes&&this._unBindEffect())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"receiveShadows",{get:function(){return this._internalAbstractMeshDataInfo._receiveShadows},set:function(t){this._internalAbstractMeshDataInfo._receiveShadows!==t&&(this._internalAbstractMeshDataInfo._receiveShadows=t,this._markSubMeshesAsLightDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasVertexAlpha",{get:function(){return this._internalAbstractMeshDataInfo._hasVertexAlpha},set:function(t){this._internalAbstractMeshDataInfo._hasVertexAlpha!==t&&(this._internalAbstractMeshDataInfo._hasVertexAlpha=t,this._markSubMeshesAsAttributesDirty(),this._markSubMeshesAsMiscDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"useVertexColors",{get:function(){return this._internalAbstractMeshDataInfo._useVertexColors},set:function(t){this._internalAbstractMeshDataInfo._useVertexColors!==t&&(this._internalAbstractMeshDataInfo._useVertexColors=t,this._markSubMeshesAsAttributesDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"computeBonesUsingShaders",{get:function(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders},set:function(t){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==t&&(this._internalAbstractMeshDataInfo._computeBonesUsingShaders=t,this._markSubMeshesAsAttributesDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numBoneInfluencers",{get:function(){return this._internalAbstractMeshDataInfo._numBoneInfluencers},set:function(t){this._internalAbstractMeshDataInfo._numBoneInfluencers!==t&&(this._internalAbstractMeshDataInfo._numBoneInfluencers=t,this._markSubMeshesAsAttributesDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"applyFog",{get:function(){return this._internalAbstractMeshDataInfo._applyFog},set:function(t){this._internalAbstractMeshDataInfo._applyFog!==t&&(this._internalAbstractMeshDataInfo._applyFog=t,this._markSubMeshesAsMiscDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layerMask",{get:function(){return this._internalAbstractMeshDataInfo._layerMask},set:function(t){t!==this._internalAbstractMeshDataInfo._layerMask&&(this._internalAbstractMeshDataInfo._layerMask=t,this._resyncLightSources())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collisionMask",{get:function(){return this._meshCollisionData._collisionMask},set:function(t){this._meshCollisionData._collisionMask=isNaN(t)?-1:t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collisionResponse",{get:function(){return this._meshCollisionData._collisionResponse},set:function(t){this._meshCollisionData._collisionResponse=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collisionGroup",{get:function(){return this._meshCollisionData._collisionGroup},set:function(t){this._meshCollisionData._collisionGroup=isNaN(t)?-1:t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"surroundingMeshes",{get:function(){return this._meshCollisionData._surroundingMeshes},set:function(t){this._meshCollisionData._surroundingMeshes=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightSources",{get:function(){return this._lightSources},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_positions",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"skeleton",{get:function(){return this._internalAbstractMeshDataInfo._skeleton},set:function(t){var e=this._internalAbstractMeshDataInfo._skeleton;e&&e.needInitialSkinMatrix&&e._unregisterMeshWithPoseMatrix(this),t&&t.needInitialSkinMatrix&&t._registerMeshWithPoseMatrix(this),this._internalAbstractMeshDataInfo._skeleton=t,this._internalAbstractMeshDataInfo._skeleton||(this._bonesTransformMatrices=null),this._markSubMeshesAsAttributesDirty()},enumerable:!1,configurable:!0}),e.prototype.getClassName=function(){return"AbstractMesh"},e.prototype.toString=function(t){var e="Name: "+this.name+", isInstance: "+("InstancedMesh"!==this.getClassName()?"YES":"NO");e+=", # of submeshes: "+(this.subMeshes?this.subMeshes.length:0);var i=this._internalAbstractMeshDataInfo._skeleton;return i&&(e+=", skeleton: "+i.name),t&&(e+=", billboard mode: "+["NONE","X","Y",null,"Z",null,null,"ALL"][this.billboardMode],e+=", freeze wrld mat: "+(this._isWorldMatrixFrozen||this._waitingData.freezeWorldMatrix?"YES":"NO")),e},e.prototype._getEffectiveParent=function(){return this._masterMesh&&this.billboardMode!==te.BILLBOARDMODE_NONE?this._masterMesh:t.prototype._getEffectiveParent.call(this)},e.prototype._getActionManagerForTrigger=function(t,e){if(void 0===e&&(e=!0),this.actionManager&&(e||this.actionManager.isRecursive)){if(!t)return this.actionManager;if(this.actionManager.hasSpecificTrigger(t))return this.actionManager}return this.parent?this.parent._getActionManagerForTrigger(t,!1):null},e.prototype._rebuild=function(){if(this.onRebuildObservable.notifyObservers(this),this._occlusionQuery&&(this._occlusionQuery=null),this.subMeshes)for(var t=0,e=this.subMeshes;t<e.length;t++){e[t]._rebuild()}},e.prototype._resyncLightSources=function(){this._lightSources.length=0;for(var t=0,e=this.getScene().lights;t<e.length;t++){var i=e[t];i.isEnabled()&&(i.canAffectMesh(this)&&this._lightSources.push(i))}this._markSubMeshesAsLightDirty()},e.prototype._resyncLightSource=function(t){var e=t.isEnabled()&&t.canAffectMesh(this),i=this._lightSources.indexOf(t),r=!1;if(-1===i){if(!e)return;this._lightSources.push(t)}else{if(e)return;r=!0,this._lightSources.splice(i,1)}this._markSubMeshesAsLightDirty(r)},e.prototype._unBindEffect=function(){for(var t=0,e=this.subMeshes;t<e.length;t++){e[t].setEffect(null)}},e.prototype._removeLightSource=function(t,e){var i=this._lightSources.indexOf(t);-1!==i&&(this._lightSources.splice(i,1),this._markSubMeshesAsLightDirty(e))},e.prototype._markSubMeshesAsDirty=function(t){if(this.subMeshes)for(var e=0,i=this.subMeshes;e<i.length;e++){var r=i[e];r._materialDefines&&t(r._materialDefines)}},e.prototype._markSubMeshesAsLightDirty=function(t){void 0===t&&(t=!1),this._markSubMeshesAsDirty((function(e){return e.markAsLightDirty(t)}))},e.prototype._markSubMeshesAsAttributesDirty=function(){this._markSubMeshesAsDirty((function(t){return t.markAsAttributesDirty()}))},e.prototype._markSubMeshesAsMiscDirty=function(){this._markSubMeshesAsDirty((function(t){return t.markAsMiscDirty()}))},Object.defineProperty(e.prototype,"scaling",{get:function(){return this._scaling},set:function(t){this._scaling=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlocked",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.getLOD=function(t){return this},e.prototype.getTotalVertices=function(){return 0},e.prototype.getTotalIndices=function(){return 0},e.prototype.getIndices=function(){return null},e.prototype.getVerticesData=function(t){return null},e.prototype.setVerticesData=function(t,e,i,r){return this},e.prototype.updateVerticesData=function(t,e,i,r){return this},e.prototype.setIndices=function(t,e){return this},e.prototype.isVerticesDataPresent=function(t){return!1},e.prototype.getBoundingInfo=function(){return this._masterMesh?this._masterMesh.getBoundingInfo():(this._boundingInfo||this._updateBoundingInfo(),this._boundingInfo)},e.prototype.normalizeToUnitCube=function(e,i,r){return void 0===e&&(e=!0),void 0===i&&(i=!1),t.prototype.normalizeToUnitCube.call(this,e,i,r)},e.prototype.setBoundingInfo=function(t){return this._boundingInfo=t,this},Object.defineProperty(e.prototype,"useBones",{get:function(){return this.skeleton&&this.getScene().skeletonsEnabled&&this.isVerticesDataPresent(Bt.MatricesIndicesKind)&&this.isVerticesDataPresent(Bt.MatricesWeightsKind)},enumerable:!1,configurable:!0}),e.prototype._preActivate=function(){},e.prototype._preActivateForIntermediateRendering=function(t){},e.prototype._activate=function(t,e){return this._renderId=t,!0},e.prototype._postActivate=function(){},e.prototype._freeze=function(){},e.prototype._unFreeze=function(){},e.prototype.getWorldMatrix=function(){return this._masterMesh&&this.billboardMode===te.BILLBOARDMODE_NONE?this._masterMesh.getWorldMatrix():t.prototype.getWorldMatrix.call(this)},e.prototype._getWorldMatrixDeterminant=function(){return this._masterMesh?this._masterMesh._getWorldMatrixDeterminant():t.prototype._getWorldMatrixDeterminant.call(this)},Object.defineProperty(e.prototype,"isAnInstance",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasInstances",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasThinInstances",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.movePOV=function(t,e,i){return this.position.addInPlace(this.calcMovePOV(t,e,i)),this},e.prototype.calcMovePOV=function(t,e,i){var r=new yt;(this.rotationQuaternion?this.rotationQuaternion:mt.RotationYawPitchRoll(this.rotation.y,this.rotation.x,this.rotation.z)).toRotationMatrix(r);var n=_t.Zero(),o=this.definedFacingForward?-1:1;return _t.TransformCoordinatesFromFloatsToRef(t*o,e,i*o,r,n),n},e.prototype.rotatePOV=function(t,e,i){return this.rotation.addInPlace(this.calcRotatePOV(t,e,i)),this},e.prototype.calcRotatePOV=function(t,e,i){var r=this.definedFacingForward?1:-1;return new _t(t*r,e,i*r)},e.prototype.refreshBoundingInfo=function(t){return void 0===t&&(t=!1),this._boundingInfo&&this._boundingInfo.isLocked||this._refreshBoundingInfo(this._getPositionData(t),null),this},e.prototype._refreshBoundingInfo=function(t,e){if(t){var i=Kt(t,0,this.getTotalVertices(),e);this._boundingInfo?this._boundingInfo.reConstruct(i.minimum,i.maximum):this._boundingInfo=new Wt(i.minimum,i.maximum)}if(this.subMeshes)for(var r=0;r<this.subMeshes.length;r++)this.subMeshes[r].refreshBoundingInfo(t);this._updateBoundingInfo()},e.prototype._getPositionData=function(t){var e=this.getVerticesData(Bt.PositionKind);if(e&&t&&this.skeleton){e=ut.Slice(e),this._generatePointsArray();var i=this.getVerticesData(Bt.MatricesIndicesKind),r=this.getVerticesData(Bt.MatricesWeightsKind);if(r&&i){var n=this.numBoneInfluencers>4,o=n?this.getVerticesData(Bt.MatricesIndicesExtraKind):null,s=n?this.getVerticesData(Bt.MatricesWeightsExtraKind):null;this.skeleton.prepare();for(var a=this.skeleton.getTransformMatrices(this),u=bt.Vector3[0],h=bt.Matrix[0],l=bt.Matrix[1],c=0,f=0;f<e.length;f+=3,c+=4){var d,p;for(h.reset(),d=0;d<4;d++)(p=r[c+d])>0&&(yt.FromFloat32ArrayToRefScaled(a,Math.floor(16*i[c+d]),p,l),h.addToSelf(l));if(n)for(d=0;d<4;d++)(p=s[c+d])>0&&(yt.FromFloat32ArrayToRefScaled(a,Math.floor(16*o[c+d]),p,l),h.addToSelf(l));_t.TransformCoordinatesFromFloatsToRef(e[f],e[f+1],e[f+2],h,u),u.toArray(e,f),this._positions&&this._positions[f/3].copyFrom(u)}}}return e},e.prototype._updateBoundingInfo=function(){var t=this._effectiveMesh;return this._boundingInfo?this._boundingInfo.update(t.worldMatrixFromCache):this._boundingInfo=new Wt(this.absolutePosition,this.absolutePosition,t.worldMatrixFromCache),this._updateSubMeshesBoundingInfo(t.worldMatrixFromCache),this},e.prototype._updateSubMeshesBoundingInfo=function(t){if(!this.subMeshes)return this;for(var e=this.subMeshes.length,i=0;i<e;i++){var r=this.subMeshes[i];(e>1||!r.IsGlobal)&&r.updateBoundingInfo(t)}return this},e.prototype._afterComputeWorldMatrix=function(){this.doNotSyncBoundingInfo||this._updateBoundingInfo()},Object.defineProperty(e.prototype,"_effectiveMesh",{get:function(){return this.skeleton&&this.skeleton.overrideMesh||this},enumerable:!1,configurable:!0}),e.prototype.isInFrustum=function(t){return null!==this._boundingInfo&&this._boundingInfo.isInFrustum(t,this.cullingStrategy)},e.prototype.isCompletelyInFrustum=function(t){return null!==this._boundingInfo&&this._boundingInfo.isCompletelyInFrustum(t)},e.prototype.intersectsMesh=function(t,e,i){if(void 0===e&&(e=!1),!this._boundingInfo||!t._boundingInfo)return!1;if(this._boundingInfo.intersects(t._boundingInfo,e))return!0;if(i)for(var r=0,n=this.getChildMeshes();r<n.length;r++){if(n[r].intersectsMesh(t,e,!0))return!0}return!1},e.prototype.intersectsPoint=function(t){return!!this._boundingInfo&&this._boundingInfo.intersectsPoint(t)},Object.defineProperty(e.prototype,"checkCollisions",{get:function(){return this._meshCollisionData._checkCollisions},set:function(t){this._meshCollisionData._checkCollisions=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"collider",{get:function(){return this._meshCollisionData._collider},enumerable:!1,configurable:!0}),e.prototype.moveWithCollisions=function(t){this.getAbsolutePosition().addToRef(this.ellipsoidOffset,this._meshCollisionData._oldPositionForCollisions);var e=this.getScene().collisionCoordinator;return this._meshCollisionData._collider||(this._meshCollisionData._collider=e.createCollider()),this._meshCollisionData._collider._radius=this.ellipsoid,e.getNewPosition(this._meshCollisionData._oldPositionForCollisions,t,this._meshCollisionData._collider,3,this,this._onCollisionPositionChange,this.uniqueId),this},e.prototype._collideForSubMesh=function(t,e,i){if(this._generatePointsArray(),!this._positions)return this;if(!t._lastColliderWorldVertices||!t._lastColliderTransformMatrix.equals(e)){t._lastColliderTransformMatrix=e.clone(),t._lastColliderWorldVertices=[],t._trianglePlanes=[];for(var r=t.verticesStart,n=t.verticesStart+t.verticesCount,o=r;o<n;o++)t._lastColliderWorldVertices.push(_t.TransformCoordinates(this._positions[o],e))}return i._collide(t._trianglePlanes,t._lastColliderWorldVertices,this.getIndices(),t.indexStart,t.indexStart+t.indexCount,t.verticesStart,!!t.getMaterial(),this),this},e.prototype._processCollisionsForSubMeshes=function(t,e){for(var i=this._scene.getCollidingSubMeshCandidates(this,t),r=i.length,n=0;n<r;n++){var o=i.data[n];r>1&&!o._checkCollision(t)||this._collideForSubMesh(o,e,t)}return this},e.prototype._checkCollision=function(t){if(!this._boundingInfo||!this._boundingInfo._checkCollision(t))return this;var e=bt.Matrix[0],i=bt.Matrix[1];return yt.ScalingToRef(1/t._radius.x,1/t._radius.y,1/t._radius.z,e),this.worldMatrixFromCache.multiplyToRef(e,i),this._processCollisionsForSubMeshes(t,i),this},e.prototype._generatePointsArray=function(){return!1},e.prototype.intersects=function(t,e,i,r,n,o){var s;void 0===r&&(r=!1),void 0===o&&(o=!1);var a=new ee,u="InstancedLinesMesh"===this.getClassName()||"LinesMesh"===this.getClassName()?this.intersectionThreshold:0,h=this._boundingInfo;if(!this.subMeshes||!h)return a;if(!(o||t.intersectsSphere(h.boundingSphere,u)&&t.intersectsBox(h.boundingBox,u)))return a;if(r)return a.hit=!o,a.pickedMesh=o?null:this,a.distance=o?0:_t.Distance(t.origin,h.boundingSphere.center),a.subMeshId=0,a;if(!this._generatePointsArray())return a;for(var l=null,c=this._scene.getIntersectingSubMeshCandidates(this,t),f=c.length,d=!1,p=0;p<f;p++){var _=(g=c.data[p]).getMaterial();if(_&&((null===(s=this.getIndices())||void 0===s?void 0:s.length)&&(7==_.fillMode||0==_.fillMode||1==_.fillMode||2==_.fillMode))){d=!0;break}}if(!d)return a.hit=!0,a.pickedMesh=this,a.distance=_t.Distance(t.origin,h.boundingSphere.center),a.subMeshId=-1,a;for(p=0;p<f;p++){var g=c.data[p];if(!(f>1)||g.canIntersects(t)){var m=g.intersects(t,this._positions,this.getIndices(),e,i);if(m&&(e||!l||m.distance<l.distance)&&((l=m).subMeshId=p,e))break}}if(l){var y=null!=n?n:this.skeleton&&this.skeleton.overrideMesh?this.skeleton.overrideMesh.getWorldMatrix():this.getWorldMatrix(),v=bt.Vector3[0],b=bt.Vector3[1];_t.TransformCoordinatesToRef(t.origin,y,v),t.direction.scaleToRef(l.distance,b);var x=_t.TransformNormal(b,y).addInPlace(v);return a.hit=!0,a.distance=_t.Distance(v,x),a.pickedPoint=x,a.pickedMesh=this,a.bu=l.bu||0,a.bv=l.bv||0,a.subMeshFaceId=l.faceId,a.faceId=l.faceId+c.data[l.subMeshId].indexStart/(-1!==this.getClassName().indexOf("LinesMesh")?2:3),a.subMeshId=l.subMeshId,a}return a},e.prototype.clone=function(t,e,i){return null},e.prototype.releaseSubMeshes=function(){if(this.subMeshes)for(;this.subMeshes.length;)this.subMeshes[0].dispose();else this.subMeshes=new Array;return this},e.prototype.dispose=function(e,i){var r,n=this;for(void 0===i&&(i=!1),this._scene.useMaterialMeshMap&&this._material&&this._material.meshMap&&(this._material.meshMap[this.uniqueId]=void 0),this.getScene().freeActiveMeshes(),this.getScene().freeRenderingGroups(),void 0!==this.actionManager&&null!==this.actionManager&&(this.actionManager.dispose(),this.actionManager=null),this._internalAbstractMeshDataInfo._skeleton=null,this._transformMatrixTexture&&(this._transformMatrixTexture.dispose(),this._transformMatrixTexture=null),r=0;r<this._intersectionsInProgress.length;r++){var o=this._intersectionsInProgress[r],s=o._intersectionsInProgress.indexOf(this);o._intersectionsInProgress.splice(s,1)}this._intersectionsInProgress=[],this.getScene().lights.forEach((function(t){var e=t.includedOnlyMeshes.indexOf(n);-1!==e&&t.includedOnlyMeshes.splice(e,1),-1!==(e=t.excludedMeshes.indexOf(n))&&t.excludedMeshes.splice(e,1);var i=t.getShadowGenerator();if(i){var r=i.getShadowMap();r&&r.renderList&&-1!==(e=r.renderList.indexOf(n))&&r.renderList.splice(e,1)}})),"InstancedMesh"===this.getClassName()&&"InstancedLinesMesh"===this.getClassName()||this.releaseSubMeshes();var a=this.getScene().getEngine();if(this._occlusionQuery&&(this.isOcclusionQueryInProgress=!1,a.deleteQuery(this._occlusionQuery),this._occlusionQuery=null),a.wipeCaches(),this.getScene().removeMesh(this),i&&this.material&&("MultiMaterial"===this.material.getClassName()?this.material.dispose(!1,!0,!0):this.material.dispose(!1,!0)),!e)for(r=0;r<this.getScene().particleSystems.length;r++)this.getScene().particleSystems[r].emitter===this&&(this.getScene().particleSystems[r].dispose(),r--);this._internalAbstractMeshDataInfo._facetData.facetDataEnabled&&this.disableFacetData(),this.onAfterWorldMatrixUpdateObservable.clear(),this.onCollideObservable.clear(),this.onCollisionPositionChangeObservable.clear(),this.onRebuildObservable.clear(),t.prototype.dispose.call(this,e,i)},e.prototype.addChild=function(t){return t.setParent(this),this},e.prototype.removeChild=function(t){return t.setParent(null),this},e.prototype._initFacetData=function(){var t=this._internalAbstractMeshDataInfo._facetData;t.facetNormals||(t.facetNormals=new Array),t.facetPositions||(t.facetPositions=new Array),t.facetPartitioning||(t.facetPartitioning=new Array),t.facetNb=this.getIndices().length/3|0,t.partitioningSubdivisions=t.partitioningSubdivisions?t.partitioningSubdivisions:10,t.partitioningBBoxRatio=t.partitioningBBoxRatio?t.partitioningBBoxRatio:1.01;for(var e=0;e<t.facetNb;e++)t.facetNormals[e]=_t.Zero(),t.facetPositions[e]=_t.Zero();return t.facetDataEnabled=!0,this},e.prototype.updateFacetData=function(){var t=this._internalAbstractMeshDataInfo._facetData;t.facetDataEnabled||this._initFacetData();var e=this.getVerticesData(Bt.PositionKind),i=this.getIndices(),r=this.getVerticesData(Bt.NormalKind),n=this.getBoundingInfo();if(t.facetDepthSort&&!t.facetDepthSortEnabled){if(t.facetDepthSortEnabled=!0,i instanceof Uint16Array)t.depthSortedIndices=new Uint16Array(i);else if(i instanceof Uint32Array)t.depthSortedIndices=new Uint32Array(i);else{for(var o=!1,s=0;s<i.length;s++)if(i[s]>65535){o=!0;break}t.depthSortedIndices=o?new Uint32Array(i):new Uint16Array(i)}if(t.facetDepthSortFunction=function(t,e){return e.sqDistance-t.sqDistance},!t.facetDepthSortFrom){var a=this.getScene().activeCamera;t.facetDepthSortFrom=a?a.position:_t.Zero()}t.depthSortedFacets=[];for(var u=0;u<t.facetNb;u++){var h={ind:3*u,sqDistance:0};t.depthSortedFacets.push(h)}t.invertedMatrix=yt.Identity(),t.facetDepthSortOrigin=_t.Zero()}t.bbSize.x=n.maximum.x-n.minimum.x>.001?n.maximum.x-n.minimum.x:.001,t.bbSize.y=n.maximum.y-n.minimum.y>.001?n.maximum.y-n.minimum.y:.001,t.bbSize.z=n.maximum.z-n.minimum.z>.001?n.maximum.z-n.minimum.z:.001;var l=t.bbSize.x>t.bbSize.y?t.bbSize.x:t.bbSize.y;if(l=l>t.bbSize.z?l:t.bbSize.z,t.subDiv.max=t.partitioningSubdivisions,t.subDiv.X=Math.floor(t.subDiv.max*t.bbSize.x/l),t.subDiv.Y=Math.floor(t.subDiv.max*t.bbSize.y/l),t.subDiv.Z=Math.floor(t.subDiv.max*t.bbSize.z/l),t.subDiv.X=t.subDiv.X<1?1:t.subDiv.X,t.subDiv.Y=t.subDiv.Y<1?1:t.subDiv.Y,t.subDiv.Z=t.subDiv.Z<1?1:t.subDiv.Z,t.facetParameters.facetNormals=this.getFacetLocalNormals(),t.facetParameters.facetPositions=this.getFacetLocalPositions(),t.facetParameters.facetPartitioning=this.getFacetLocalPartitioning(),t.facetParameters.bInfo=n,t.facetParameters.bbSize=t.bbSize,t.facetParameters.subDiv=t.subDiv,t.facetParameters.ratio=this.partitioningBBoxRatio,t.facetParameters.depthSort=t.facetDepthSort,t.facetDepthSort&&t.facetDepthSortEnabled&&(this.computeWorldMatrix(!0),this._worldMatrix.invertToRef(t.invertedMatrix),_t.TransformCoordinatesToRef(t.facetDepthSortFrom,t.invertedMatrix,t.facetDepthSortOrigin),t.facetParameters.distanceTo=t.facetDepthSortOrigin),t.facetParameters.depthSortedFacets=t.depthSortedFacets,wt.ComputeNormals(e,i,r,t.facetParameters),t.facetDepthSort&&t.facetDepthSortEnabled){t.depthSortedFacets.sort(t.facetDepthSortFunction);var c=t.depthSortedIndices.length/3|0;for(u=0;u<c;u++){var f=t.depthSortedFacets[u].ind;t.depthSortedIndices[3*u]=i[f],t.depthSortedIndices[3*u+1]=i[f+1],t.depthSortedIndices[3*u+2]=i[f+2]}this.updateIndices(t.depthSortedIndices,void 0,!0)}return this},e.prototype.getFacetLocalNormals=function(){var t=this._internalAbstractMeshDataInfo._facetData;return t.facetNormals||this.updateFacetData(),t.facetNormals},e.prototype.getFacetLocalPositions=function(){var t=this._internalAbstractMeshDataInfo._facetData;return t.facetPositions||this.updateFacetData(),t.facetPositions},e.prototype.getFacetLocalPartitioning=function(){var t=this._internalAbstractMeshDataInfo._facetData;return t.facetPartitioning||this.updateFacetData(),t.facetPartitioning},e.prototype.getFacetPosition=function(t){var e=_t.Zero();return this.getFacetPositionToRef(t,e),e},e.prototype.getFacetPositionToRef=function(t,e){var i=this.getFacetLocalPositions()[t],r=this.getWorldMatrix();return _t.TransformCoordinatesToRef(i,r,e),this},e.prototype.getFacetNormal=function(t){var e=_t.Zero();return this.getFacetNormalToRef(t,e),e},e.prototype.getFacetNormalToRef=function(t,e){var i=this.getFacetLocalNormals()[t];return _t.TransformNormalToRef(i,this.getWorldMatrix(),e),this},e.prototype.getFacetsAtLocalCoordinates=function(t,e,i){var r=this.getBoundingInfo(),n=this._internalAbstractMeshDataInfo._facetData,o=Math.floor((t-r.minimum.x*n.partitioningBBoxRatio)*n.subDiv.X*n.partitioningBBoxRatio/n.bbSize.x),s=Math.floor((e-r.minimum.y*n.partitioningBBoxRatio)*n.subDiv.Y*n.partitioningBBoxRatio/n.bbSize.y),a=Math.floor((i-r.minimum.z*n.partitioningBBoxRatio)*n.subDiv.Z*n.partitioningBBoxRatio/n.bbSize.z);return o<0||o>n.subDiv.max||s<0||s>n.subDiv.max||a<0||a>n.subDiv.max?null:n.facetPartitioning[o+n.subDiv.max*s+n.subDiv.max*n.subDiv.max*a]},e.prototype.getClosestFacetAtCoordinates=function(t,e,i,r,n,o){void 0===n&&(n=!1),void 0===o&&(o=!0);var s=this.getWorldMatrix(),a=bt.Matrix[5];s.invertToRef(a);var u=bt.Vector3[8];_t.TransformCoordinatesFromFloatsToRef(t,e,i,a,u);var h=this.getClosestFacetAtLocalCoordinates(u.x,u.y,u.z,r,n,o);return r&&_t.TransformCoordinatesFromFloatsToRef(r.x,r.y,r.z,s,r),h},e.prototype.getClosestFacetAtLocalCoordinates=function(t,e,i,r,n,o){void 0===n&&(n=!1),void 0===o&&(o=!0);var s=null,a=0,u=0,h=0,l=0,c=0,f=0,d=0,p=0,_=this.getFacetLocalPositions(),g=this.getFacetLocalNormals(),m=this.getFacetsAtLocalCoordinates(t,e,i);if(!m)return null;for(var y,v,b,x=Number.MAX_VALUE,A=x,E=0;E<m.length;E++)v=g[y=m[E]],l=(t-(b=_[y]).x)*v.x+(e-b.y)*v.y+(i-b.z)*v.z,(!n||n&&o&&l>=0||n&&!o&&l<=0)&&(l=v.x*b.x+v.y*b.y+v.z*b.z,c=-(v.x*t+v.y*e+v.z*i-l)/(v.x*v.x+v.y*v.y+v.z*v.z),(A=(a=(f=t+v.x*c)-t)*a+(u=(d=e+v.y*c)-e)*u+(h=(p=i+v.z*c)-i)*h)<x&&(x=A,s=y,r&&(r.x=f,r.y=d,r.z=p)));return s},e.prototype.getFacetDataParameters=function(){return this._internalAbstractMeshDataInfo._facetData.facetParameters},e.prototype.disableFacetData=function(){var t=this._internalAbstractMeshDataInfo._facetData;return t.facetDataEnabled&&(t.facetDataEnabled=!1,t.facetPositions=new Array,t.facetNormals=new Array,t.facetPartitioning=new Array,t.facetParameters=null,t.depthSortedIndices=new Uint32Array(0)),this},e.prototype.updateIndices=function(t,e,i){return void 0===i&&(i=!1),this},e.prototype.createNormals=function(t){var e,i=this.getVerticesData(Bt.PositionKind),r=this.getIndices();return e=this.isVerticesDataPresent(Bt.NormalKind)?this.getVerticesData(Bt.NormalKind):[],wt.ComputeNormals(i,r,e,{useRightHandedSystem:this.getScene().useRightHandedSystem}),this.setVerticesData(Bt.NormalKind,e,t),this},e.prototype.alignWithNormal=function(t,e){e||(e=$t.Y);var i=bt.Vector3[0],r=bt.Vector3[1];return _t.CrossToRef(e,t,r),_t.CrossToRef(t,r,i),this.rotationQuaternion?mt.RotationQuaternionFromAxisToRef(i,t,r,this.rotationQuaternion):_t.RotationFromAxisToRef(i,t,r,this.rotation),this},e.prototype._checkOcclusionQuery=function(){return!1},e.prototype.disableEdgesRendering=function(){throw m.WarnImport("EdgesRenderer")},e.prototype.enableEdgesRendering=function(t,e,i){throw m.WarnImport("EdgesRenderer")},e.prototype.getConnectedParticleSystems=function(){var t=this;return this._scene.particleSystems.filter((function(e){return e.emitter===t}))},e.OCCLUSION_TYPE_NONE=0,e.OCCLUSION_TYPE_OPTIMISTIC=1,e.OCCLUSION_TYPE_STRICT=2,e.OCCLUSION_ALGORITHM_TYPE_ACCURATE=0,e.OCCLUSION_ALGORITHM_TYPE_CONSERVATIVE=1,e.CULLINGSTRATEGY_STANDARD=0,e.CULLINGSTRATEGY_BOUNDINGSPHERE_ONLY=1,e.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION=2,e.CULLINGSTRATEGY_OPTIMISTIC_INCLUSION_THEN_BSPHERE_ONLY=3,e}(te);ot.RegisteredTypes["BABYLON.AbstractMesh"]=oe,Q.prototype.createUniformBuffer=function(t){var e=this._gl.createBuffer();if(!e)throw new Error("Unable to create uniform buffer");var i=new G(e);return this.bindUniformBuffer(i),t instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,t,this._gl.STATIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(t),this._gl.STATIC_DRAW),this.bindUniformBuffer(null),i.references=1,i},Q.prototype.createDynamicUniformBuffer=function(t){var e=this._gl.createBuffer();if(!e)throw new Error("Unable to create dynamic uniform buffer");var i=new G(e);return this.bindUniformBuffer(i),t instanceof Float32Array?this._gl.bufferData(this._gl.UNIFORM_BUFFER,t,this._gl.DYNAMIC_DRAW):this._gl.bufferData(this._gl.UNIFORM_BUFFER,new Float32Array(t),this._gl.DYNAMIC_DRAW),this.bindUniformBuffer(null),i.references=1,i},Q.prototype.updateUniformBuffer=function(t,e,i,r){this.bindUniformBuffer(t),void 0===i&&(i=0),void 0===r?e instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,i,e):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,i,new Float32Array(e)):e instanceof Float32Array?this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,e.subarray(i,i+r)):this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,new Float32Array(e).subarray(i,i+r)),this.bindUniformBuffer(null)},Q.prototype.bindUniformBuffer=function(t){this._gl.bindBuffer(this._gl.UNIFORM_BUFFER,t?t.underlyingResource:null)},Q.prototype.bindUniformBufferBase=function(t,e){this._gl.bindBufferBase(this._gl.UNIFORM_BUFFER,e,t?t.underlyingResource:null)},Q.prototype.bindUniformBlock=function(t,e,i){var r=t.program,n=this._gl.getUniformBlockIndex(r,e);this._gl.uniformBlockBinding(r,n,i)};var se=function(){function t(t,e,i){this._alreadyBound=!1,this._valueCache={},this._engine=t,this._noUBO=!t.supportsUniformBuffers,this._dynamic=i,this._data=e||[],this._uniformLocations={},this._uniformSizes={},this._uniformLocationPointer=0,this._needSync=!1,this._noUBO?(this.updateMatrix3x3=this._updateMatrix3x3ForEffect,this.updateMatrix2x2=this._updateMatrix2x2ForEffect,this.updateFloat=this._updateFloatForEffect,this.updateFloat2=this._updateFloat2ForEffect,this.updateFloat3=this._updateFloat3ForEffect,this.updateFloat4=this._updateFloat4ForEffect,this.updateMatrix=this._updateMatrixForEffect,this.updateVector3=this._updateVector3ForEffect,this.updateVector4=this._updateVector4ForEffect,this.updateColor3=this._updateColor3ForEffect,this.updateColor4=this._updateColor4ForEffect):(this._engine._uniformBuffers.push(this),this.updateMatrix3x3=this._updateMatrix3x3ForUniform,this.updateMatrix2x2=this._updateMatrix2x2ForUniform,this.updateFloat=this._updateFloatForUniform,this.updateFloat2=this._updateFloat2ForUniform,this.updateFloat3=this._updateFloat3ForUniform,this.updateFloat4=this._updateFloat4ForUniform,this.updateMatrix=this._updateMatrixForUniform,this.updateVector3=this._updateVector3ForUniform,this.updateVector4=this._updateVector4ForUniform,this.updateColor3=this._updateColor3ForUniform,this.updateColor4=this._updateColor4ForUniform)}return Object.defineProperty(t.prototype,"useUbo",{get:function(){return!this._noUBO},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSync",{get:function(){return!this._needSync},enumerable:!1,configurable:!0}),t.prototype.isDynamic=function(){return void 0!==this._dynamic},t.prototype.getData=function(){return this._bufferData},t.prototype.getBuffer=function(){return this._buffer},t.prototype._fillAlignment=function(t){var e;if(e=t<=2?t:4,this._uniformLocationPointer%e!=0){var i=this._uniformLocationPointer;this._uniformLocationPointer+=e-this._uniformLocationPointer%e;for(var r=this._uniformLocationPointer-i,n=0;n<r;n++)this._data.push(0)}},t.prototype.addUniform=function(t,e){if(!this._noUBO&&void 0===this._uniformLocations[t]){var i;if(e instanceof Array)e=(i=e).length;else{e=e,i=[];for(var r=0;r<e;r++)i.push(0)}this._fillAlignment(e),this._uniformSizes[t]=e,this._uniformLocations[t]=this._uniformLocationPointer,this._uniformLocationPointer+=e;for(r=0;r<e;r++)this._data.push(i[r]);this._needSync=!0}},t.prototype.addMatrix=function(t,e){this.addUniform(t,Array.prototype.slice.call(e.toArray()))},t.prototype.addFloat2=function(t,e,i){var r=[e,i];this.addUniform(t,r)},t.prototype.addFloat3=function(t,e,i,r){var n=[e,i,r];this.addUniform(t,n)},t.prototype.addColor3=function(t,e){var i=new Array;e.toArray(i),this.addUniform(t,i)},t.prototype.addColor4=function(t,e,i){var r=new Array;e.toArray(r),r.push(i),this.addUniform(t,r)},t.prototype.addVector3=function(t,e){var i=new Array;e.toArray(i),this.addUniform(t,i)},t.prototype.addMatrix3x3=function(t){this.addUniform(t,12)},t.prototype.addMatrix2x2=function(t){this.addUniform(t,8)},t.prototype.create=function(){this._noUBO||this._buffer||(this._fillAlignment(4),this._bufferData=new Float32Array(this._data),this._rebuild(),this._needSync=!0)},t.prototype._rebuild=function(){!this._noUBO&&this._bufferData&&(this._dynamic?this._buffer=this._engine.createDynamicUniformBuffer(this._bufferData):this._buffer=this._engine.createUniformBuffer(this._bufferData))},t.prototype.update=function(){this._buffer?(this._dynamic||this._needSync)&&(this._engine.updateUniformBuffer(this._buffer,this._bufferData),this._needSync=!1):this.create()},t.prototype.updateUniform=function(t,e,i){var r=this._uniformLocations[t];if(void 0===r){if(this._buffer)return void f.Error("Cannot add an uniform after UBO has been created.");this.addUniform(t,i),r=this._uniformLocations[t]}if(this._buffer||this.create(),this._dynamic)for(o=0;o<i;o++)this._bufferData[r+o]=e[o];else{for(var n=!1,o=0;o<i;o++)16!==i&&this._bufferData[r+o]===e[o]||(n=!0,this._bufferData[r+o]=e[o]);this._needSync=this._needSync||n}},t.prototype._cacheMatrix=function(t,e){var i=this._valueCache[t],r=e.updateFlag;return(void 0===i||i!==r)&&(this._valueCache[t]=r,!0)},t.prototype._updateMatrix3x3ForUniform=function(e,i){for(var r=0;r<3;r++)t._tempBuffer[4*r]=i[3*r],t._tempBuffer[4*r+1]=i[3*r+1],t._tempBuffer[4*r+2]=i[3*r+2],t._tempBuffer[4*r+3]=0;this.updateUniform(e,t._tempBuffer,12)},t.prototype._updateMatrix3x3ForEffect=function(t,e){this._currentEffect.setMatrix3x3(t,e)},t.prototype._updateMatrix2x2ForEffect=function(t,e){this._currentEffect.setMatrix2x2(t,e)},t.prototype._updateMatrix2x2ForUniform=function(e,i){for(var r=0;r<2;r++)t._tempBuffer[4*r]=i[2*r],t._tempBuffer[4*r+1]=i[2*r+1],t._tempBuffer[4*r+2]=0,t._tempBuffer[4*r+3]=0;this.updateUniform(e,t._tempBuffer,8)},t.prototype._updateFloatForEffect=function(t,e){this._currentEffect.setFloat(t,e)},t.prototype._updateFloatForUniform=function(e,i){t._tempBuffer[0]=i,this.updateUniform(e,t._tempBuffer,1)},t.prototype._updateFloat2ForEffect=function(t,e,i,r){void 0===r&&(r=""),this._currentEffect.setFloat2(t+r,e,i)},t.prototype._updateFloat2ForUniform=function(e,i,r){t._tempBuffer[0]=i,t._tempBuffer[1]=r,this.updateUniform(e,t._tempBuffer,2)},t.prototype._updateFloat3ForEffect=function(t,e,i,r,n){void 0===n&&(n=""),this._currentEffect.setFloat3(t+n,e,i,r)},t.prototype._updateFloat3ForUniform=function(e,i,r,n){t._tempBuffer[0]=i,t._tempBuffer[1]=r,t._tempBuffer[2]=n,this.updateUniform(e,t._tempBuffer,3)},t.prototype._updateFloat4ForEffect=function(t,e,i,r,n,o){void 0===o&&(o=""),this._currentEffect.setFloat4(t+o,e,i,r,n)},t.prototype._updateFloat4ForUniform=function(e,i,r,n,o){t._tempBuffer[0]=i,t._tempBuffer[1]=r,t._tempBuffer[2]=n,t._tempBuffer[3]=o,this.updateUniform(e,t._tempBuffer,4)},t.prototype._updateMatrixForEffect=function(t,e){this._currentEffect.setMatrix(t,e)},t.prototype._updateMatrixForUniform=function(t,e){this._cacheMatrix(t,e)&&this.updateUniform(t,e.toArray(),16)},t.prototype._updateVector3ForEffect=function(t,e){this._currentEffect.setVector3(t,e)},t.prototype._updateVector3ForUniform=function(e,i){i.toArray(t._tempBuffer),this.updateUniform(e,t._tempBuffer,3)},t.prototype._updateVector4ForEffect=function(t,e){this._currentEffect.setVector4(t,e)},t.prototype._updateVector4ForUniform=function(e,i){i.toArray(t._tempBuffer),this.updateUniform(e,t._tempBuffer,4)},t.prototype._updateColor3ForEffect=function(t,e,i){void 0===i&&(i=""),this._currentEffect.setColor3(t+i,e)},t.prototype._updateColor3ForUniform=function(e,i){i.toArray(t._tempBuffer),this.updateUniform(e,t._tempBuffer,3)},t.prototype._updateColor4ForEffect=function(t,e,i,r){void 0===r&&(r=""),this._currentEffect.setColor4(t+r,e,i)},t.prototype._updateColor4ForUniform=function(e,i,r){i.toArray(t._tempBuffer),t._tempBuffer[3]=r,this.updateUniform(e,t._tempBuffer,4)},t.prototype.setTexture=function(t,e){this._currentEffect.setTexture(t,e)},t.prototype.updateUniformDirectly=function(t,e){this.updateUniform(t,e,e.length),this.update()},t.prototype.bindToEffect=function(t,e){this._currentEffect=t,!this._noUBO&&this._buffer&&(this._alreadyBound=!0,t.bindUniformBuffer(this._buffer,e))},t.prototype.dispose=function(){if(!this._noUBO){var t=this._engine._uniformBuffers,e=t.indexOf(this);-1!==e&&(t[e]=t[t.length-1],t.pop()),this._buffer&&this._engine._releaseBuffer(this._buffer)&&(this._buffer=null)}},t._MAX_UNIFORM_SIZE=256,t._tempBuffer=new Float32Array(t._MAX_UNIFORM_SIZE),t}(),ae=function(){function t(t,e,i,r){this.normal=new _t(t,e,i),this.d=r}return t.prototype.asArray=function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]},t.prototype.clone=function(){return new t(this.normal.x,this.normal.y,this.normal.z,this.d)},t.prototype.getClassName=function(){return"Plane"},t.prototype.getHashCode=function(){var t=this.normal.getHashCode();return t=397*t^(0|this.d)},t.prototype.normalize=function(){var t=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),e=0;return 0!==t&&(e=1/t),this.normal.x*=e,this.normal.y*=e,this.normal.z*=e,this.d*=e,this},t.prototype.transform=function(e){var i=t._TmpMatrix;e.invertToRef(i);var r=i.m,n=this.normal.x,o=this.normal.y,s=this.normal.z,a=this.d;return new t(n*r[0]+o*r[1]+s*r[2]+a*r[3],n*r[4]+o*r[5]+s*r[6]+a*r[7],n*r[8]+o*r[9]+s*r[10]+a*r[11],n*r[12]+o*r[13]+s*r[14]+a*r[15])},t.prototype.dotCoordinate=function(t){return this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z+this.d},t.prototype.copyFromPoints=function(t,e,i){var r,n=e.x-t.x,o=e.y-t.y,s=e.z-t.z,a=i.x-t.x,u=i.y-t.y,h=i.z-t.z,l=o*h-s*u,c=s*a-n*h,f=n*u-o*a,d=Math.sqrt(l*l+c*c+f*f);return r=0!==d?1/d:0,this.normal.x=l*r,this.normal.y=c*r,this.normal.z=f*r,this.d=-(this.normal.x*t.x+this.normal.y*t.y+this.normal.z*t.z),this},t.prototype.isFrontFacingTo=function(t,e){return _t.Dot(this.normal,t)<=e},t.prototype.signedDistanceTo=function(t){return _t.Dot(t,this.normal)+this.d},t.FromArray=function(e){return new t(e[0],e[1],e[2],e[3])},t.FromPoints=function(e,i,r){var n=new t(0,0,0,0);return n.copyFromPoints(e,i,r),n},t.FromPositionAndNormal=function(e,i){var r=new t(0,0,0,0);return i.normalize(),r.normal=i,r.d=-(i.x*e.x+i.y*e.y+i.z*e.z),r},t.SignedDistanceToPlaneFromPositionAndNormal=function(t,e,i){var r=-(e.x*t.x+e.y*t.y+e.z*t.z);return _t.Dot(i,e)+r},t._TmpMatrix=yt.Identity(),t}(),ue=function(){function t(e,i,r){this.shadowDepthWrapper=null,this.allowShaderHotSwapping=!0,this.metadata=null,this.reservedDataStore=null,this.checkReadyOnEveryCall=!1,this.checkReadyOnlyOnce=!1,this.state="",this._alpha=1,this._backFaceCulling=!0,this.onCompiled=null,this.onError=null,this.getRenderTargetTextures=null,this.doNotSerialize=!1,this._storeEffectOnSubMeshes=!1,this.animations=null,this.onDisposeObservable=new l,this._onDisposeObserver=null,this._onUnBindObservable=null,this._onBindObserver=null,this._alphaMode=2,this._needDepthPrePass=!1,this.disableDepthWrite=!1,this.disableColorWrite=!1,this.forceDepthWrite=!1,this.depthFunction=0,this.separateCullingPass=!1,this._fogEnabled=!0,this.pointSize=1,this.zOffset=0,this._effect=null,this._useUBO=!1,this._fillMode=t.TriangleFillMode,this._cachedDepthWriteState=!1,this._cachedColorWriteState=!1,this._cachedDepthFunctionState=0,this._indexInSceneMaterialArray=-1,this.meshMap=null,this._forceAlphaTest=!1,this._transparencyMode=null,this.name=e;var n=1;for(this._scene=i||b.LastCreatedScene,this.id=e||ut.RandomId();this._scene.getMaterialByID(this.id);)this.id=e+" "+n++;this.uniqueId=this._scene.getUniqueId(),this._scene.useRightHandedSystem?this.sideOrientation=t.ClockWiseSideOrientation:this.sideOrientation=t.CounterClockWiseSideOrientation,this._uniformBuffer=new se(this._scene.getEngine()),this._useUBO=this.getScene().getEngine().supportsUniformBuffers,r||this._scene.addMaterial(this),this._scene.useMaterialMeshMap&&(this.meshMap={})}return Object.defineProperty(t.prototype,"canRenderToMRT",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(e){this._alpha!==e&&(this._alpha=e,this.markAsDirty(t.MiscDirtyFlag))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backFaceCulling",{get:function(){return this._backFaceCulling},set:function(e){this._backFaceCulling!==e&&(this._backFaceCulling=e,this.markAsDirty(t.TextureDirtyFlag))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasRenderTargetTextures",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDispose",{set:function(t){this._onDisposeObserver&&this.onDisposeObservable.remove(this._onDisposeObserver),this._onDisposeObserver=this.onDisposeObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBindObservable",{get:function(){return this._onBindObservable||(this._onBindObservable=new l),this._onBindObservable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onBind",{set:function(t){this._onBindObserver&&this.onBindObservable.remove(this._onBindObserver),this._onBindObserver=this.onBindObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onUnBindObservable",{get:function(){return this._onUnBindObservable||(this._onUnBindObservable=new l),this._onUnBindObservable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onEffectCreatedObservable",{get:function(){return this._onEffectCreatedObservable||(this._onEffectCreatedObservable=new l),this._onEffectCreatedObservable},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alphaMode",{get:function(){return this._alphaMode},set:function(e){this._alphaMode!==e&&(this._alphaMode=e,this.markAsDirty(t.TextureDirtyFlag))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"needDepthPrePass",{get:function(){return this._needDepthPrePass},set:function(t){this._needDepthPrePass!==t&&(this._needDepthPrePass=t,this._needDepthPrePass&&(this.checkReadyOnEveryCall=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fogEnabled",{get:function(){return this._fogEnabled},set:function(e){this._fogEnabled!==e&&(this._fogEnabled=e,this.markAsDirty(t.MiscDirtyFlag))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wireframe",{get:function(){switch(this._fillMode){case t.WireFrameFillMode:case t.LineListDrawMode:case t.LineLoopDrawMode:case t.LineStripDrawMode:return!0}return this._scene.forceWireframe},set:function(e){this.fillMode=e?t.WireFrameFillMode:t.TriangleFillMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pointsCloud",{get:function(){switch(this._fillMode){case t.PointFillMode:case t.PointListDrawMode:return!0}return this._scene.forcePointsCloud},set:function(e){this.fillMode=e?t.PointFillMode:t.TriangleFillMode},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillMode",{get:function(){return this._fillMode},set:function(e){this._fillMode!==e&&(this._fillMode=e,this.markAsDirty(t.MiscDirtyFlag))},enumerable:!1,configurable:!0}),t.prototype.toString=function(t){return"Name: "+this.name},t.prototype.getClassName=function(){return"Material"},Object.defineProperty(t.prototype,"isFrozen",{get:function(){return this.checkReadyOnlyOnce},enumerable:!1,configurable:!0}),t.prototype.freeze=function(){this.markDirty(),this.checkReadyOnlyOnce=!0},t.prototype.unfreeze=function(){this.markDirty(),this.checkReadyOnlyOnce=!1},t.prototype.isReady=function(t,e){return!0},t.prototype.isReadyForSubMesh=function(t,e,i){return!1},t.prototype.getEffect=function(){return this._effect},t.prototype.getScene=function(){return this._scene},Object.defineProperty(t.prototype,"transparencyMode",{get:function(){return this._transparencyMode},set:function(e){this._transparencyMode!==e&&(this._transparencyMode=e,this._forceAlphaTest=e===t.MATERIAL_ALPHATESTANDBLEND,this._markAllSubMeshesAsTexturesAndMiscDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_disableAlphaBlending",{get:function(){return this._transparencyMode===t.MATERIAL_OPAQUE||this._transparencyMode===t.MATERIAL_ALPHATEST},enumerable:!1,configurable:!0}),t.prototype.needAlphaBlending=function(){return!this._disableAlphaBlending&&this.alpha<1},t.prototype.needAlphaBlendingForMesh=function(t){return!(this._disableAlphaBlending&&t.visibility>=1)&&(this.needAlphaBlending()||t.visibility<1||t.hasVertexAlpha)},t.prototype.needAlphaTesting=function(){return!!this._forceAlphaTest},t.prototype._shouldTurnAlphaTestOn=function(t){return!this.needAlphaBlendingForMesh(t)&&this.needAlphaTesting()},t.prototype.getAlphaTestTexture=function(){return null},t.prototype.markDirty=function(){for(var t=0,e=this.getScene().meshes;t<e.length;t++){var i=e[t];if(i.subMeshes)for(var r=0,n=i.subMeshes;r<n.length;r++){var o=n[r];o.getMaterial()===this&&(o.effect&&(o.effect._wasPreviouslyReady=!1))}}},t.prototype._preBind=function(e,i){void 0===i&&(i=null);var r=this._scene.getEngine(),n=(null==i?this.sideOrientation:i)===t.ClockWiseSideOrientation;return r.enableEffect(e||this._effect),r.setState(this.backFaceCulling,this.zOffset,!1,n),n},t.prototype.bind=function(t,e){},t.prototype.bindForSubMesh=function(t,e,i){},t.prototype.bindOnlyWorldMatrix=function(t){},t.prototype.bindSceneUniformBuffer=function(t,e){e.bindToEffect(t,"Scene")},t.prototype.bindView=function(t){this._useUBO?this.bindSceneUniformBuffer(t,this.getScene().getSceneUniformBuffer()):t.setMatrix("view",this.getScene().getViewMatrix())},t.prototype.bindViewProjection=function(t){this._useUBO?this.bindSceneUniformBuffer(t,this.getScene().getSceneUniformBuffer()):t.setMatrix("viewProjection",this.getScene().getTransformMatrix())},t.prototype._afterBind=function(t){if(this._scene._cachedMaterial=this,this._scene._cachedVisibility=t?t.visibility:1,this._onBindObservable&&t&&this._onBindObservable.notifyObservers(t),this.disableDepthWrite){var e=this._scene.getEngine();this._cachedDepthWriteState=e.getDepthWrite(),e.setDepthWrite(!1)}if(this.disableColorWrite){e=this._scene.getEngine();this._cachedColorWriteState=e.getColorWrite(),e.setColorWrite(!1)}if(0!==this.depthFunction){e=this._scene.getEngine();this._cachedDepthFunctionState=e.getDepthFunction()||0,e.setDepthFunction(this.depthFunction)}},t.prototype.unbind=function(){(this._onUnBindObservable&&this._onUnBindObservable.notifyObservers(this),0!==this.depthFunction)&&this._scene.getEngine().setDepthFunction(this._cachedDepthFunctionState);this.disableDepthWrite&&this._scene.getEngine().setDepthWrite(this._cachedDepthWriteState);this.disableColorWrite&&this._scene.getEngine().setColorWrite(this._cachedColorWriteState)},t.prototype.getActiveTextures=function(){return[]},t.prototype.hasTexture=function(t){return!1},t.prototype.clone=function(t){return null},t.prototype.getBindedMeshes=function(){var t=this;if(this.meshMap){var e=new Array;for(var i in this.meshMap){var r=this.meshMap[i];r&&e.push(r)}return e}return this._scene.meshes.filter((function(e){return e.material===t}))},t.prototype.forceCompilation=function(t,e,i,r){var n=this,s=o({clipPlane:!1,useInstances:!1},i),a=this.getScene(),u=this.allowShaderHotSwapping;this.allowShaderHotSwapping=!1;var h=function(){if(n._scene&&n._scene.getEngine()){var i=a.clipPlane;if(s.clipPlane&&(a.clipPlane=new ae(0,0,0,1)),n._storeEffectOnSubMeshes){var o=!0,l=null;if(t.subMeshes){var c=new jt(0,0,0,0,0,t,void 0,!1,!1);c._materialDefines&&(c._materialDefines._renderId=-1),n.isReadyForSubMesh(t,c,s.useInstances)||(c.effect&&c.effect.getCompilationError()&&c.effect.allFallbacksProcessed()?l=c.effect.getCompilationError():(o=!1,setTimeout(h,16)))}o&&(n.allowShaderHotSwapping=u,l&&r&&r(l),e&&e(n))}else n.isReady()?(n.allowShaderHotSwapping=u,e&&e(n)):setTimeout(h,16);s.clipPlane&&(a.clipPlane=i)}};h()},t.prototype.forceCompilationAsync=function(t,e){var i=this;return new Promise((function(r,n){i.forceCompilation(t,(function(){r()}),e,(function(t){n(t)}))}))},t.prototype.markAsDirty=function(e){this.getScene().blockMaterialDirtyMechanism||(t._DirtyCallbackArray.length=0,e&t.TextureDirtyFlag&&t._DirtyCallbackArray.push(t._TextureDirtyCallBack),e&t.LightDirtyFlag&&t._DirtyCallbackArray.push(t._LightsDirtyCallBack),e&t.FresnelDirtyFlag&&t._DirtyCallbackArray.push(t._FresnelDirtyCallBack),e&t.AttributesDirtyFlag&&t._DirtyCallbackArray.push(t._AttributeDirtyCallBack),e&t.MiscDirtyFlag&&t._DirtyCallbackArray.push(t._MiscDirtyCallBack),e&t.PrePassDirtyFlag&&t._DirtyCallbackArray.push(t._PrePassDirtyCallBack),t._DirtyCallbackArray.length&&this._markAllSubMeshesAsDirty(t._RunDirtyCallBacks),this.getScene().resetCachedMaterial())},t.prototype._markAllSubMeshesAsDirty=function(t){if(!this.getScene().blockMaterialDirtyMechanism)for(var e=0,i=this.getScene().meshes;e<i.length;e++){var r=i[e];if(r.subMeshes)for(var n=0,o=r.subMeshes;n<o.length;n++){var s=o[n];s.getMaterial()===this&&(s._materialDefines&&t(s._materialDefines))}}},t.prototype._markScenePrePassDirty=function(){if(!this.getScene().blockMaterialDirtyMechanism){var t=this.getScene().enablePrePassRenderer();t&&t.markAsDirty()}},t.prototype._markAllSubMeshesAsAllDirty=function(){this._markAllSubMeshesAsDirty(t._AllDirtyCallBack)},t.prototype._markAllSubMeshesAsImageProcessingDirty=function(){this._markAllSubMeshesAsDirty(t._ImageProcessingDirtyCallBack)},t.prototype._markAllSubMeshesAsTexturesDirty=function(){this._markAllSubMeshesAsDirty(t._TextureDirtyCallBack)},t.prototype._markAllSubMeshesAsFresnelDirty=function(){this._markAllSubMeshesAsDirty(t._FresnelDirtyCallBack)},t.prototype._markAllSubMeshesAsFresnelAndMiscDirty=function(){this._markAllSubMeshesAsDirty(t._FresnelAndMiscDirtyCallBack)},t.prototype._markAllSubMeshesAsLightsDirty=function(){this._markAllSubMeshesAsDirty(t._LightsDirtyCallBack)},t.prototype._markAllSubMeshesAsAttributesDirty=function(){this._markAllSubMeshesAsDirty(t._AttributeDirtyCallBack)},t.prototype._markAllSubMeshesAsMiscDirty=function(){this._markAllSubMeshesAsDirty(t._MiscDirtyCallBack)},t.prototype._markAllSubMeshesAsPrePassDirty=function(){this._markAllSubMeshesAsDirty(t._MiscDirtyCallBack)},t.prototype._markAllSubMeshesAsTexturesAndMiscDirty=function(){this._markAllSubMeshesAsDirty(t._TextureAndMiscDirtyCallBack)},t.prototype.setPrePassRenderer=function(t){return!1},t.prototype.dispose=function(t,e,i){var r=this.getScene();if(r.stopAnimation(this),r.freeProcessedMaterials(),r.removeMaterial(this),!0!==i)if(this.meshMap)for(var n in this.meshMap){(a=this.meshMap[n])&&(a.material=null,this.releaseVertexArrayObject(a,t))}else for(var o=0,s=r.meshes;o<s.length;o++){var a;(a=s[o]).material!==this||a.sourceMesh||(a.material=null,this.releaseVertexArrayObject(a,t))}this._uniformBuffer.dispose(),t&&this._effect&&(this._storeEffectOnSubMeshes||this._effect.dispose(),this._effect=null),this.onDisposeObservable.notifyObservers(this),this.onDisposeObservable.clear(),this._onBindObservable&&this._onBindObservable.clear(),this._onUnBindObservable&&this._onUnBindObservable.clear(),this._onEffectCreatedObservable&&this._onEffectCreatedObservable.clear()},t.prototype.releaseVertexArrayObject=function(t,e){if(t.geometry){var i=t.geometry;if(this._storeEffectOnSubMeshes)for(var r=0,n=t.subMeshes;r<n.length;r++){var o=n[r];i._releaseVertexArrayObject(o._materialEffect),e&&o._materialEffect&&o._materialEffect.dispose()}else i._releaseVertexArrayObject(this._effect)}},t.prototype.serialize=function(){return Dt.Serialize(this)},t.Parse=function(t,e,i){if(t.customType){if("BABYLON.PBRMaterial"===t.customType&&t.overloadedAlbedo&&(t.customType="BABYLON.LegacyPBRMaterial",!BABYLON.LegacyPBRMaterial))return f.Error("Your scene is trying to load a legacy version of the PBRMaterial, please, include it from the materials library."),null}else t.customType="BABYLON.StandardMaterial";return ut.Instantiate(t.customType).Parse(t,e,i)},t.TriangleFillMode=0,t.WireFrameFillMode=1,t.PointFillMode=2,t.PointListDrawMode=3,t.LineListDrawMode=4,t.LineLoopDrawMode=5,t.LineStripDrawMode=6,t.TriangleStripDrawMode=7,t.TriangleFanDrawMode=8,t.ClockWiseSideOrientation=0,t.CounterClockWiseSideOrientation=1,t.TextureDirtyFlag=1,t.LightDirtyFlag=2,t.FresnelDirtyFlag=4,t.AttributesDirtyFlag=8,t.MiscDirtyFlag=16,t.PrePassDirtyFlag=32,t.AllDirtyFlag=63,t.MATERIAL_OPAQUE=0,t.MATERIAL_ALPHATEST=1,t.MATERIAL_ALPHABLEND=2,t.MATERIAL_ALPHATESTANDBLEND=3,t.MATERIAL_NORMALBLENDMETHOD_WHITEOUT=0,t.MATERIAL_NORMALBLENDMETHOD_RNM=1,t._AllDirtyCallBack=function(t){return t.markAllAsDirty()},t._ImageProcessingDirtyCallBack=function(t){return t.markAsImageProcessingDirty()},t._TextureDirtyCallBack=function(t){return t.markAsTexturesDirty()},t._FresnelDirtyCallBack=function(t){return t.markAsFresnelDirty()},t._MiscDirtyCallBack=function(t){return t.markAsMiscDirty()},t._PrePassDirtyCallBack=function(t){return t.markAsPrePassDirty()},t._LightsDirtyCallBack=function(t){return t.markAsLightDirty()},t._AttributeDirtyCallBack=function(t){return t.markAsAttributesDirty()},t._FresnelAndMiscDirtyCallBack=function(e){t._FresnelDirtyCallBack(e),t._MiscDirtyCallBack(e)},t._TextureAndMiscDirtyCallBack=function(e){t._TextureDirtyCallBack(e),t._MiscDirtyCallBack(e)},t._DirtyCallbackArray=[],t._RunDirtyCallBacks=function(e){for(var i=0,r=t._DirtyCallbackArray;i<r.length;i++){(0,r[i])(e)}},s([Ft()],t.prototype,"id",void 0),s([Ft()],t.prototype,"uniqueId",void 0),s([Ft()],t.prototype,"name",void 0),s([Ft()],t.prototype,"checkReadyOnEveryCall",void 0),s([Ft()],t.prototype,"checkReadyOnlyOnce",void 0),s([Ft()],t.prototype,"state",void 0),s([Ft("alpha")],t.prototype,"_alpha",void 0),s([Ft("backFaceCulling")],t.prototype,"_backFaceCulling",void 0),s([Ft()],t.prototype,"sideOrientation",void 0),s([Ft("alphaMode")],t.prototype,"_alphaMode",void 0),s([Ft()],t.prototype,"_needDepthPrePass",void 0),s([Ft()],t.prototype,"disableDepthWrite",void 0),s([Ft()],t.prototype,"disableColorWrite",void 0),s([Ft()],t.prototype,"forceDepthWrite",void 0),s([Ft()],t.prototype,"depthFunction",void 0),s([Ft()],t.prototype,"separateCullingPass",void 0),s([Ft("fogEnabled")],t.prototype,"_fogEnabled",void 0),s([Ft()],t.prototype,"pointSize",void 0),s([Ft()],t.prototype,"zOffset",void 0),s([Ft()],t.prototype,"pointsCloud",null),s([Ft()],t.prototype,"fillMode",null),s([Ft()],t.prototype,"transparencyMode",null),t}(),he=function(t){function e(e,i){var r=t.call(this,e,i,!0)||this;return i.multiMaterials.push(r),r.subMaterials=new Array,r._storeEffectOnSubMeshes=!0,r}return n(e,t),Object.defineProperty(e.prototype,"subMaterials",{get:function(){return this._subMaterials},set:function(t){this._subMaterials=t,this._hookArray(t)},enumerable:!1,configurable:!0}),e.prototype.getChildren=function(){return this.subMaterials},e.prototype._hookArray=function(t){var e=this,i=t.push;t.push=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=i.apply(t,r);return e._markAllSubMeshesAsTexturesDirty(),o};var r=t.splice;t.splice=function(i,n){var o=r.apply(t,[i,n]);return e._markAllSubMeshesAsTexturesDirty(),o}},e.prototype.getSubMaterial=function(t){return t<0||t>=this.subMaterials.length?this.getScene().defaultMaterial:this.subMaterials[t]},e.prototype.getActiveTextures=function(){var e;return(e=t.prototype.getActiveTextures.call(this)).concat.apply(e,this.subMaterials.map((function(t){return t?t.getActiveTextures():[]})))},e.prototype.hasTexture=function(e){var i;if(t.prototype.hasTexture.call(this,e))return!0;for(var r=0;r<this.subMaterials.length;r++)if(null===(i=this.subMaterials[r])||void 0===i?void 0:i.hasTexture(e))return!0;return!1},e.prototype.getClassName=function(){return"MultiMaterial"},e.prototype.isReadyForSubMesh=function(t,e,i){for(var r=0;r<this.subMaterials.length;r++){var n=this.subMaterials[r];if(n){if(n._storeEffectOnSubMeshes){if(!n.isReadyForSubMesh(t,e,i))return!1;continue}if(!n.isReady(t))return!1}}return!0},e.prototype.clone=function(t,i){for(var r=new e(t,this.getScene()),n=0;n<this.subMaterials.length;n++){var o=null,s=this.subMaterials[n];o=i&&s?s.clone(t+"-"+s.name):this.subMaterials[n],r.subMaterials.push(o)}return r},e.prototype.serialize=function(){var t={};t.name=this.name,t.id=this.id,ct&&(t.tags=ct.GetTags(this)),t.materials=[];for(var e=0;e<this.subMaterials.length;e++){var i=this.subMaterials[e];i?t.materials.push(i.id):t.materials.push(null)}return t},e.prototype.dispose=function(e,i,r){var n=this.getScene();if(n){if(r)for(var o=0;o<this.subMaterials.length;o++){var s=this.subMaterials[o];s&&s.dispose(e,i)}(o=n.multiMaterials.indexOf(this))>=0&&n.multiMaterials.splice(o,1),t.prototype.dispose.call(this,e,i)}},e.ParseMultiMaterial=function(t,i){var r=new e(t.name,i);r.id=t.id,ct&&ct.AddTagsTo(r,t.tags);for(var n=0;n<t.materials.length;n++){var o=t.materials[n];o?r.subMaterials.push(i.getLastMaterialByID(o)):r.subMaterials.push(null)}return r},e}(ue);ot.RegisteredTypes["BABYLON.MultiMaterial"]=he;var le=function(){function t(){}return t.NAME_EFFECTLAYER="EffectLayer",t.NAME_LAYER="Layer",t.NAME_LENSFLARESYSTEM="LensFlareSystem",t.NAME_BOUNDINGBOXRENDERER="BoundingBoxRenderer",t.NAME_PARTICLESYSTEM="ParticleSystem",t.NAME_GAMEPAD="Gamepad",t.NAME_SIMPLIFICATIONQUEUE="SimplificationQueue",t.NAME_GEOMETRYBUFFERRENDERER="GeometryBufferRenderer",t.NAME_PREPASSRENDERER="PrePassRenderer",t.NAME_DEPTHRENDERER="DepthRenderer",t.NAME_POSTPROCESSRENDERPIPELINEMANAGER="PostProcessRenderPipelineManager",t.NAME_SPRITE="Sprite",t.NAME_SUBSURFACE="SubSurface",t.NAME_OUTLINERENDERER="Outline",t.NAME_PROCEDURALTEXTURE="ProceduralTexture",t.NAME_SHADOWGENERATOR="ShadowGenerator",t.NAME_OCTREE="Octree",t.NAME_PHYSICSENGINE="PhysicsEngine",t.NAME_AUDIO="Audio",t.STEP_ISREADYFORMESH_EFFECTLAYER=0,t.STEP_BEFOREEVALUATEACTIVEMESH_BOUNDINGBOXRENDERER=0,t.STEP_EVALUATESUBMESH_BOUNDINGBOXRENDERER=0,t.STEP_PREACTIVEMESH_BOUNDINGBOXRENDERER=0,t.STEP_CAMERADRAWRENDERTARGET_EFFECTLAYER=1,t.STEP_BEFORECAMERADRAW_EFFECTLAYER=0,t.STEP_BEFORECAMERADRAW_LAYER=1,t.STEP_BEFORECAMERADRAW_PREPASS=2,t.STEP_BEFORERENDERTARGETDRAW_LAYER=0,t.STEP_BEFORERENDERINGMESH_PREPASS=0,t.STEP_BEFORERENDERINGMESH_OUTLINE=1,t.STEP_AFTERRENDERINGMESH_PREPASS=0,t.STEP_AFTERRENDERINGMESH_OUTLINE=1,t.STEP_AFTERRENDERINGGROUPDRAW_EFFECTLAYER_DRAW=0,t.STEP_AFTERRENDERINGGROUPDRAW_BOUNDINGBOXRENDERER=1,t.STEP_BEFORECAMERAUPDATE_SIMPLIFICATIONQUEUE=0,t.STEP_BEFORECAMERAUPDATE_GAMEPAD=1,t.STEP_BEFORECLEAR_PROCEDURALTEXTURE=0,t.STEP_AFTERRENDERTARGETDRAW_LAYER=0,t.STEP_AFTERCAMERADRAW_EFFECTLAYER=0,t.STEP_AFTERCAMERADRAW_LENSFLARESYSTEM=1,t.STEP_AFTERCAMERADRAW_EFFECTLAYER_DRAW=2,t.STEP_AFTERCAMERADRAW_LAYER=3,t.STEP_AFTERCAMERADRAW_PREPASS=4,t.STEP_AFTERRENDER_AUDIO=0,t.STEP_GATHERRENDERTARGETS_DEPTHRENDERER=0,t.STEP_GATHERRENDERTARGETS_GEOMETRYBUFFERRENDERER=1,t.STEP_GATHERRENDERTARGETS_SHADOWGENERATOR=2,t.STEP_GATHERRENDERTARGETS_POSTPROCESSRENDERPIPELINEMANAGER=3,t.STEP_GATHERACTIVECAMERARENDERTARGETS_DEPTHRENDERER=0,t.STEP_BEFORECLEARSTAGE_PREPASS=0,t.STEP_POINTERMOVE_SPRITE=0,t.STEP_POINTERDOWN_SPRITE=0,t.STEP_POINTERUP_SPRITE=0,t}(),ce=(function(t){function e(e){return t.apply(this,e)||this}n(e,t),e.Create=function(){return Object.create(e.prototype)},e.prototype.registerStep=function(t,e,i){var r=0;for(Number.MAX_VALUE;r<this.length;r++){if(t<this[r].index)break}this.splice(r,0,{index:t,component:e,action:i.bind(e)})},e.prototype.clear=function(){this.length=0}}(Array),function(t,e){this.distance=t,this.mesh=e}),fe=function(){this.visibleInstances={},this.batchCache=new de,this.instancesBufferSize=2048},de=function(){this.mustReturn=!1,this.visibleInstances=new Array,this.renderSelf=new Array,this.hardwareInstancedRendering=new Array},pe=function(){this.instancesCount=0,this.matrixBuffer=null,this.matrixBufferSize=512,this.boundingVectors=[],this.worldMatrices=null},_e=function(){this._areNormalsFrozen=!1,this._source=null,this.meshMap=null,this._preActivateId=-1,this._LODLevels=new Array,this._morphTargetManager=null},ge=function(t){function e(i,r,n,o,s,a){void 0===r&&(r=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===a&&(a=!0);var u=t.call(this,i,r)||this;if(u._internalMeshDataInfo=new _e,u.delayLoadState=0,u.instances=new Array,u._creationDataStorage=null,u._geometry=null,u._instanceDataStorage=new fe,u._thinInstanceDataStorage=new pe,u._effectiveMaterial=null,u._shouldGenerateFlatShading=!1,u._originalBuilderSideOrientation=e.DEFAULTSIDE,u.overrideMaterialSideOrientation=null,r=u.getScene(),o){if(o._geometry&&o._geometry.applyToMesh(u),_.DeepCopy(o,u,["name","material","skeleton","instances","parent","uniqueId","source","metadata","morphTargetManager","hasInstances","source","worldMatrixInstancedBuffer","hasLODLevels","geometry","isBlocked","areNormalsFrozen","facetNb","isFacetDataEnabled","lightSources","useBones","isAnInstance","collider","edgesRenderer","forward","up","right","absolutePosition","absoluteScaling","absoluteRotationQuaternion","isWorldMatrixFrozen","nonUniformScaling","behaviors","worldMatrixFromCache","hasThinInstances","cloneMeshMap"],["_poseMatrix"]),u._internalMeshDataInfo._source=o,r.useClonedMeshMap&&(o._internalMeshDataInfo.meshMap||(o._internalMeshDataInfo.meshMap={}),o._internalMeshDataInfo.meshMap[u.uniqueId]=u),u._originalBuilderSideOrientation=o._originalBuilderSideOrientation,u._creationDataStorage=o._creationDataStorage,o._ranges){var h=o._ranges;for(var i in h)h.hasOwnProperty(i)&&h[i]&&u.createAnimationRange(i,h[i].from,h[i].to)}var l;if(o.metadata&&o.metadata.clone?u.metadata=o.metadata.clone():u.metadata=o.metadata,ct&&ct.HasTags(o)&&ct.AddTagsTo(u,ct.GetTags(o,!0)),u.setEnabled(o.isEnabled()),u.parent=o.parent,u.setPivotMatrix(o.getPivotMatrix()),u.id=i+"."+o.id,u.material=o.material,!s)for(var c=o.getDescendants(!0),f=0;f<c.length;f++){var d=c[f];d.clone&&d.clone(i+"."+d.name,u)}if(o.morphTargetManager&&(u.morphTargetManager=o.morphTargetManager),r.getPhysicsEngine){var p=r.getPhysicsEngine();if(a&&p){var g=p.getImpostorForPhysicsObject(o);g&&(u.physicsImpostor=g.clone(u))}}for(l=0;l<r.particleSystems.length;l++){var m=r.particleSystems[l];m.emitter===o&&m.clone(m.name,u)}u.refreshBoundingInfo(),u.computeWorldMatrix(!0)}return null!==n&&(u.parent=n),u._instanceDataStorage.hardwareInstancedRendering=u.getEngine().getCaps().instancedArrays,u}return n(e,t),e._GetDefaultSideOrientation=function(t){return t||e.FRONTSIDE},Object.defineProperty(e.prototype,"computeBonesUsingShaders",{get:function(){return this._internalAbstractMeshDataInfo._computeBonesUsingShaders},set:function(t){this._internalAbstractMeshDataInfo._computeBonesUsingShaders!==t&&(t&&this._internalMeshDataInfo._sourcePositions&&(this.setVerticesData(Bt.PositionKind,this._internalMeshDataInfo._sourcePositions.slice(),!0),this._internalMeshDataInfo._sourceNormals&&this.setVerticesData(Bt.NormalKind,this._internalMeshDataInfo._sourceNormals.slice(),!0)),this._internalAbstractMeshDataInfo._computeBonesUsingShaders=t,this._markSubMeshesAsAttributesDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBeforeRenderObservable",{get:function(){return this._internalMeshDataInfo._onBeforeRenderObservable||(this._internalMeshDataInfo._onBeforeRenderObservable=new l),this._internalMeshDataInfo._onBeforeRenderObservable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBeforeBindObservable",{get:function(){return this._internalMeshDataInfo._onBeforeBindObservable||(this._internalMeshDataInfo._onBeforeBindObservable=new l),this._internalMeshDataInfo._onBeforeBindObservable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onAfterRenderObservable",{get:function(){return this._internalMeshDataInfo._onAfterRenderObservable||(this._internalMeshDataInfo._onAfterRenderObservable=new l),this._internalMeshDataInfo._onAfterRenderObservable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBeforeDrawObservable",{get:function(){return this._internalMeshDataInfo._onBeforeDrawObservable||(this._internalMeshDataInfo._onBeforeDrawObservable=new l),this._internalMeshDataInfo._onBeforeDrawObservable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onBeforeDraw",{set:function(t){this._onBeforeDrawObserver&&this.onBeforeDrawObservable.remove(this._onBeforeDrawObserver),this._onBeforeDrawObserver=this.onBeforeDrawObservable.add(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasInstances",{get:function(){return this.instances.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasThinInstances",{get:function(){var t;return(null!==(t=this._thinInstanceDataStorage.instancesCount)&&void 0!==t?t:0)>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"morphTargetManager",{get:function(){return this._internalMeshDataInfo._morphTargetManager},set:function(t){this._internalMeshDataInfo._morphTargetManager!==t&&(this._internalMeshDataInfo._morphTargetManager=t,this._syncGeometryWithMorphTargetManager())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this._internalMeshDataInfo._source},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cloneMeshMap",{get:function(){return this._internalMeshDataInfo.meshMap},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUnIndexed",{get:function(){return this._unIndexed},set:function(t){this._unIndexed!==t&&(this._unIndexed=t,this._markSubMeshesAsAttributesDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"worldMatrixInstancedBuffer",{get:function(){return this._instanceDataStorage.instancesData},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"manualUpdateOfWorldMatrixInstancedBuffer",{get:function(){return this._instanceDataStorage.manualUpdate},set:function(t){this._instanceDataStorage.manualUpdate=t},enumerable:!1,configurable:!0}),e.prototype.instantiateHierarchy=function(t,e,i){void 0===t&&(t=null);var r=!(this.getTotalVertices()>0)||e&&e.doNotInstantiate?this.clone("Clone of "+(this.name||this.id),t||this.parent,!0):this.createInstance("instance of "+(this.name||this.id));r&&(r.parent=t||this.parent,r.position=this.position.clone(),r.scaling=this.scaling.clone(),this.rotationQuaternion?r.rotationQuaternion=this.rotationQuaternion.clone():r.rotation=this.rotation.clone(),i&&i(this,r));for(var n=0,o=this.getChildTransformNodes(!0);n<o.length;n++){o[n].instantiateHierarchy(r,e,i)}return r},e.prototype.getClassName=function(){return"Mesh"},Object.defineProperty(e.prototype,"_isMesh",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.toString=function(e){var i=t.prototype.toString.call(this,e);if(i+=", n vertices: "+this.getTotalVertices(),i+=", parent: "+(this._waitingParentId?this._waitingParentId:this.parent?this.parent.name:"NONE"),this.animations)for(var r=0;r<this.animations.length;r++)i+=", animation[0]: "+this.animations[r].toString(e);if(e)if(this._geometry){var n=this.getIndices(),o=this.getVerticesData(Bt.PositionKind);o&&n&&(i+=", flat shading: "+(o.length/3===n.length?"YES":"NO"))}else i+=", flat shading: UNKNOWN";return i},e.prototype._unBindEffect=function(){t.prototype._unBindEffect.call(this);for(var e=0,i=this.instances;e<i.length;e++){i[e]._unBindEffect()}},Object.defineProperty(e.prototype,"hasLODLevels",{get:function(){return this._internalMeshDataInfo._LODLevels.length>0},enumerable:!1,configurable:!0}),e.prototype.getLODLevels=function(){return this._internalMeshDataInfo._LODLevels},e.prototype._sortLODLevels=function(){this._internalMeshDataInfo._LODLevels.sort((function(t,e){return t.distance<e.distance?1:t.distance>e.distance?-1:0}))},e.prototype.addLODLevel=function(t,e){if(e&&e._masterMesh)return f.Warn("You cannot use a mesh as LOD level twice"),this;var i=new ce(t,e);return this._internalMeshDataInfo._LODLevels.push(i),e&&(e._masterMesh=this),this._sortLODLevels(),this},e.prototype.getLODLevelAtDistance=function(t){for(var e=this._internalMeshDataInfo,i=0;i<e._LODLevels.length;i++){var r=e._LODLevels[i];if(r.distance===t)return r.mesh}return null},e.prototype.removeLODLevel=function(t){for(var e=this._internalMeshDataInfo,i=0;i<e._LODLevels.length;i++)e._LODLevels[i].mesh===t&&(e._LODLevels.splice(i,1),t&&(t._masterMesh=null));return this._sortLODLevels(),this},e.prototype.getLOD=function(t,e){var i,r=this._internalMeshDataInfo;if(!r._LODLevels||0===r._LODLevels.length)return this;e?i=e:i=this.getBoundingInfo().boundingSphere;var n=i.centerWorld.subtract(t.globalPosition).length();if(r._LODLevels[r._LODLevels.length-1].distance>n)return this.onLODLevelSelection&&this.onLODLevelSelection(n,this,this),this;for(var o=0;o<r._LODLevels.length;o++){var s=r._LODLevels[o];if(s.distance<n){if(s.mesh){if(4===s.mesh.delayLoadState)return s.mesh._checkDelayState(),this;if(2===s.mesh.delayLoadState)return this;s.mesh._preActivate(),s.mesh._updateSubMeshesBoundingInfo(this.worldMatrixFromCache)}return this.onLODLevelSelection&&this.onLODLevelSelection(n,this,s.mesh),s.mesh}}return this.onLODLevelSelection&&this.onLODLevelSelection(n,this,this),this},Object.defineProperty(e.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),e.prototype.getTotalVertices=function(){return null===this._geometry||void 0===this._geometry?0:this._geometry.getTotalVertices()},e.prototype.getVerticesData=function(t,e,i){return this._geometry?this._geometry.getVerticesData(t,e,i):null},e.prototype.getVertexBuffer=function(t){return this._geometry?this._geometry.getVertexBuffer(t):null},e.prototype.isVerticesDataPresent=function(t){return this._geometry?this._geometry.isVerticesDataPresent(t):!!this._delayInfo&&-1!==this._delayInfo.indexOf(t)},e.prototype.isVertexBufferUpdatable=function(t){return this._geometry?this._geometry.isVertexBufferUpdatable(t):!!this._delayInfo&&-1!==this._delayInfo.indexOf(t)},e.prototype.getVerticesDataKinds=function(){if(!this._geometry){var t=new Array;return this._delayInfo&&this._delayInfo.forEach((function(e){t.push(e)})),t}return this._geometry.getVerticesDataKinds()},e.prototype.getTotalIndices=function(){return this._geometry?this._geometry.getTotalIndices():0},e.prototype.getIndices=function(t,e){return this._geometry?this._geometry.getIndices(t,e):[]},Object.defineProperty(e.prototype,"isBlocked",{get:function(){return null!==this._masterMesh&&void 0!==this._masterMesh},enumerable:!1,configurable:!0}),e.prototype.isReady=function(e,i){var r,n,o,s,a,u;if(void 0===e&&(e=!1),void 0===i&&(i=!1),2===this.delayLoadState)return!1;if(!t.prototype.isReady.call(this,e))return!1;if(!this.subMeshes||0===this.subMeshes.length)return!0;if(!e)return!0;var h=this.getEngine(),l=this.getScene(),c=i||h.getCaps().instancedArrays&&(this.instances.length>0||this.hasThinInstances);this.computeWorldMatrix();var f=this.material||l.defaultMaterial;if(f)if(f._storeEffectOnSubMeshes)for(var d=0,p=this.subMeshes;d<p.length;d++){var _=(x=p[d]).getMaterial();if(_)if(_._storeEffectOnSubMeshes){if(!_.isReadyForSubMesh(this,x,c))return!1}else if(!_.isReady(this,c))return!1}else if(!f.isReady(this,c))return!1;for(var g=0,m=this.lightSources;g<m.length;g++){var y=m[g].getShadowGenerator();if(y&&(!(null===(r=y.getShadowMap())||void 0===r?void 0:r.renderList)||(null===(n=y.getShadowMap())||void 0===n?void 0:n.renderList)&&-1!==(null===(s=null===(o=y.getShadowMap())||void 0===o?void 0:o.renderList)||void 0===s?void 0:s.indexOf(this))))for(var v=0,b=this.subMeshes;v<b.length;v++){var x=b[v];if(!y.isReady(x,c,null!==(u=null===(a=x.getMaterial())||void 0===a?void 0:a.needAlphaBlendingForMesh(this))&&void 0!==u&&u))return!1}}for(var A=0,E=this._internalMeshDataInfo._LODLevels;A<E.length;A++){var T=E[A];if(T.mesh&&!T.mesh.isReady(c))return!1}return!0},Object.defineProperty(e.prototype,"areNormalsFrozen",{get:function(){return this._internalMeshDataInfo._areNormalsFrozen},enumerable:!1,configurable:!0}),e.prototype.freezeNormals=function(){return this._internalMeshDataInfo._areNormalsFrozen=!0,this},e.prototype.unfreezeNormals=function(){return this._internalMeshDataInfo._areNormalsFrozen=!1,this},Object.defineProperty(e.prototype,"overridenInstanceCount",{set:function(t){this._instanceDataStorage.overridenInstanceCount=t},enumerable:!1,configurable:!0}),e.prototype._preActivate=function(){var t=this._internalMeshDataInfo,e=this.getScene().getRenderId();return t._preActivateId===e||(t._preActivateId=e,this._instanceDataStorage.visibleInstances=null),this},e.prototype._preActivateForIntermediateRendering=function(t){return this._instanceDataStorage.visibleInstances&&(this._instanceDataStorage.visibleInstances.intermediateDefaultRenderId=t),this},e.prototype._registerInstanceForRenderId=function(t,e){return this._instanceDataStorage.visibleInstances||(this._instanceDataStorage.visibleInstances={defaultRenderId:e,selfDefaultRenderId:this._renderId}),this._instanceDataStorage.visibleInstances[e]||(void 0!==this._instanceDataStorage.previousRenderId&&this._instanceDataStorage.isFrozen&&(this._instanceDataStorage.visibleInstances[this._instanceDataStorage.previousRenderId]=null),this._instanceDataStorage.previousRenderId=e,this._instanceDataStorage.visibleInstances[e]=new Array),this._instanceDataStorage.visibleInstances[e].push(t),this},e.prototype._afterComputeWorldMatrix=function(){t.prototype._afterComputeWorldMatrix.call(this),this.hasThinInstances&&(this.doNotSyncBoundingInfo||this.thinInstanceRefreshBoundingInfo(!1))},e.prototype._postActivate=function(){this.edgesShareWithInstances&&this.edgesRenderer&&this.edgesRenderer.isEnabled&&this._renderingGroup&&(this._renderingGroup._edgesRenderers.pushNoDuplicate(this.edgesRenderer),this.edgesRenderer.customInstances.push(this.getWorldMatrix()))},e.prototype.refreshBoundingInfo=function(t){if(void 0===t&&(t=!1),this._boundingInfo&&this._boundingInfo.isLocked)return this;var e=this.geometry?this.geometry.boundingBias:null;return this._refreshBoundingInfo(this._getPositionData(t),e),this},e.prototype._createGlobalSubMesh=function(t){var e=this.getTotalVertices();if(!e||!this.getIndices())return null;if(this.subMeshes&&this.subMeshes.length>0){var i=this.getIndices();if(!i)return null;var r=i.length,n=!1;if(t)n=!0;else for(var o=0,s=this.subMeshes;o<s.length;o++){var a=s[o];if(a.indexStart+a.indexCount>r){n=!0;break}if(a.verticesStart+a.verticesCount>e){n=!0;break}}if(!n)return this.subMeshes[0]}return this.releaseSubMeshes(),new jt(0,0,e,0,this.getTotalIndices(),this)},e.prototype.subdivide=function(t){if(!(t<1)){for(var e=this.getTotalIndices(),i=e/t|0,r=0;i%3!=0;)i++;this.releaseSubMeshes();for(var n=0;n<t&&!(r>=e);n++)jt.CreateFromIndices(0,r,n===t-1?e-r:i,this),r+=i;this.synchronizeInstances()}},e.prototype.setVerticesData=function(t,e,i,r){if(void 0===i&&(i=!1),this._geometry)this._geometry.setVerticesData(t,e,i,r);else{var n=new wt;n.set(e,t);var o=this.getScene();new Xt(Xt.RandomId(),o,n,i,this)}return this},e.prototype.removeVerticesData=function(t){this._geometry&&this._geometry.removeVerticesData(t)},e.prototype.markVerticesDataAsUpdatable=function(t,e){void 0===e&&(e=!0);var i=this.getVertexBuffer(t);i&&i.isUpdatable()!==e&&this.setVerticesData(t,this.getVerticesData(t),e)},e.prototype.setVerticesBuffer=function(t){return this._geometry||(this._geometry=Xt.CreateGeometryForMesh(this)),this._geometry.setVerticesBuffer(t),this},e.prototype.updateVerticesData=function(t,e,i,r){return this._geometry?(r?(this.makeGeometryUnique(),this.updateVerticesData(t,e,i,!1)):this._geometry.updateVerticesData(t,e,i),this):this},e.prototype.updateMeshPositions=function(t,e){void 0===e&&(e=!0);var i=this.getVerticesData(Bt.PositionKind);if(!i)return this;if(t(i),this.updateVerticesData(Bt.PositionKind,i,!1,!1),e){var r=this.getIndices(),n=this.getVerticesData(Bt.NormalKind);if(!n)return this;wt.ComputeNormals(i,r,n),this.updateVerticesData(Bt.NormalKind,n,!1,!1)}return this},e.prototype.makeGeometryUnique=function(){if(!this._geometry)return this;if(1===this._geometry.meshes.length)return this;var t=this._geometry,e=this._geometry.copy(Xt.RandomId());return t.releaseForMesh(this,!0),e.applyToMesh(this),this},e.prototype.setIndices=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=!1),this._geometry)this._geometry.setIndices(t,e,i);else{var r=new wt;r.indices=t;var n=this.getScene();new Xt(Xt.RandomId(),n,r,i,this)}return this},e.prototype.updateIndices=function(t,e,i){return void 0===i&&(i=!1),this._geometry?(this._geometry.updateIndices(t,e,i),this):this},e.prototype.toLeftHanded=function(){return this._geometry?(this._geometry.toLeftHanded(),this):this},e.prototype._bind=function(t,e,i){if(!this._geometry)return this;var r,n=this.getScene().getEngine();if(this._unIndexed)r=null;else switch(i){case ue.PointFillMode:r=null;break;case ue.WireFrameFillMode:r=t._getLinesIndexBuffer(this.getIndices(),n);break;default:case ue.TriangleFillMode:r=this._geometry.getIndexBuffer()}return this._geometry._bind(e,r),this},e.prototype._draw=function(t,e,i){if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;this._internalMeshDataInfo._onBeforeDrawObservable&&this._internalMeshDataInfo._onBeforeDrawObservable.notifyObservers(this);var r=this.getScene().getEngine();return this._unIndexed||e==ue.PointFillMode?r.drawArraysType(e,t.verticesStart,t.verticesCount,i):e==ue.WireFrameFillMode?r.drawElementsType(e,0,t._linesIndexCount,i):r.drawElementsType(e,t.indexStart,t.indexCount,i),this},e.prototype.registerBeforeRender=function(t){return this.onBeforeRenderObservable.add(t),this},e.prototype.unregisterBeforeRender=function(t){return this.onBeforeRenderObservable.removeCallback(t),this},e.prototype.registerAfterRender=function(t){return this.onAfterRenderObservable.add(t),this},e.prototype.unregisterAfterRender=function(t){return this.onAfterRenderObservable.removeCallback(t),this},e.prototype._getInstancesRenderList=function(t,e){if(void 0===e&&(e=!1),this._instanceDataStorage.isFrozen&&this._instanceDataStorage.previousBatch)return this._instanceDataStorage.previousBatch;var i=this.getScene(),r=i._isInIntermediateRendering(),n=r?this._internalAbstractMeshDataInfo._onlyForInstancesIntermediate:this._internalAbstractMeshDataInfo._onlyForInstances,o=this._instanceDataStorage.batchCache;if(o.mustReturn=!1,o.renderSelf[t]=e||!n&&this.isEnabled()&&this.isVisible,o.visibleInstances[t]=null,this._instanceDataStorage.visibleInstances&&!e){var s=this._instanceDataStorage.visibleInstances,a=i.getRenderId(),u=r?s.intermediateDefaultRenderId:s.defaultRenderId;o.visibleInstances[t]=s[a],!o.visibleInstances[t]&&u&&(o.visibleInstances[t]=s[u])}return o.hardwareInstancedRendering[t]=!e&&this._instanceDataStorage.hardwareInstancedRendering&&null!==o.visibleInstances[t]&&void 0!==o.visibleInstances[t],this._instanceDataStorage.previousBatch=o,o},e.prototype._renderWithInstances=function(t,e,i,r,n){var o=i.visibleInstances[t._id];if(!o)return this;for(var s=this._instanceDataStorage,a=s.instancesBufferSize,u=s.instancesBuffer,h=16*(o.length+1)*4;s.instancesBufferSize<h;)s.instancesBufferSize*=2;s.instancesData&&a==s.instancesBufferSize||(s.instancesData=new Float32Array(s.instancesBufferSize/4));var l=0,c=0,f=i.renderSelf[t._id],d=!u||a!==s.instancesBufferSize;if(this._instanceDataStorage.manualUpdate||s.isFrozen&&!d)c=(f?1:0)+o.length;else{var p=this._effectiveMesh.getWorldMatrix();if(f&&(p.copyToArray(s.instancesData,l),l+=16,c++),o)for(var _=0;_<o.length;_++){o[_].getWorldMatrix().copyToArray(s.instancesData,l),l+=16,c++}}return d?(u&&u.dispose(),u=new Ct(n,s.instancesData,!0,16,!1,!0),s.instancesBuffer=u,this.setVerticesBuffer(u.createVertexBuffer("world0",0,4)),this.setVerticesBuffer(u.createVertexBuffer("world1",4,4)),this.setVerticesBuffer(u.createVertexBuffer("world2",8,4)),this.setVerticesBuffer(u.createVertexBuffer("world3",12,4))):this._instanceDataStorage.isFrozen||u.updateDirectly(s.instancesData,0,c),this._processInstancedBuffers(o,f),this.getScene()._activeIndices.addCount(t.indexCount*c,!1),this._bind(t,r,e),this._draw(t,e,c),n.unbindInstanceAttributes(),this},e.prototype._renderWithThinInstances=function(t,e,i,r){var n,o,s=null!==(o=null===(n=this._thinInstanceDataStorage)||void 0===n?void 0:n.instancesCount)&&void 0!==o?o:0;this.getScene()._activeIndices.addCount(t.indexCount*s,!1),this._bind(t,i,e),this._draw(t,e,s),r.unbindInstanceAttributes()},e.prototype._processInstancedBuffers=function(t,e){},e.prototype._processRendering=function(t,e,i,r,n,o,s,a){var u=this.getScene(),h=u.getEngine();if(o&&e.getRenderingMesh().hasThinInstances)return this._renderWithThinInstances(e,r,i,h),this;if(o)this._renderWithInstances(e,r,n,i,h);else{var l=0;n.renderSelf[e._id]&&(s&&s(!1,t._effectiveMesh.getWorldMatrix(),a),l++,this._draw(e,r,this._instanceDataStorage.overridenInstanceCount));var c=n.visibleInstances[e._id];if(c){var f=c.length;l+=f;for(var d=0;d<f;d++){var p=c[d].getWorldMatrix();s&&s(!0,p,a),this._draw(e,r)}}u._activeIndices.addCount(e.indexCount*l,!1)}return this},e.prototype._rebuild=function(){this._instanceDataStorage.instancesBuffer&&(this._instanceDataStorage.instancesBuffer.dispose(),this._instanceDataStorage.instancesBuffer=null),t.prototype._rebuild.call(this)},e.prototype._freeze=function(){if(this.subMeshes){for(var t=0;t<this.subMeshes.length;t++)this._getInstancesRenderList(t);this._effectiveMaterial=null,this._instanceDataStorage.isFrozen=!0}},e.prototype._unFreeze=function(){this._instanceDataStorage.isFrozen=!1,this._instanceDataStorage.previousBatch=null},e.prototype.render=function(t,e,i){var r=this.getScene();if(this._internalAbstractMeshDataInfo._isActiveIntermediate?this._internalAbstractMeshDataInfo._isActiveIntermediate=!1:this._internalAbstractMeshDataInfo._isActive=!1,this._checkOcclusionQuery())return this;var n=this._getInstancesRenderList(t._id,!!i);if(n.mustReturn)return this;if(!this._geometry||!this._geometry.getVertexBuffers()||!this._unIndexed&&!this._geometry.getIndexBuffer())return this;this._internalMeshDataInfo._onBeforeRenderObservable&&this._internalMeshDataInfo._onBeforeRenderObservable.notifyObservers(this);var o,s=r.getEngine(),a=n.hardwareInstancedRendering[t._id]||t.getRenderingMesh().hasThinInstances,u=this._instanceDataStorage,h=t.getMaterial();if(!h)return this;if(!u.isFrozen||!this._effectiveMaterial||this._effectiveMaterial!==h){if(h._storeEffectOnSubMeshes){if(!h.isReadyForSubMesh(this,t,a))return this}else if(!h.isReady(this,a))return this;this._effectiveMaterial=h}e&&s.setAlphaMode(this._effectiveMaterial.alphaMode),o=this._effectiveMaterial._storeEffectOnSubMeshes?t.effect:this._effectiveMaterial.getEffect();for(var l=0,c=r._beforeRenderingMeshStage;l<c.length;l++){c[l].action(this,t,n,o)}if(!o)return this;var f,d=i||this._effectiveMesh;if(u.isFrozen||!this._effectiveMaterial.backFaceCulling&&null===this.overrideMaterialSideOrientation)f=u.sideOrientation;else{var p=d._getWorldMatrixDeterminant();null==(f=this.overrideMaterialSideOrientation)&&(f=this._effectiveMaterial.sideOrientation),p<0&&(f=f===ue.ClockWiseSideOrientation?ue.CounterClockWiseSideOrientation:ue.ClockWiseSideOrientation),u.sideOrientation=f}var _=this._effectiveMaterial._preBind(o,f);this._effectiveMaterial.forceDepthWrite&&s.setDepthWrite(!0);var g=r.forcePointsCloud?ue.PointFillMode:r.forceWireframe?ue.WireFrameFillMode:this._effectiveMaterial.fillMode;this._internalMeshDataInfo._onBeforeBindObservable&&this._internalMeshDataInfo._onBeforeBindObservable.notifyObservers(this),a||this._bind(t,o,g);var m=d.getWorldMatrix();this._effectiveMaterial._storeEffectOnSubMeshes?this._effectiveMaterial.bindForSubMesh(m,this,t):this._effectiveMaterial.bind(m,this),!this._effectiveMaterial.backFaceCulling&&this._effectiveMaterial.separateCullingPass&&(s.setState(!0,this._effectiveMaterial.zOffset,!1,!_),this._processRendering(this,t,o,g,n,a,this._onBeforeDraw,this._effectiveMaterial),s.setState(!0,this._effectiveMaterial.zOffset,!1,_)),this._processRendering(this,t,o,g,n,a,this._onBeforeDraw,this._effectiveMaterial),this._effectiveMaterial.unbind();for(var y=0,v=r._afterRenderingMeshStage;y<v.length;y++){v[y].action(this,t,n,o)}return this._internalMeshDataInfo._onAfterRenderObservable&&this._internalMeshDataInfo._onAfterRenderObservable.notifyObservers(this),this},e.prototype._onBeforeDraw=function(t,e,i){t&&i&&i.bindOnlyWorldMatrix(e)},e.prototype.cleanMatrixWeights=function(){this.isVerticesDataPresent(Bt.MatricesWeightsKind)&&(this.isVerticesDataPresent(Bt.MatricesWeightsExtraKind)?this.normalizeSkinWeightsAndExtra():this.normalizeSkinFourWeights())},e.prototype.normalizeSkinFourWeights=function(){for(var t=this.getVerticesData(Bt.MatricesWeightsKind),e=t.length,i=0;i<e;i+=4){var r=t[i]+t[i+1]+t[i+2]+t[i+3];if(0===r)t[i]=1;else{var n=1/r;t[i]*=n,t[i+1]*=n,t[i+2]*=n,t[i+3]*=n}}this.setVerticesData(Bt.MatricesWeightsKind,t)},e.prototype.normalizeSkinWeightsAndExtra=function(){for(var t=this.getVerticesData(Bt.MatricesWeightsExtraKind),e=this.getVerticesData(Bt.MatricesWeightsKind),i=e.length,r=0;r<i;r+=4){var n=e[r]+e[r+1]+e[r+2]+e[r+3];if(0===(n+=t[r]+t[r+1]+t[r+2]+t[r+3]))e[r]=1;else{var o=1/n;e[r]*=o,e[r+1]*=o,e[r+2]*=o,e[r+3]*=o,t[r]*=o,t[r+1]*=o,t[r+2]*=o,t[r+3]*=o}}this.setVerticesData(Bt.MatricesWeightsKind,e),this.setVerticesData(Bt.MatricesWeightsKind,t)},e.prototype.validateSkinning=function(){var t=this.getVerticesData(Bt.MatricesWeightsExtraKind),e=this.getVerticesData(Bt.MatricesWeightsKind);if(null===e||null==this.skeleton)return{skinned:!1,valid:!0,report:"not skinned"};for(var i=e.length,r=0,n=0,o=0,s=0,a=null===t?4:8,u=new Array,h=0;h<=a;h++)u[h]=0;for(h=0;h<i;h+=4){for(var l=e[h],c=l,f=0===c?0:1,d=1;d<a;d++){var p=d<4?e[h+d]:t[h+d-4];p>l&&r++,0!==p&&f++,c+=p,l=p}if(u[f]++,f>o&&(o=f),0===c)n++;else{var _=1/c,g=0;for(d=0;d<a;d++)g+=d<4?Math.abs(e[h+d]-e[h+d]*_):Math.abs(t[h+d-4]-t[h+d-4]*_);g>.001&&s++}}var m=this.skeleton.bones.length,y=this.getVerticesData(Bt.MatricesIndicesKind),v=this.getVerticesData(Bt.MatricesIndicesExtraKind),b=0;for(h=0;h<i;h+=4)for(d=0;d<a;d++){var x=d<4?y[h+d]:v[h+d-4];(x>=m||x<0)&&b++}return{skinned:!0,valid:0===n&&0===s&&0===b,report:"Number of Weights = "+i/4+"\nMaximum influences = "+o+"\nMissing Weights = "+n+"\nNot Sorted = "+r+"\nNot Normalized = "+s+"\nWeightCounts = ["+u+"]\nNumber of bones = "+m+"\nBad Bone Indices = "+b}},e.prototype._checkDelayState=function(){var t=this.getScene();return this._geometry?this._geometry.load(t):4===this.delayLoadState&&(this.delayLoadState=2,this._queueLoad(t)),this},e.prototype._queueLoad=function(t){var e=this;t._addPendingData(this);var i=-1!==this.delayLoadingFile.indexOf(".babylonbinarymeshdata");return ut.LoadFile(this.delayLoadingFile,(function(i){i instanceof ArrayBuffer?e._delayLoadingFunction(i,e):e._delayLoadingFunction(JSON.parse(i),e),e.instances.forEach((function(t){t.refreshBoundingInfo(),t._syncSubMeshes()})),e.delayLoadState=1,t._removePendingData(e)}),(function(){}),t.offlineProvider,i),this},e.prototype.isInFrustum=function(e){return 2!==this.delayLoadState&&(!!t.prototype.isInFrustum.call(this,e)&&(this._checkDelayState(),!0))},e.prototype.setMaterialByID=function(t){var e,i=this.getScene().materials;for(e=i.length-1;e>-1;e--)if(i[e].id===t)return this.material=i[e],this;var r=this.getScene().multiMaterials;for(e=r.length-1;e>-1;e--)if(r[e].id===t)return this.material=r[e],this;return this},e.prototype.getAnimatables=function(){var t=new Array;return this.material&&t.push(this.material),this.skeleton&&t.push(this.skeleton),t},e.prototype.bakeTransformIntoVertices=function(t){if(!this.isVerticesDataPresent(Bt.PositionKind))return this;var e=this.subMeshes.splice(0);this._resetPointsArrayCache();var i,r=this.getVerticesData(Bt.PositionKind),n=new Array;for(i=0;i<r.length;i+=3)_t.TransformCoordinates(_t.FromArray(r,i),t).toArray(n,i);if(this.setVerticesData(Bt.PositionKind,n,this.getVertexBuffer(Bt.PositionKind).isUpdatable()),this.isVerticesDataPresent(Bt.NormalKind)){for(r=this.getVerticesData(Bt.NormalKind),n=[],i=0;i<r.length;i+=3)_t.TransformNormal(_t.FromArray(r,i),t).normalize().toArray(n,i);this.setVerticesData(Bt.NormalKind,n,this.getVertexBuffer(Bt.NormalKind).isUpdatable())}return t.m[0]*t.m[5]*t.m[10]<0&&this.flipFaces(),this.releaseSubMeshes(),this.subMeshes=e,this},e.prototype.bakeCurrentTransformIntoVertices=function(t){return void 0===t&&(t=!0),this.bakeTransformIntoVertices(this.computeWorldMatrix(!0)),this.resetLocalMatrix(t),this},Object.defineProperty(e.prototype,"_positions",{get:function(){return this._geometry?this._geometry._positions:null},enumerable:!1,configurable:!0}),e.prototype._resetPointsArrayCache=function(){return this._geometry&&this._geometry._resetPointsArrayCache(),this},e.prototype._generatePointsArray=function(){return!!this._geometry&&this._geometry._generatePointsArray()},e.prototype.clone=function(t,i,r,n){return void 0===t&&(t=""),void 0===i&&(i=null),void 0===n&&(n=!0),new e(t,this.getScene(),i,this,r,n)},e.prototype.dispose=function(e,i){void 0===i&&(i=!1),this.morphTargetManager=null,this._geometry&&this._geometry.releaseForMesh(this,!0);var r=this._internalMeshDataInfo;if(r._onBeforeDrawObservable&&r._onBeforeDrawObservable.clear(),r._onBeforeBindObservable&&r._onBeforeBindObservable.clear(),r._onBeforeRenderObservable&&r._onBeforeRenderObservable.clear(),r._onAfterRenderObservable&&r._onAfterRenderObservable.clear(),this._scene.useClonedMeshMap){if(r.meshMap)for(var n in r.meshMap){(a=r.meshMap[n])&&(a._internalMeshDataInfo._source=null,r.meshMap[n]=void 0)}r._source&&r._source._internalMeshDataInfo.meshMap&&(r._source._internalMeshDataInfo.meshMap[this.uniqueId]=void 0)}else for(var o=0,s=this.getScene().meshes;o<s.length;o++){var a;(a=s[o])._internalMeshDataInfo&&a._internalMeshDataInfo._source&&a._internalMeshDataInfo._source===this&&(a._internalMeshDataInfo._source=null)}r._source=null,this._disposeInstanceSpecificData(),this._disposeThinInstanceSpecificData(),t.prototype.dispose.call(this,e,i)},e.prototype._disposeInstanceSpecificData=function(){},e.prototype._disposeThinInstanceSpecificData=function(){},e.prototype.applyDisplacementMap=function(t,e,i,r,n,o,s){var a=this;void 0===s&&(s=!1);var u=this.getScene();return ut.LoadImage(t,(function(t){var u=t.width,h=t.height,l=H.CreateCanvas(u,h).getContext("2d");l.drawImage(t,0,0);var c=l.getImageData(0,0,u,h).data;a.applyDisplacementMapFromBuffer(c,u,h,e,i,n,o,s),r&&r(a)}),(function(){}),u.offlineProvider),this},e.prototype.applyDisplacementMapFromBuffer=function(t,e,i,r,n,o,s,a){if(void 0===a&&(a=!1),!this.isVerticesDataPresent(Bt.PositionKind)||!this.isVerticesDataPresent(Bt.NormalKind)||!this.isVerticesDataPresent(Bt.UVKind))return f.Warn("Cannot call applyDisplacementMap: Given mesh is not complete. Position, Normal or UV are missing"),this;var u=this.getVerticesData(Bt.PositionKind,!0,!0),h=this.getVerticesData(Bt.NormalKind),l=this.getVerticesData(Bt.UVKind),c=_t.Zero(),d=_t.Zero(),p=pt.Zero();o=o||pt.Zero(),s=s||new pt(1,1);for(var _=0;_<u.length;_+=3){_t.FromArrayToRef(u,_,c),_t.FromArrayToRef(h,_,d),pt.FromArrayToRef(l,_/3*2,p);var g=4*((Math.abs(p.x*s.x+o.x%1)*(e-1)%e|0)+(Math.abs(p.y*s.y+o.y%1)*(i-1)%i|0)*e),m=.3*(t[g]/255)+.59*(t[g+1]/255)+.11*(t[g+2]/255);d.normalize(),d.scaleInPlace(r+(n-r)*m),(c=c.add(d)).toArray(u,_)}return wt.ComputeNormals(u,this.getIndices(),h),a?(this.setVerticesData(Bt.PositionKind,u),this.setVerticesData(Bt.NormalKind,h)):(this.updateVerticesData(Bt.PositionKind,u),this.updateVerticesData(Bt.NormalKind,h)),this},e.prototype.convertToFlatShadedMesh=function(){var t,e,i=this.getVerticesDataKinds(),r={},n={},o={},s=!1;for(t=0;t<i.length;t++){e=i[t];var a=this.getVertexBuffer(e);e!==Bt.NormalKind?(r[e]=a,n[e]=r[e].getData(),o[e]=[]):(s=a.isUpdatable(),i.splice(t,1),t--)}var u,h=this.subMeshes.slice(0),l=this.getIndices(),c=this.getTotalIndices();for(u=0;u<c;u++){var f=l[u];for(t=0;t<i.length;t++)for(var d=r[e=i[t]].getStrideSize(),p=0;p<d;p++)o[e].push(n[e][f*d+p])}var _=[],g=o[Bt.PositionKind];for(u=0;u<c;u+=3){l[u]=u,l[u+1]=u+1,l[u+2]=u+2;for(var m=_t.FromArray(g,3*u),y=_t.FromArray(g,3*(u+1)),v=_t.FromArray(g,3*(u+2)),b=m.subtract(y),x=v.subtract(y),A=_t.Normalize(_t.Cross(b,x)),E=0;E<3;E++)_.push(A.x),_.push(A.y),_.push(A.z)}for(this.setIndices(l),this.setVerticesData(Bt.NormalKind,_,s),t=0;t<i.length;t++)e=i[t],this.setVerticesData(e,o[e],r[e].isUpdatable());this.releaseSubMeshes();for(var T=0;T<h.length;T++){var M=h[T];jt.AddToMesh(M.materialIndex,M.indexStart,M.indexCount,M.indexStart,M.indexCount,this)}return this.synchronizeInstances(),this},e.prototype.convertToUnIndexedMesh=function(){var t,e,i=this.getVerticesDataKinds(),r={},n={},o={};for(t=0;t<i.length;t++){e=i[t];var s=this.getVertexBuffer(e);r[e]=s,n[e]=r[e].getData(),o[e]=[]}var a,u=this.subMeshes.slice(0),h=this.getIndices(),l=this.getTotalIndices();for(a=0;a<l;a++){var c=h[a];for(t=0;t<i.length;t++)for(var f=r[e=i[t]].getStrideSize(),d=0;d<f;d++)o[e].push(n[e][c*f+d])}for(a=0;a<l;a+=3)h[a]=a,h[a+1]=a+1,h[a+2]=a+2;for(this.setIndices(h),t=0;t<i.length;t++)e=i[t],this.setVerticesData(e,o[e],r[e].isUpdatable());this.releaseSubMeshes();for(var p=0;p<u.length;p++){var _=u[p];jt.AddToMesh(_.materialIndex,_.indexStart,_.indexCount,_.indexStart,_.indexCount,this)}return this._unIndexed=!0,this.synchronizeInstances(),this},e.prototype.flipFaces=function(t){void 0===t&&(t=!1);var e,i,r=wt.ExtractFromMesh(this);if(t&&this.isVerticesDataPresent(Bt.NormalKind)&&r.normals)for(e=0;e<r.normals.length;e++)r.normals[e]*=-1;if(r.indices)for(e=0;e<r.indices.length;e+=3)i=r.indices[e+1],r.indices[e+1]=r.indices[e+2],r.indices[e+2]=i;return r.applyToMesh(this,this.isVertexBufferUpdatable(Bt.PositionKind)),this},e.prototype.increaseVertices=function(t){var e=wt.ExtractFromMesh(this),i=e.uvs,r=e.indices,n=e.positions,o=e.normals;if(r&&n&&o&&i){for(var s,a,u=t+1,h=new Array,l=0;l<u+1;l++)h[l]=new Array;var c,d=new _t(0,0,0),p=new _t(0,0,0),_=new pt(0,0),g=new Array,m=new Array,y=new Array,v=n.length,b=i.length;for(l=0;l<r.length;l+=3){m[0]=r[l],m[1]=r[l+1],m[2]=r[l+2];for(var x=0;x<3;x++)if(s=m[x],a=m[(x+1)%3],void 0===y[s]&&void 0===y[a]?(y[s]=new Array,y[a]=new Array):(void 0===y[s]&&(y[s]=new Array),void 0===y[a]&&(y[a]=new Array)),void 0===y[s][a]&&void 0===y[a][s]){y[s][a]=[],d.x=(n[3*a]-n[3*s])/u,d.y=(n[3*a+1]-n[3*s+1])/u,d.z=(n[3*a+2]-n[3*s+2])/u,p.x=(o[3*a]-o[3*s])/u,p.y=(o[3*a+1]-o[3*s+1])/u,p.z=(o[3*a+2]-o[3*s+2])/u,_.x=(i[2*a]-i[2*s])/u,_.y=(i[2*a+1]-i[2*s+1])/u,y[s][a].push(s);for(var A=1;A<u;A++)y[s][a].push(n.length/3),n[v]=n[3*s]+A*d.x,o[v++]=o[3*s]+A*p.x,n[v]=n[3*s+1]+A*d.y,o[v++]=o[3*s+1]+A*p.y,n[v]=n[3*s+2]+A*d.z,o[v++]=o[3*s+2]+A*p.z,i[b++]=i[2*s]+A*_.x,i[b++]=i[2*s+1]+A*_.y;y[s][a].push(a),y[a][s]=new Array,c=y[s][a].length;for(var E=0;E<c;E++)y[a][s][E]=y[s][a][c-1-E]}h[0][0]=r[l],h[1][0]=y[r[l]][r[l+1]][1],h[1][1]=y[r[l]][r[l+2]][1];for(A=2;A<u;A++){h[A][0]=y[r[l]][r[l+1]][A],h[A][A]=y[r[l]][r[l+2]][A],d.x=(n[3*h[A][A]]-n[3*h[A][0]])/A,d.y=(n[3*h[A][A]+1]-n[3*h[A][0]+1])/A,d.z=(n[3*h[A][A]+2]-n[3*h[A][0]+2])/A,p.x=(o[3*h[A][A]]-o[3*h[A][0]])/A,p.y=(o[3*h[A][A]+1]-o[3*h[A][0]+1])/A,p.z=(o[3*h[A][A]+2]-o[3*h[A][0]+2])/A,_.x=(i[2*h[A][A]]-i[2*h[A][0]])/A,_.y=(i[2*h[A][A]+1]-i[2*h[A][0]+1])/A;for(x=1;x<A;x++)h[A][x]=n.length/3,n[v]=n[3*h[A][0]]+x*d.x,o[v++]=o[3*h[A][0]]+x*p.x,n[v]=n[3*h[A][0]+1]+x*d.y,o[v++]=o[3*h[A][0]+1]+x*p.y,n[v]=n[3*h[A][0]+2]+x*d.z,o[v++]=o[3*h[A][0]+2]+x*p.z,i[b++]=i[2*h[A][0]]+x*_.x,i[b++]=i[2*h[A][0]+1]+x*_.y}h[u]=y[r[l+1]][r[l+2]],g.push(h[0][0],h[1][0],h[1][1]);for(A=1;A<u;A++){for(x=0;x<A;x++)g.push(h[A][x],h[A+1][x],h[A+1][x+1]),g.push(h[A][x],h[A+1][x+1],h[A][x+1]);g.push(h[A][x],h[A+1][x],h[A+1][x+1])}}e.indices=g,e.applyToMesh(this,this.isVertexBufferUpdatable(Bt.PositionKind))}else f.Warn("VertexData contains null entries")},e.prototype.forceSharedVertices=function(){var t=wt.ExtractFromMesh(this),e=t.uvs,i=t.indices,r=t.positions,n=t.colors;if(void 0===i||void 0===r||null===i||null===r)f.Warn("VertexData contains empty entries");else{for(var o,s,a=new Array,u=new Array,h=new Array,l=new Array,c=new Array,d=0,p={},_=0;_<i.length;_+=3){s=[i[_],i[_+1],i[_+2]],c=new Array;for(var g=0;g<3;g++){c[g]="";for(var m=0;m<3;m++)Math.abs(r[3*s[g]+m])<1e-8&&(r[3*s[g]+m]=0),c[g]+=r[3*s[g]+m]+"|"}if(c[0]!=c[1]&&c[0]!=c[2]&&c[1]!=c[2])for(g=0;g<3;g++){if(void 0===(o=p[c[g]])){p[c[g]]=d,o=d++;for(m=0;m<3;m++)a.push(r[3*s[g]+m]);if(null!=n)for(m=0;m<4;m++)l.push(n[4*s[g]+m]);if(null!=e)for(m=0;m<2;m++)h.push(e[2*s[g]+m])}u.push(o)}}var y=new Array;wt.ComputeNormals(a,u,y),t.positions=a,t.indices=u,t.normals=y,null!=e&&(t.uvs=h),null!=n&&(t.colors=l),t.applyToMesh(this,this.isVertexBufferUpdatable(Bt.PositionKind))}},e._instancedMeshFactory=function(t,e){throw m.WarnImport("InstancedMesh")},e._PhysicsImpostorParser=function(t,e,i){throw m.WarnImport("PhysicsImpostor")},e.prototype.createInstance=function(t){var i=this.geometry;if(i&&i.meshes.length>1)for(var r=0,n=i.meshes.slice(0);r<n.length;r++){var o=n[r];o!==this&&o.makeGeometryUnique()}return e._instancedMeshFactory(t,this)},e.prototype.synchronizeInstances=function(){this._geometry&&1!==this._geometry.meshes.length&&this.instances.length&&this.makeGeometryUnique();for(var t=0;t<this.instances.length;t++){this.instances[t]._syncSubMeshes()}return this},e.prototype.optimizeIndices=function(t){var e=this,i=this.getIndices(),r=this.getVerticesData(Bt.PositionKind);if(!r||!i)return this;for(var n=new Array,o=0;o<r.length;o+=3)n.push(_t.FromArray(r,o));var s=new Array;return ht.SyncAsyncForLoop(n.length,40,(function(t){for(var e=n.length-1-t,i=n[e],r=0;r<e;++r){var o=n[r];if(i.equals(o)){s[e]=r;break}}}),(function(){for(var r=0;r<i.length;++r)i[r]=s[i[r]]||i[r];var n=e.subMeshes.slice(0);e.setIndices(i),e.subMeshes=n,t&&t(e)})),this},e.prototype.serialize=function(t){t.name=this.name,t.id=this.id,t.uniqueId=this.uniqueId,t.type=this.getClassName(),ct&&ct.HasTags(this)&&(t.tags=ct.GetTags(this)),t.position=this.position.asArray(),this.rotationQuaternion?t.rotationQuaternion=this.rotationQuaternion.asArray():this.rotation&&(t.rotation=this.rotation.asArray()),t.scaling=this.scaling.asArray(),this._postMultiplyPivotMatrix?t.pivotMatrix=this.getPivotMatrix().asArray():t.localMatrix=this.getPivotMatrix().asArray(),t.isEnabled=this.isEnabled(!1),t.isVisible=this.isVisible,t.infiniteDistance=this.infiniteDistance,t.pickable=this.isPickable,t.receiveShadows=this.receiveShadows,t.billboardMode=this.billboardMode,t.visibility=this.visibility,t.checkCollisions=this.checkCollisions,t.isBlocker=this.isBlocker,t.overrideMaterialSideOrientation=this.overrideMaterialSideOrientation,this.parent&&(t.parentId=this.parent.id),t.isUnIndexed=this.isUnIndexed;var e=this._geometry;if(e){var i=e.id;t.geometryId=i,t.subMeshes=[];for(var r=0;r<this.subMeshes.length;r++){var n=this.subMeshes[r];t.subMeshes.push({materialIndex:n.materialIndex,verticesStart:n.verticesStart,verticesCount:n.verticesCount,indexStart:n.indexStart,indexCount:n.indexCount})}}(this.material?this.material.doNotSerialize||(t.materialId=this.material.id):this.material=null,this.morphTargetManager&&(t.morphTargetManagerId=this.morphTargetManager.uniqueId),this.skeleton&&(t.skeletonId=this.skeleton.id,t.numBoneInfluencers=this.numBoneInfluencers),this.getScene()._getComponent(le.NAME_PHYSICSENGINE))&&((a=this.getPhysicsImpostor())&&(t.physicsMass=a.getParam("mass"),t.physicsFriction=a.getParam("friction"),t.physicsRestitution=a.getParam("mass"),t.physicsImpostor=a.type));this.metadata&&(t.metadata=this.metadata),t.instances=[];for(var o=0;o<this.instances.length;o++){var s=this.instances[o];if(!s.doNotSerialize){var a,u={name:s.name,id:s.id,isEnabled:s.isEnabled(!1),isVisible:s.isVisible,isPickable:s.isPickable,checkCollisions:s.checkCollisions,position:s.position.asArray(),scaling:s.scaling.asArray()};if(s.parent&&(u.parentId=s.parent.id),s.rotationQuaternion?u.rotationQuaternion=s.rotationQuaternion.asArray():s.rotation&&(u.rotation=s.rotation.asArray()),this.getScene()._getComponent(le.NAME_PHYSICSENGINE))(a=s.getPhysicsImpostor())&&(u.physicsMass=a.getParam("mass"),u.physicsFriction=a.getParam("friction"),u.physicsRestitution=a.getParam("mass"),u.physicsImpostor=a.type);s.metadata&&(u.metadata=s.metadata),t.instances.push(u),Dt.AppendSerializedAnimations(s,u),u.ranges=s.serializeAnimationRanges()}}if(this._thinInstanceDataStorage.instancesCount&&this._thinInstanceDataStorage.matrixData&&(t.thinInstances={instancesCount:this._thinInstanceDataStorage.instancesCount,matrixData:ut.SliceToArray(this._thinInstanceDataStorage.matrixData),matrixBufferSize:this._thinInstanceDataStorage.matrixBufferSize},this._userThinInstanceBuffersStorage)){var h={data:{},sizes:{},strides:{}};for(var l in this._userThinInstanceBuffersStorage.data)h.data[l]=ut.SliceToArray(this._userThinInstanceBuffersStorage.data[l]),h.sizes[l]=this._userThinInstanceBuffersStorage.sizes[l],h.strides[l]=this._userThinInstanceBuffersStorage.strides[l];t.thinInstances.userThinInstance=h}Dt.AppendSerializedAnimations(this,t),t.ranges=this.serializeAnimationRanges(),t.layerMask=this.layerMask,t.alphaIndex=this.alphaIndex,t.hasVertexAlpha=this.hasVertexAlpha,t.overlayAlpha=this.overlayAlpha,t.overlayColor=this.overlayColor.asArray(),t.renderOverlay=this.renderOverlay,t.applyFog=this.applyFog,this.actionManager&&(t.actions=this.actionManager.serialize(this.name))},e.prototype._syncGeometryWithMorphTargetManager=function(){if(this.geometry){this._markSubMeshesAsAttributesDirty();var t=this._internalMeshDataInfo._morphTargetManager;if(t&&t.vertexCount){if(t.vertexCount!==this.getTotalVertices())return f.Error("Mesh is incompatible with morph targets. Targets and mesh must all have the same vertices count."),void(this.morphTargetManager=null);for(var e=0;e<t.numInfluencers;e++){var i=t.getActiveTarget(e),r=i.getPositions();if(!r)return void f.Error("Invalid morph target. Target must have positions.");this.geometry.setVerticesData(Bt.PositionKind+e,r,!1,3);var n=i.getNormals();n&&this.geometry.setVerticesData(Bt.NormalKind+e,n,!1,3);var o=i.getTangents();o&&this.geometry.setVerticesData(Bt.TangentKind+e,o,!1,3);var s=i.getUVs();s&&this.geometry.setVerticesData(Bt.UVKind+"_"+e,s,!1,2)}}else for(e=0;this.geometry.isVerticesDataPresent(Bt.PositionKind+e);)this.geometry.removeVerticesData(Bt.PositionKind+e),this.geometry.isVerticesDataPresent(Bt.NormalKind+e)&&this.geometry.removeVerticesData(Bt.NormalKind+e),this.geometry.isVerticesDataPresent(Bt.TangentKind+e)&&this.geometry.removeVerticesData(Bt.TangentKind+e),this.geometry.isVerticesDataPresent(Bt.UVKind+e)&&this.geometry.removeVerticesData(Bt.UVKind+"_"+e),e++}},e.Parse=function(t,i,r){var n;if((n=t.type&&"GroundMesh"===t.type?e._GroundMeshParser(t,i):new e(t.name,i)).id=t.id,ct&&ct.AddTagsTo(n,t.tags),n.position=_t.FromArray(t.position),void 0!==t.metadata&&(n.metadata=t.metadata),t.rotationQuaternion?n.rotationQuaternion=mt.FromArray(t.rotationQuaternion):t.rotation&&(n.rotation=_t.FromArray(t.rotation)),n.scaling=_t.FromArray(t.scaling),t.localMatrix?n.setPreTransformMatrix(yt.FromArray(t.localMatrix)):t.pivotMatrix&&n.setPivotMatrix(yt.FromArray(t.pivotMatrix)),n.setEnabled(t.isEnabled),n.isVisible=t.isVisible,n.infiniteDistance=t.infiniteDistance,n.showBoundingBox=t.showBoundingBox,n.showSubMeshesBoundingBox=t.showSubMeshesBoundingBox,void 0!==t.applyFog&&(n.applyFog=t.applyFog),void 0!==t.pickable&&(n.isPickable=t.pickable),void 0!==t.alphaIndex&&(n.alphaIndex=t.alphaIndex),n.receiveShadows=t.receiveShadows,n.billboardMode=t.billboardMode,void 0!==t.visibility&&(n.visibility=t.visibility),n.checkCollisions=t.checkCollisions,n.overrideMaterialSideOrientation=t.overrideMaterialSideOrientation,void 0!==t.isBlocker&&(n.isBlocker=t.isBlocker),n._shouldGenerateFlatShading=t.useFlatShading,t.freezeWorldMatrix&&(n._waitingData.freezeWorldMatrix=t.freezeWorldMatrix),t.parentId&&(n._waitingParentId=t.parentId),void 0!==t.actions&&(n._waitingData.actions=t.actions),void 0!==t.overlayAlpha&&(n.overlayAlpha=t.overlayAlpha),void 0!==t.overlayColor&&(n.overlayColor=xt.FromArray(t.overlayColor)),void 0!==t.renderOverlay&&(n.renderOverlay=t.renderOverlay),n.isUnIndexed=!!t.isUnIndexed,n.hasVertexAlpha=t.hasVertexAlpha,t.delayLoadingFile?(n.delayLoadState=4,n.delayLoadingFile=r+t.delayLoadingFile,n._boundingInfo=new Wt(_t.FromArray(t.boundingBoxMinimum),_t.FromArray(t.boundingBoxMaximum)),t._binaryInfo&&(n._binaryInfo=t._binaryInfo),n._delayInfo=[],t.hasUVs&&n._delayInfo.push(Bt.UVKind),t.hasUVs2&&n._delayInfo.push(Bt.UV2Kind),t.hasUVs3&&n._delayInfo.push(Bt.UV3Kind),t.hasUVs4&&n._delayInfo.push(Bt.UV4Kind),t.hasUVs5&&n._delayInfo.push(Bt.UV5Kind),t.hasUVs6&&n._delayInfo.push(Bt.UV6Kind),t.hasColors&&n._delayInfo.push(Bt.ColorKind),t.hasMatricesIndices&&n._delayInfo.push(Bt.MatricesIndicesKind),t.hasMatricesWeights&&n._delayInfo.push(Bt.MatricesWeightsKind),n._delayLoadingFunction=Xt._ImportGeometry,Gt.ForceFullSceneLoadingForIncremental&&n._checkDelayState()):Xt._ImportGeometry(t,n),t.materialId?n.setMaterialByID(t.materialId):n.material=null,t.morphTargetManagerId>-1&&(n.morphTargetManager=i.getMorphTargetManagerById(t.morphTargetManagerId)),void 0!==t.skeletonId&&null!==t.skeletonId&&(n.skeleton=i.getLastSkeletonByID(t.skeletonId),t.numBoneInfluencers&&(n.numBoneInfluencers=t.numBoneInfluencers)),t.animations){for(var o=0;o<t.animations.length;o++){var s=t.animations[o];(l=ot.GetClass("BABYLON.Animation"))&&n.animations.push(l.Parse(s))}Pt.ParseAnimationRanges(n,t,i)}if(t.autoAnimate&&i.beginAnimation(n,t.autoAnimateFrom,t.autoAnimateTo,t.autoAnimateLoop,t.autoAnimateSpeed||1),t.layerMask&&!isNaN(t.layerMask)?n.layerMask=Math.abs(parseInt(t.layerMask)):n.layerMask=268435455,t.physicsImpostor&&e._PhysicsImpostorParser(i,n,t),t.lodMeshIds&&(n._waitingData.lods={ids:t.lodMeshIds,distances:t.lodDistances?t.lodDistances:null,coverages:t.lodCoverages?t.lodCoverages:null}),t.instances)for(var a=0;a<t.instances.length;a++){var u=t.instances[a],h=n.createInstance(u.name);if(u.id&&(h.id=u.id),ct&&(u.tags?ct.AddTagsTo(h,u.tags):ct.AddTagsTo(h,t.tags)),h.position=_t.FromArray(u.position),void 0!==u.metadata&&(h.metadata=u.metadata),u.parentId&&(h._waitingParentId=u.parentId),void 0!==u.isEnabled&&null!==u.isEnabled&&h.setEnabled(u.isEnabled),void 0!==u.isVisible&&null!==u.isVisible&&(h.isVisible=u.isVisible),void 0!==u.isPickable&&null!==u.isPickable&&(h.isPickable=u.isPickable),u.rotationQuaternion?h.rotationQuaternion=mt.FromArray(u.rotationQuaternion):u.rotation&&(h.rotation=_t.FromArray(u.rotation)),h.scaling=_t.FromArray(u.scaling),null!=u.checkCollisions&&null!=u.checkCollisions&&(h.checkCollisions=u.checkCollisions),null!=u.pickable&&null!=u.pickable&&(h.isPickable=u.pickable),null!=u.showBoundingBox&&null!=u.showBoundingBox&&(h.showBoundingBox=u.showBoundingBox),null!=u.showSubMeshesBoundingBox&&null!=u.showSubMeshesBoundingBox&&(h.showSubMeshesBoundingBox=u.showSubMeshesBoundingBox),null!=u.alphaIndex&&null!=u.showSubMeshesBoundingBox&&(h.alphaIndex=u.alphaIndex),u.physicsImpostor&&e._PhysicsImpostorParser(i,h,u),u.animations){for(o=0;o<u.animations.length;o++){var l;s=u.animations[o],(l=ot.GetClass("BABYLON.Animation"))&&h.animations.push(l.Parse(s))}Pt.ParseAnimationRanges(h,u,i),u.autoAnimate&&i.beginAnimation(h,u.autoAnimateFrom,u.autoAnimateTo,u.autoAnimateLoop,u.autoAnimateSpeed||1)}}if(t.thinInstances){var c=t.thinInstances;if(c.matrixData?(n.thinInstanceSetBuffer("matrix",new Float32Array(c.matrixData),16,!1),n._thinInstanceDataStorage.matrixBufferSize=c.matrixBufferSize,n._thinInstanceDataStorage.instancesCount=c.instancesCount):n._thinInstanceDataStorage.matrixBufferSize=c.matrixBufferSize,t.thinInstances.userThinInstance){var f=t.thinInstances.userThinInstance;for(var d in f.data)n.thinInstanceSetBuffer(d,new Float32Array(f.data[d]),f.strides[d],!1),n._userThinInstanceBuffersStorage.sizes[d]=f.sizes[d]}}return n},e.CreateRibbon=function(t,e,i,r,n,o,s,a,u){throw m.WarnImport("MeshBuilder")},e.CreateDisc=function(t,e,i,r,n,o){throw void 0===r&&(r=null),m.WarnImport("MeshBuilder")},e.CreateBox=function(t,e,i,r,n){throw void 0===i&&(i=null),m.WarnImport("MeshBuilder")},e.CreateSphere=function(t,e,i,r,n,o){throw m.WarnImport("MeshBuilder")},e.CreateHemisphere=function(t,e,i,r){throw m.WarnImport("MeshBuilder")},e.CreateCylinder=function(t,e,i,r,n,o,s,a,u){throw m.WarnImport("MeshBuilder")},e.CreateTorus=function(t,e,i,r,n,o,s){throw m.WarnImport("MeshBuilder")},e.CreateTorusKnot=function(t,e,i,r,n,o,s,a,u,h){throw m.WarnImport("MeshBuilder")},e.CreateLines=function(t,e,i,r,n){throw void 0===i&&(i=null),void 0===r&&(r=!1),void 0===n&&(n=null),m.WarnImport("MeshBuilder")},e.CreateDashedLines=function(t,e,i,r,n,o,s,a){throw void 0===o&&(o=null),m.WarnImport("MeshBuilder")},e.CreatePolygon=function(t,e,i,r,n,o,s){throw void 0===s&&(s=earcut),m.WarnImport("MeshBuilder")},e.ExtrudePolygon=function(t,e,i,r,n,o,s,a){throw void 0===a&&(a=earcut),m.WarnImport("MeshBuilder")},e.ExtrudeShape=function(t,e,i,r,n,o,s,a,u,h){throw void 0===s&&(s=null),m.WarnImport("MeshBuilder")},e.ExtrudeShapeCustom=function(t,e,i,r,n,o,s,a,u,h,l,c){throw m.WarnImport("MeshBuilder")},e.CreateLathe=function(t,e,i,r,n,o,s){throw m.WarnImport("MeshBuilder")},e.CreatePlane=function(t,e,i,r,n){throw m.WarnImport("MeshBuilder")},e.CreateGround=function(t,e,i,r,n,o){throw m.WarnImport("MeshBuilder")},e.CreateTiledGround=function(t,e,i,r,n,o,s,a,u){throw m.WarnImport("MeshBuilder")},e.CreateGroundFromHeightMap=function(t,e,i,r,n,o,s,a,u,h,l){throw m.WarnImport("MeshBuilder")},e.CreateTube=function(t,e,i,r,n,o,s,a,u,h){throw m.WarnImport("MeshBuilder")},e.CreatePolyhedron=function(t,e,i){throw m.WarnImport("MeshBuilder")},e.CreateIcoSphere=function(t,e,i){throw m.WarnImport("MeshBuilder")},e.CreateDecal=function(t,e,i,r,n,o){throw m.WarnImport("MeshBuilder")},e.CreateCapsule=function(t,e,i){throw m.WarnImport("MeshBuilder")},e.prototype.setPositionsForCPUSkinning=function(){var t=this._internalMeshDataInfo;if(!t._sourcePositions){var e=this.getVerticesData(Bt.PositionKind);if(!e)return t._sourcePositions;t._sourcePositions=new Float32Array(e),this.isVertexBufferUpdatable(Bt.PositionKind)||this.setVerticesData(Bt.PositionKind,e,!0)}return t._sourcePositions},e.prototype.setNormalsForCPUSkinning=function(){var t=this._internalMeshDataInfo;if(!t._sourceNormals){var e=this.getVerticesData(Bt.NormalKind);if(!e)return t._sourceNormals;t._sourceNormals=new Float32Array(e),this.isVertexBufferUpdatable(Bt.NormalKind)||this.setVerticesData(Bt.NormalKind,e,!0)}return t._sourceNormals},e.prototype.applySkeleton=function(t){if(!this.geometry)return this;if(this.geometry._softwareSkinningFrameId==this.getScene().getFrameId())return this;if(this.geometry._softwareSkinningFrameId=this.getScene().getFrameId(),!this.isVerticesDataPresent(Bt.PositionKind))return this;if(!this.isVerticesDataPresent(Bt.MatricesIndicesKind))return this;if(!this.isVerticesDataPresent(Bt.MatricesWeightsKind))return this;var e=this.isVerticesDataPresent(Bt.NormalKind),i=this._internalMeshDataInfo;if(!i._sourcePositions){var r=this.subMeshes.slice();this.setPositionsForCPUSkinning(),this.subMeshes=r}e&&!i._sourceNormals&&this.setNormalsForCPUSkinning();var n=this.getVerticesData(Bt.PositionKind);if(!n)return this;n instanceof Float32Array||(n=new Float32Array(n));var o=this.getVerticesData(Bt.NormalKind);if(e){if(!o)return this;o instanceof Float32Array||(o=new Float32Array(o))}var s=this.getVerticesData(Bt.MatricesIndicesKind),a=this.getVerticesData(Bt.MatricesWeightsKind);if(!a||!s)return this;for(var u,h=this.numBoneInfluencers>4,l=h?this.getVerticesData(Bt.MatricesIndicesExtraKind):null,c=h?this.getVerticesData(Bt.MatricesWeightsExtraKind):null,f=t.getTransformMatrices(this),d=_t.Zero(),p=new yt,_=new yt,g=0,m=0;m<n.length;m+=3,g+=4){var y;for(u=0;u<4;u++)(y=a[g+u])>0&&(yt.FromFloat32ArrayToRefScaled(f,Math.floor(16*s[g+u]),y,_),p.addToSelf(_));if(h)for(u=0;u<4;u++)(y=c[g+u])>0&&(yt.FromFloat32ArrayToRefScaled(f,Math.floor(16*l[g+u]),y,_),p.addToSelf(_));_t.TransformCoordinatesFromFloatsToRef(i._sourcePositions[m],i._sourcePositions[m+1],i._sourcePositions[m+2],p,d),d.toArray(n,m),e&&(_t.TransformNormalFromFloatsToRef(i._sourceNormals[m],i._sourceNormals[m+1],i._sourceNormals[m+2],p,d),d.toArray(o,m)),p.reset()}return this.updateVerticesData(Bt.PositionKind,n),e&&this.updateVerticesData(Bt.NormalKind,o),this},e.MinMax=function(t){var e=null,i=null;return t.forEach((function(t){var r=t.getBoundingInfo().boundingBox;e&&i?(e.minimizeInPlace(r.minimumWorld),i.maximizeInPlace(r.maximumWorld)):(e=r.minimumWorld,i=r.maximumWorld)})),e&&i?{min:e,max:i}:{min:_t.Zero(),max:_t.Zero()}},e.Center=function(t){var i=t instanceof Array?e.MinMax(t):t;return _t.Center(i.min,i.max)},e.MergeMeshes=function(t,i,r,n,o,s){var a;if(void 0===i&&(i=!0),!r){var u=0;for(a=0;a<t.length;a++)if(t[a]&&(u+=t[a].getTotalVertices())>=65536)return f.Warn("Cannot merge meshes because resulting mesh will have more than 65536 vertices. Please use allow32BitsIndices = true to use 32 bits indices"),null}if(s){var h,l,c=null;o=!1}var d,p=new Array,_=new Array,g=null,m=new Array,y=null;for(a=0;a<t.length;a++)if(t[a]){var v=t[a];if(v.isAnInstance)return f.Warn("Cannot merge instance meshes."),null;var b=v.computeWorldMatrix(!0);if((d=wt.ExtractFromMesh(v,!0,!0)).transform(b),g?g.merge(d,r):(g=d,y=v),o&&m.push(v.getTotalIndices()),s)if(v.material){var x=v.material;if(x instanceof he){for(l=0;l<x.subMaterials.length;l++)p.indexOf(x.subMaterials[l])<0&&p.push(x.subMaterials[l]);for(h=0;h<v.subMeshes.length;h++)_.push(p.indexOf(x.subMaterials[v.subMeshes[h].materialIndex])),m.push(v.subMeshes[h].indexCount)}else for(p.indexOf(x)<0&&p.push(x),h=0;h<v.subMeshes.length;h++)_.push(p.indexOf(x)),m.push(v.subMeshes[h].indexCount)}else for(h=0;h<v.subMeshes.length;h++)_.push(0),m.push(v.subMeshes[h].indexCount)}if(y=y,n||(n=new e(y.name+"_merged",y.getScene())),g.applyToMesh(n),n.checkCollisions=y.checkCollisions,n.overrideMaterialSideOrientation=y.overrideMaterialSideOrientation,i)for(a=0;a<t.length;a++)t[a]&&t[a].dispose();if(o||s){n.releaseSubMeshes(),a=0;for(var A=0;a<m.length;)jt.CreateFromIndices(0,A,m[a],n),A+=m[a],a++}if(s){for((c=new he(y.name+"_merged",y.getScene())).subMaterials=p,h=0;h<n.subMeshes.length;h++)n.subMeshes[h].materialIndex=_[h];n.material=c}else n.material=y.material;return n},e.prototype.addInstance=function(t){t._indexInSourceMeshInstanceArray=this.instances.length,this.instances.push(t)},e.prototype.removeInstance=function(t){var e=t._indexInSourceMeshInstanceArray;if(-1!=e){if(e!==this.instances.length-1){var i=this.instances[this.instances.length-1];this.instances[e]=i,i._indexInSourceMeshInstanceArray=e}t._indexInSourceMeshInstanceArray=-1,this.instances.pop()}},e.FRONTSIDE=wt.FRONTSIDE,e.BACKSIDE=wt.BACKSIDE,e.DOUBLESIDE=wt.DOUBLESIDE,e.DEFAULTSIDE=wt.DEFAULTSIDE,e.NO_CAP=0,e.CAP_START=1,e.CAP_END=2,e.CAP_ALL=3,e.NO_FLIP=0,e.FLIP_TILE=1,e.ROTATE_TILE=2,e.FLIP_ROW=3,e.ROTATE_ROW=4,e.FLIP_N_ROTATE_TILE=5,e.FLIP_N_ROTATE_ROW=6,e.CENTER=0,e.LEFT=1,e.RIGHT=2,e.TOP=3,e.BOTTOM=4,e._GroundMeshParser=function(t,e){throw m.WarnImport("GroundMesh")},e}(oe);ot.RegisteredTypes["BABYLON.Mesh"]=ge;var me=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(a),ye=function(){this.rootNodes=[],this.skeletons=[],this.animationGroups=[]},ve=function(t){function e(e){var i=t.call(this)||this;return i._wasAddedToScene=!1,i.scene=e,i.sounds=[],i.effectLayers=[],i.layers=[],i.lensFlareSystems=[],i.proceduralTextures=[],i.reflectionProbes=[],e.onDisposeObservable.add((function(){i._wasAddedToScene||i.dispose()})),i}return n(e,t),e.prototype.instantiateModelsToScene=function(t,e){var i=this;void 0===e&&(e=!1);var r={},n={},o=new ye,s=[],a=[],u={doNotInstantiate:!0},h=function(e,i){if(r[e.uniqueId]=i.uniqueId,n[i.uniqueId]=i,t&&(i.name=t(e.name)),i instanceof ge){var o=i;if(o.morphTargetManager){var s=e.morphTargetManager;o.morphTargetManager=s.clone();for(var a=0;a<s.numTargets;a++){var u=s.getTarget(a),h=o.morphTargetManager.getTarget(a);r[u.uniqueId]=h.uniqueId,n[h.uniqueId]=h}}}};return this.transformNodes.forEach((function(t){if(!t.parent){var e=t.instantiateHierarchy(null,u,(function(t,e){h(t,e)}));e&&o.rootNodes.push(e)}})),this.meshes.forEach((function(s){if(!s.parent){var l=s.instantiateHierarchy(null,u,(function(o,s){if(h(o,s),s.material){var u=s;if(u.material)if(e){var l=o.material;if(-1===a.indexOf(l)){var c=l.clone(t?t(l.name):"Clone of "+l.name);if(a.push(l),r[l.uniqueId]=c.uniqueId,n[c.uniqueId]=c,"MultiMaterial"===l.getClassName()){for(var f=l,d=0,p=f.subMaterials;d<p.length;d++){var _=p[d];_&&(c=_.clone(t?t(_.name):"Clone of "+_.name),a.push(_),r[_.uniqueId]=c.uniqueId,n[c.uniqueId]=c)}f.subMaterials=f.subMaterials.map((function(t){return t&&n[r[t.uniqueId]]}))}}u.material=n[r[l.uniqueId]]}else"MultiMaterial"===u.material.getClassName()?-1===i.scene.multiMaterials.indexOf(u.material)&&i.scene.addMultiMaterial(u.material):-1===i.scene.materials.indexOf(u.material)&&i.scene.addMaterial(u.material)}}));l&&o.rootNodes.push(l)}})),this.skeletons.forEach((function(e){var a=e.clone(t?t(e.name):"Clone of "+e.name);e.overrideMesh&&(a.overrideMesh=n[r[e.overrideMesh.uniqueId]]);for(var u=0,h=i.meshes;u<h.length;u++){var l=h[u];if(l.skeleton===e&&!l.isAnInstance){if(n[r[l.uniqueId]].skeleton=a,-1!==s.indexOf(a))continue;s.push(a);for(var c=0,f=a.bones;c<f.length;c++){var d=f[c];d._linkedTransformNode&&(d._linkedTransformNode=n[r[d._linkedTransformNode.uniqueId]])}}}o.skeletons.push(a)})),this.animationGroups.forEach((function(t){var e=t.clone(t.name,(function(t){return n[r[t.uniqueId]]||t}));o.animationGroups.push(e)})),o},e.prototype.addAllToScene=function(){var t=this;this._wasAddedToScene=!0,this.cameras.forEach((function(e){t.scene.addCamera(e)})),this.lights.forEach((function(e){t.scene.addLight(e)})),this.meshes.forEach((function(e){t.scene.addMesh(e)})),this.skeletons.forEach((function(e){t.scene.addSkeleton(e)})),this.animations.forEach((function(e){t.scene.addAnimation(e)})),this.animationGroups.forEach((function(e){t.scene.addAnimationGroup(e)})),this.multiMaterials.forEach((function(e){t.scene.addMultiMaterial(e)})),this.materials.forEach((function(e){t.scene.addMaterial(e)})),this.morphTargetManagers.forEach((function(e){t.scene.addMorphTargetManager(e)})),this.geometries.forEach((function(e){t.scene.addGeometry(e)})),this.transformNodes.forEach((function(e){t.scene.addTransformNode(e)})),this.actionManagers.forEach((function(e){t.scene.addActionManager(e)})),this.textures.forEach((function(e){t.scene.addTexture(e)})),this.reflectionProbes.forEach((function(e){t.scene.addReflectionProbe(e)})),this.environmentTexture&&(this.scene.environmentTexture=this.environmentTexture);for(var e=0,i=this.scene._serializableComponents;e<i.length;e++){i[e].addFromContainer(this)}},e.prototype.removeAllFromScene=function(){var t=this;this._wasAddedToScene=!1,this.cameras.forEach((function(e){t.scene.removeCamera(e)})),this.lights.forEach((function(e){t.scene.removeLight(e)})),this.meshes.forEach((function(e){t.scene.removeMesh(e)})),this.skeletons.forEach((function(e){t.scene.removeSkeleton(e)})),this.animations.forEach((function(e){t.scene.removeAnimation(e)})),this.animationGroups.forEach((function(e){t.scene.removeAnimationGroup(e)})),this.multiMaterials.forEach((function(e){t.scene.removeMultiMaterial(e)})),this.materials.forEach((function(e){t.scene.removeMaterial(e)})),this.morphTargetManagers.forEach((function(e){t.scene.removeMorphTargetManager(e)})),this.geometries.forEach((function(e){t.scene.removeGeometry(e)})),this.transformNodes.forEach((function(e){t.scene.removeTransformNode(e)})),this.actionManagers.forEach((function(e){t.scene.removeActionManager(e)})),this.textures.forEach((function(e){t.scene.removeTexture(e)})),this.reflectionProbes.forEach((function(e){t.scene.removeReflectionProbe(e)})),this.environmentTexture===this.scene.environmentTexture&&(this.scene.environmentTexture=null);for(var e=0,i=this.scene._serializableComponents;e<i.length;e++){i[e].removeFromContainer(this)}},e.prototype.dispose=function(){this.cameras.forEach((function(t){t.dispose()})),this.cameras=[],this.lights.forEach((function(t){t.dispose()})),this.lights=[],this.meshes.forEach((function(t){t.dispose()})),this.meshes=[],this.skeletons.forEach((function(t){t.dispose()})),this.skeletons=[],this.animationGroups.forEach((function(t){t.dispose()})),this.animationGroups=[],this.multiMaterials.forEach((function(t){t.dispose()})),this.multiMaterials=[],this.materials.forEach((function(t){t.dispose()})),this.materials=[],this.geometries.forEach((function(t){t.dispose()})),this.geometries=[],this.transformNodes.forEach((function(t){t.dispose()})),this.transformNodes=[],this.actionManagers.forEach((function(t){t.dispose()})),this.actionManagers=[],this.textures.forEach((function(t){t.dispose()})),this.textures=[],this.reflectionProbes.forEach((function(t){t.dispose()})),this.reflectionProbes=[],this.environmentTexture&&(this.environmentTexture.dispose(),this.environmentTexture=null);for(var t=0,e=this.scene._serializableComponents;t<e.length;t++){e[t].removeFromContainer(this,!0)}},e.prototype._moveAssets=function(t,e,i){if(t)for(var r=0,n=t;r<n.length;r++){var o=n[r],s=!0;if(i)for(var a=0,u=i;a<u.length;a++){if(o===u[a]){s=!1;break}}s&&e.push(o)}},e.prototype.moveAllFromScene=function(t){for(var e in this._wasAddedToScene=!1,void 0===t&&(t=new me),this)this.hasOwnProperty(e)&&(this[e]=this[e]||("environmentTexture"===e?null:[]),this._moveAssets(this.scene[e],this[e],t[e]));this.environmentTexture=this.scene.environmentTexture,this.removeAllFromScene()},e.prototype.createRootMesh=function(){var t=new ge("assetContainerRootMesh",this.scene);return this.meshes.forEach((function(e){e.parent||t.addChild(e)})),this.meshes.unshift(t),t},e.prototype.mergeAnimationsTo=function(t,e,i){if(void 0===t&&(t=b.LastCreatedScene),void 0===i&&(i=null),!t)return f.Error("No scene available to merge animations to"),[];var r=i||function(e){var i=null,r=e.animations.length?e.animations[0].targetProperty:"",n=e.name.split(".").join("").split("_primitive")[0];switch(r){case"position":case"rotationQuaternion":i=t.getTransformNodeByName(e.name)||t.getTransformNodeByName(n);break;case"influence":i=t.getMorphTargetByName(e.name)||t.getMorphTargetByName(n);break;default:i=t.getNodeByName(e.name)||t.getNodeByName(n)}return i};this.getNodes().forEach((function(t){var e=r(t);if(null!==e){for(var i=function(t){for(var i=0,r=e.animations.filter((function(e){return e.targetProperty===t.targetProperty}));i<r.length;i++){var n=r[i],o=e.animations.indexOf(n,0);o>-1&&e.animations.splice(o,1)}},n=0,o=t.animations;n<o.length;n++){i(o[n])}e.animations=e.animations.concat(t.animations)}}));var n=new Array;return this.animationGroups.slice().forEach((function(t){n.push(t.clone(t.name,r)),t.animatables.forEach((function(t){t.stop()}))})),e.forEach((function(e){var i=r(e.target);i&&(t.beginAnimation(i,e.fromFrame,e.toFrame,e.loopAnimation,e.speedRatio,e.onAnimationEnd?e.onAnimationEnd:void 0,void 0,!0,void 0,e.onAnimationLoop?e.onAnimationLoop:void 0),t.stopAnimation(e.target))})),n},e}(a)}]).default}));